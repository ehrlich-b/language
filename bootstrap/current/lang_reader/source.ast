(program
  (modules "src/lang_reader.lang" "src/lang_reader.lang" "std/tools.lang" "src/ast_emit.lang" "std/core.lang" "src/parser.lang" "std/os/libc_macos.lang" "src/lexer.lang" "src/limits.lang" "std/os.lang")
  (var LIMIT_STMTS_PER_BLOCK (type_base i64) (number 1024))
  (var LIMIT_CALL_ARGS (type_base i64) (number 16))
  (var LIMIT_FUNC_PARAMS (type_base i64) (number 16))
  (var LIMIT_TOP_DECLS (type_base i64) (number 4000))
  (var LIMIT_LOCALS (type_base i64) (number 1024))
  (var LIMIT_GLOBALS (type_base i64) (number 2000))
  (var LIMIT_STRINGS (type_base i64) (number 6000))
  (var LIMIT_STRUCTS (type_base i64) (number 200))
  (var LIMIT_ENUMS (type_base i64) (number 100))
  (var LIMIT_EFFECTS (type_base i64) (number 100))
  (var LIMIT_MACROS (type_base i64) (number 100))
  (var LIMIT_READERS (type_base i64) (number 100))
  (var LIMIT_EMBEDDED_READERS (type_base i64) (number 20))
  (var LIMIT_FUNCS (type_base i64) (number 3000))
  (var LIMIT_LAMBDAS (type_base i64) (number 1000))
  (var LIMIT_CAPTURES (type_base i64) (number 64))
  (var LIMIT_LOOP_DEPTH (type_base i64) (number 32))
  (var LIMIT_INCLUDE_DEPTH (type_base i64) (number 32))
  (var SIZE_CODE_BUF (type_base i64) (number 4194304))
  (var SIZE_FUNC_BUF (type_base i64) (number 524288))
  (var SIZE_AST_EMIT (type_base i64) (number 8388608))
  (var SIZE_HEAP (type_base i64) (number 268435456))
  (var pub O_RDONLY (type_base i64) (number 0))
  (var pub O_WRONLY (type_base i64) (number 1))
  (var pub O_CREAT (type_base i64) (number 512))
  (var pub O_TRUNC (type_base i64) (number 1024))
  (var pub O_APPEND (type_base i64) (number 8))
  (var pub O_WRONLY_CREAT_TRUNC (type_base i64) (number 1537))
  (extern_func read ((param fd (type_base i64)) (param buf (type_ptr (type_base u8))) (param count (type_base i64))) (type_base i64)
    nil)
  (extern_func write ((param fd (type_base i64)) (param buf (type_ptr (type_base u8))) (param count (type_base i64))) (type_base i64)
    nil)
  (extern_func open ((param path (type_ptr (type_base u8))) (param flags (type_base i64)) (param mode (type_base i64))) (type_base i64)
    nil)
  (extern_func close ((param fd (type_base i64))) (type_base i64)
    nil)
  (extern_func mmap ((param addr (type_ptr (type_base u8))) (param len (type_base i64)) (param prot (type_base i64)) (param flags (type_base i64)) (param fd (type_base i64)) (param offset (type_base i64))) (type_ptr (type_base u8))
    nil)
  (extern_func munmap ((param addr (type_ptr (type_base u8))) (param len (type_base i64))) (type_base i64)
    nil)
  (extern_func pub malloc ((param size (type_base i64))) (type_ptr (type_base u8))
    nil)
  (extern_func pub calloc ((param n (type_base i64)) (param size (type_base i64))) (type_ptr (type_base u8))
    nil)
  (extern_func pub free ((param ptr (type_ptr (type_base u8)))) (type_base void)
    nil)
  (extern_func pub exit ((param code (type_base i64))) (type_base void)
    nil)
  (extern_func pub getpid () (type_base i64)
    nil)
  (extern_func pub getppid () (type_base i64)
    nil)
  (extern_func pub getenv ((param name (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    nil)
  (extern_func fork () (type_base i64)
    nil)
  (extern_func execve ((param path (type_ptr (type_base u8))) (param argv (type_ptr (type_ptr (type_base u8)))) (param envp (type_ptr (type_ptr (type_base u8))))) (type_base i64)
    nil)
  (extern_func waitpid ((param pid (type_base i64)) (param status (type_ptr (type_base i64))) (param options (type_base i64))) (type_base i64)
    nil)
  (extern_func pipe ((param fds (type_ptr (type_base i64)))) (type_base i64)
    nil)
  (extern_func dup2 ((param oldfd (type_base i64)) (param newfd (type_base i64))) (type_base i64)
    nil)
  (extern_func _exit ((param status (type_base i64))) (type_base void)
    nil)
  (extern_func stat ((param path (type_ptr (type_base u8))) (param statbuf (type_ptr (type_base u8)))) (type_base i64)
    nil)
  (extern_func mkdir ((param path (type_ptr (type_base u8))) (param mode (type_base i64))) (type_base i64)
    nil)
  (extern_func unlink ((param path (type_ptr (type_base u8)))) (type_base i64)
    nil)
  (extern_func rmdir ((param path (type_ptr (type_base u8)))) (type_base i64)
    nil)
  (extern_func getcwd ((param buf (type_ptr (type_base u8))) (param size (type_base i64))) (type_ptr (type_base u8))
    nil)
  (func os_read ((param fd (type_base i64)) (param buf (type_ptr (type_base u8))) (param count (type_base i64))) (type_base i64)
    (block
      (return (call (ident read) (ident fd) (ident buf) (ident count)))))
  (func os_write ((param fd (type_base i64)) (param buf (type_ptr (type_base u8))) (param count (type_base i64))) (type_base i64)
    (block
      (return (call (ident write) (ident fd) (ident buf) (ident count)))))
  (func os_open ((param path (type_ptr (type_base u8))) (param flags (type_base i64)) (param mode (type_base i64))) (type_base i64)
    (block
      (return (call (ident open) (ident path) (ident flags) (ident mode)))))
  (func os_close ((param fd (type_base i64))) (type_base i64)
    (block
      (return (call (ident close) (ident fd)))))
  (func os_mmap ((param addr (type_ptr (type_base u8))) (param len (type_base i64)) (param prot (type_base i64)) (param flags (type_base i64)) (param fd (type_base i64)) (param offset (type_base i64))) (type_ptr (type_base u8))
    (block
      (return (call (ident mmap) (ident addr) (ident len) (ident prot) (ident flags) (ident fd) (ident offset)))))
  (func os_exit ((param code (type_base i64))) (type_base void)
    (block
      (expr_stmt (call (ident exit) (ident code)))))
  (func os_stat ((param path (type_ptr (type_base u8))) (param statbuf (type_ptr (type_base u8)))) (type_base i64)
    (block
      (return (call (ident stat) (ident path) (ident statbuf)))))
  (func os_getpid () (type_base i64)
    (block
      (return (call (ident getpid)))))
  (func os_getppid () (type_base i64)
    (block
      (return (call (ident getppid)))))
  (func os_getcwd ((param buf (type_ptr (type_base u8))) (param size (type_base i64))) (type_base i64)
    (block
      (var result (type_ptr (type_base u8)) (call (ident getcwd) (ident buf) (ident size)))
      (if (binop == (ident result) (nil))
        (block
          (return (binop - (number 0) (number 1)))))
      (return (number 0))))
  (func os_mkdir ((param path (type_ptr (type_base u8))) (param mode (type_base i64))) (type_base i64)
    (block
      (return (call (ident mkdir) (ident path) (ident mode)))))
  (func os_unlink ((param path (type_ptr (type_base u8)))) (type_base i64)
    (block
      (return (call (ident unlink) (ident path)))))
  (func os_rmdir ((param path (type_ptr (type_base u8)))) (type_base i64)
    (block
      (return (call (ident rmdir) (ident path)))))
  (func os_fork () (type_base i64)
    (block
      (return (call (ident fork)))))
  (func os_execve ((param path (type_ptr (type_base u8))) (param argv (type_ptr (type_ptr (type_base u8)))) (param envp (type_ptr (type_ptr (type_base u8))))) (type_base i64)
    (block
      (return (call (ident execve) (ident path) (ident argv) (ident envp)))))
  (func os_waitpid ((param pid (type_base i64)) (param status (type_ptr (type_base i64))) (param options (type_base i64))) (type_base i64)
    (block
      (return (call (ident waitpid) (ident pid) (ident status) (ident options)))))
  (func os_pipe ((param fds (type_ptr (type_base i64)))) (type_base i64)
    (block
      (return (call (ident pipe) (ident fds)))))
  (func os_dup2 ((param oldfd (type_base i64)) (param newfd (type_base i64))) (type_base i64)
    (block
      (return (call (ident dup2) (ident oldfd) (ident newfd)))))
  (func os__exit ((param status (type_base i64))) (type_base void)
    (block
      (expr_stmt (call (ident _exit) (ident status)))))
  (func pub alloc ((param size (type_base i64))) (type_ptr (type_base u8))
    (block
      (return (call (ident calloc) (number 1) (ident size)))))
  (func pub init_environ ((param envp (type_ptr (type_ptr (type_base u8))))) (type_base void)
    (block))
  (func pub find_in_path ((param tool (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var path_env (type_ptr (type_base u8)) (call (ident getenv) (string "PATH")))
      (if (binop == (ident path_env) (nil))
        (block
          (return (nil))))
      (var path (type_ptr (type_base u8)) (call (ident str_dup) (ident path_env)))
      (var start (type_ptr (type_base u8)) (ident path))
      (var p (type_ptr (type_base u8)) (ident path))
      (var buf (type_ptr (type_base u8)) (call (ident alloc) (number 1024)))
      (while (binop != (unop * (ident p)) (number 0))
        (block
          (if (binop == (unop * (ident p)) (number 58))
            (block
              (assign (unop * (ident p)) (number 0))
              (var i (type_base i64) (number 0))
              (var s (type_ptr (type_base u8)) (ident start))
              (while (binop != (unop * (ident s)) (number 0))
                (block
                  (assign (unop * (binop + (ident buf) (ident i))) (unop * (ident s)))
                  (assign (ident i) (binop + (ident i) (number 1)))
                  (assign (ident s) (binop + (ident s) (number 1)))))
              (assign (unop * (binop + (ident buf) (ident i))) (number 47))
              (assign (ident i) (binop + (ident i) (number 1)))
              (assign (ident s) (ident tool))
              (while (binop != (unop * (ident s)) (number 0))
                (block
                  (assign (unop * (binop + (ident buf) (ident i))) (unop * (ident s)))
                  (assign (ident i) (binop + (ident i) (number 1)))
                  (assign (ident s) (binop + (ident s) (number 1)))))
              (assign (unop * (binop + (ident buf) (ident i))) (number 0))
              (var fd (type_base i64) (call (ident file_open) (ident buf) (number 0)))
              (if (binop >= (ident fd) (number 0))
                (block
                  (expr_stmt (call (ident file_close) (ident fd)))
                  (return (call (ident str_dup) (ident buf)))))
              (assign (ident start) (binop + (ident p) (number 1)))))
          (assign (ident p) (binop + (ident p) (number 1)))))
      (if (binop != (unop * (ident start)) (number 0))
        (block
          (var i (type_base i64) (number 0))
          (var s (type_ptr (type_base u8)) (ident start))
          (while (binop != (unop * (ident s)) (number 0))
            (block
              (assign (unop * (binop + (ident buf) (ident i))) (unop * (ident s)))
              (assign (ident i) (binop + (ident i) (number 1)))
              (assign (ident s) (binop + (ident s) (number 1)))))
          (assign (unop * (binop + (ident buf) (ident i))) (number 47))
          (assign (ident i) (binop + (ident i) (number 1)))
          (assign (ident s) (ident tool))
          (while (binop != (unop * (ident s)) (number 0))
            (block
              (assign (unop * (binop + (ident buf) (ident i))) (unop * (ident s)))
              (assign (ident i) (binop + (ident i) (number 1)))
              (assign (ident s) (binop + (ident s) (number 1)))))
          (assign (unop * (binop + (ident buf) (ident i))) (number 0))
          (var fd (type_base i64) (call (ident file_open) (ident buf) (number 0)))
          (if (binop >= (ident fd) (number 0))
            (block
              (expr_stmt (call (ident file_close) (ident fd)))
              (return (call (ident str_dup) (ident buf)))))))
      (return (nil))))
  (func pub find_clang () (type_ptr (type_base u8))
    (block
      (var path_clang (type_ptr (type_base u8)) (call (ident find_in_path) (string "clang")))
      (if (binop != (ident path_clang) (nil))
        (block
          (return (ident path_clang))))
      (var buf (type_ptr (type_base u8)) (call (ident alloc) (number 256)))
      (var loc1 (type_ptr (type_base u8)) (string "/opt/homebrew/opt/llvm/bin/clang"))
      (var fd (type_base i64) (call (ident file_open) (ident loc1) (number 0)))
      (if (binop >= (ident fd) (number 0))
        (block
          (expr_stmt (call (ident file_close) (ident fd)))
          (return (ident loc1))))
      (var loc2 (type_ptr (type_base u8)) (string "/usr/bin/clang"))
      (assign (ident fd) (call (ident file_open) (ident loc2) (number 0)))
      (if (binop >= (ident fd) (number 0))
        (block
          (expr_stmt (call (ident file_close) (ident fd)))
          (return (ident loc2))))
      (var loc3 (type_ptr (type_base u8)) (string "/usr/local/bin/clang"))
      (assign (ident fd) (call (ident file_open) (ident loc3) (number 0)))
      (if (binop >= (ident fd) (number 0))
        (block
          (expr_stmt (call (ident file_close) (ident fd)))
          (return (ident loc3))))
      (return (nil))))
  (func pub find_as () (type_ptr (type_base u8))
    (block
      (var path_as (type_ptr (type_base u8)) (call (ident find_in_path) (string "as")))
      (if (binop != (ident path_as) (nil))
        (block
          (return (ident path_as))))
      (var loc1 (type_ptr (type_base u8)) (string "/usr/bin/as"))
      (var fd (type_base i64) (call (ident file_open) (ident loc1) (number 0)))
      (if (binop >= (ident fd) (number 0))
        (block
          (expr_stmt (call (ident file_close) (ident fd)))
          (return (ident loc1))))
      (return (nil))))
  (func pub find_ld () (type_ptr (type_base u8))
    (block
      (var path_ld (type_ptr (type_base u8)) (call (ident find_in_path) (string "ld")))
      (if (binop != (ident path_ld) (nil))
        (block
          (return (ident path_ld))))
      (var loc1 (type_ptr (type_base u8)) (string "/usr/bin/ld"))
      (var fd (type_base i64) (call (ident file_open) (ident loc1) (number 0)))
      (if (binop >= (ident fd) (number 0))
        (block
          (expr_stmt (call (ident file_close) (ident fd)))
          (return (ident loc1))))
      (return (nil))))
  (func pub find_lli () (type_ptr (type_base u8))
    (block
      (var path_lli (type_ptr (type_base u8)) (call (ident find_in_path) (string "lli")))
      (if (binop != (ident path_lli) (nil))
        (block
          (return (ident path_lli))))
      (var loc1 (type_ptr (type_base u8)) (string "/opt/homebrew/opt/llvm/bin/lli"))
      (var fd (type_base i64) (call (ident file_open) (ident loc1) (number 0)))
      (if (binop >= (ident fd) (number 0))
        (block
          (expr_stmt (call (ident file_close) (ident fd)))
          (return (ident loc1))))
      (return (nil))))
  (func pub vec_new ((param cap (type_base i64))) (type_ptr (type_base u8))
    (block
      (var v (type_ptr (type_base u8)) (call (ident malloc) (number 24)))
      (if (binop < (ident cap) (number 4))
        (block
          (assign (ident cap) (number 4))))
      (var cap_ptr (type_ptr (type_base i64)) (ident v))
      (assign (unop * (ident cap_ptr)) (ident cap))
      (var len_ptr (type_ptr (type_base i64)) (binop + (ident v) (number 8)))
      (assign (unop * (ident len_ptr)) (number 0))
      (var data_ptr (type_ptr (type_ptr (type_base u8))) (binop + (ident v) (number 16)))
      (assign (unop * (ident data_ptr)) (call (ident malloc) (binop * (ident cap) (number 8))))
      (return (ident v))))
  (func pub vec_len ((param v (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var len_ptr (type_ptr (type_base i64)) (binop + (ident v) (number 8)))
      (return (unop * (ident len_ptr)))))
  (func pub vec_get ((param v (type_ptr (type_base u8))) (param index (type_base i64))) (type_base i64)
    (block
      (var data_ptr (type_ptr (type_ptr (type_base u8))) (binop + (ident v) (number 16)))
      (var data (type_ptr (type_base u8)) (unop * (ident data_ptr)))
      (var elem_ptr (type_ptr (type_base i64)) (binop + (ident data) (binop * (ident index) (number 8))))
      (return (unop * (ident elem_ptr)))))
  (func pub vec_set ((param v (type_ptr (type_base u8))) (param index (type_base i64)) (param value (type_base i64))) nil
    (block
      (var data_ptr (type_ptr (type_ptr (type_base u8))) (binop + (ident v) (number 16)))
      (var data (type_ptr (type_base u8)) (unop * (ident data_ptr)))
      (var elem_ptr (type_ptr (type_base i64)) (binop + (ident data) (binop * (ident index) (number 8))))
      (assign (unop * (ident elem_ptr)) (ident value))))
  (func pub vec_push ((param v (type_ptr (type_base u8))) (param value (type_base i64))) nil
    (block
      (var cap_ptr (type_ptr (type_base i64)) (ident v))
      (var len_ptr (type_ptr (type_base i64)) (binop + (ident v) (number 8)))
      (var data_ptr (type_ptr (type_ptr (type_base u8))) (binop + (ident v) (number 16)))
      (var cap (type_base i64) (unop * (ident cap_ptr)))
      (var len (type_base i64) (unop * (ident len_ptr)))
      (var data (type_ptr (type_base u8)) (unop * (ident data_ptr)))
      (if (binop >= (ident len) (ident cap))
        (block
          (var new_cap (type_base i64) (binop * (ident cap) (number 2)))
          (var new_data (type_ptr (type_base u8)) (call (ident malloc) (binop * (ident new_cap) (number 8))))
          (var i (type_base i64) (number 0))
          (while (binop < (ident i) (ident len))
            (block
              (var old_ptr (type_ptr (type_base i64)) (binop + (ident data) (binop * (ident i) (number 8))))
              (var new_ptr (type_ptr (type_base i64)) (binop + (ident new_data) (binop * (ident i) (number 8))))
              (assign (unop * (ident new_ptr)) (unop * (ident old_ptr)))
              (assign (ident i) (binop + (ident i) (number 1)))))
          (expr_stmt (call (ident free) (ident data)))
          (assign (unop * (ident cap_ptr)) (ident new_cap))
          (assign (unop * (ident data_ptr)) (ident new_data))
          (assign (ident data) (ident new_data))))
      (var elem_ptr (type_ptr (type_base i64)) (binop + (ident data) (binop * (ident len) (number 8))))
      (assign (unop * (ident elem_ptr)) (ident value))
      (assign (unop * (ident len_ptr)) (binop + (ident len) (number 1)))))
  (func pub vec_free ((param v (type_ptr (type_base u8)))) nil
    (block
      (var data_ptr (type_ptr (type_ptr (type_base u8))) (binop + (ident v) (number 16)))
      (var data (type_ptr (type_base u8)) (unop * (ident data_ptr)))
      (expr_stmt (call (ident free) (ident data)))
      (expr_stmt (call (ident free) (ident v)))))
  (func pub vec_pop ((param v (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var len_ptr (type_ptr (type_base i64)) (binop + (ident v) (number 8)))
      (var data_ptr (type_ptr (type_ptr (type_base u8))) (binop + (ident v) (number 16)))
      (var len (type_base i64) (unop * (ident len_ptr)))
      (if (binop == (ident len) (number 0))
        (block
          (return (number 0))))
      (assign (ident len) (binop - (ident len) (number 1)))
      (assign (unop * (ident len_ptr)) (ident len))
      (var data (type_ptr (type_base u8)) (unop * (ident data_ptr)))
      (var elem_ptr (type_ptr (type_base i64)) (binop + (ident data) (binop * (ident len) (number 8))))
      (return (unop * (ident elem_ptr)))))
  (func pub hash_str ((param s (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var h (type_base i64) (number 5381))
      (while (binop != (unop * (ident s)) (number 0))
        (block
          (assign (ident h) (binop + (binop * (ident h) (number 33)) (unop * (ident s))))
          (assign (ident s) (binop + (ident s) (number 1)))))
      (if (binop < (ident h) (number 0))
        (block
          (assign (ident h) (binop - (number 0) (ident h)))))
      (return (ident h))))
  (func pub map_new () (type_ptr (type_base u8))
    (block
      (var m (type_ptr (type_base u8)) (call (ident malloc) (number 32)))
      (var cap_ptr (type_ptr (type_base i64)) (ident m))
      (assign (unop * (ident cap_ptr)) (number 16))
      (var count_ptr (type_ptr (type_base i64)) (binop + (ident m) (number 8)))
      (assign (unop * (ident count_ptr)) (number 0))
      (var keys_ptr (type_ptr (type_ptr (type_base u8))) (binop + (ident m) (number 16)))
      (var keys (type_ptr (type_base u8)) (call (ident malloc) (number 128)))
      (assign (unop * (ident keys_ptr)) (ident keys))
      (var i (type_base i64) (number 0))
      (while (binop < (ident i) (number 16))
        (block
          (var slot (type_ptr (type_ptr (type_base u8))) (binop + (ident keys) (binop * (ident i) (number 8))))
          (assign (unop * (ident slot)) (nil))
          (assign (ident i) (binop + (ident i) (number 1)))))
      (var vals_ptr (type_ptr (type_ptr (type_base u8))) (binop + (ident m) (number 24)))
      (assign (unop * (ident vals_ptr)) (call (ident malloc) (number 128)))
      (return (ident m))))
  (func map_find_slot ((param m (type_ptr (type_base u8))) (param key (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var cap_ptr (type_ptr (type_base i64)) (ident m))
      (var cap (type_base i64) (unop * (ident cap_ptr)))
      (var keys_ptr (type_ptr (type_ptr (type_base u8))) (binop + (ident m) (number 16)))
      (var keys (type_ptr (type_base u8)) (unop * (ident keys_ptr)))
      (var h (type_base i64) (binop % (call (ident hash_str) (ident key)) (ident cap)))
      (var i (type_base i64) (number 0))
      (while (binop < (ident i) (ident cap))
        (block
          (var idx (type_base i64) (binop % (binop + (ident h) (ident i)) (ident cap)))
          (var slot (type_ptr (type_ptr (type_base u8))) (binop + (ident keys) (binop * (ident idx) (number 8))))
          (var slot_key (type_ptr (type_base u8)) (unop * (ident slot)))
          (if (binop == (ident slot_key) (nil))
            (block
              (return (ident idx))))
          (if (call (ident streq) (ident slot_key) (ident key))
            (block
              (return (ident idx))))
          (assign (ident i) (binop + (ident i) (number 1)))))
      (return (binop - (number 0) (number 1)))))
  (func map_grow ((param m (type_ptr (type_base u8)))) nil
    (block
      (var cap_ptr (type_ptr (type_base i64)) (ident m))
      (var count_ptr (type_ptr (type_base i64)) (binop + (ident m) (number 8)))
      (var keys_ptr (type_ptr (type_ptr (type_base u8))) (binop + (ident m) (number 16)))
      (var vals_ptr (type_ptr (type_ptr (type_base u8))) (binop + (ident m) (number 24)))
      (var old_cap (type_base i64) (unop * (ident cap_ptr)))
      (var old_keys (type_ptr (type_base u8)) (unop * (ident keys_ptr)))
      (var old_vals (type_ptr (type_base u8)) (unop * (ident vals_ptr)))
      (var new_cap (type_base i64) (binop * (ident old_cap) (number 2)))
      (assign (unop * (ident cap_ptr)) (ident new_cap))
      (assign (unop * (ident count_ptr)) (number 0))
      (var new_keys (type_ptr (type_base u8)) (call (ident malloc) (binop * (ident new_cap) (number 8))))
      (var new_vals (type_ptr (type_base u8)) (call (ident malloc) (binop * (ident new_cap) (number 8))))
      (var i (type_base i64) (number 0))
      (while (binop < (ident i) (ident new_cap))
        (block
          (var slot (type_ptr (type_ptr (type_base u8))) (binop + (ident new_keys) (binop * (ident i) (number 8))))
          (assign (unop * (ident slot)) (nil))
          (assign (ident i) (binop + (ident i) (number 1)))))
      (assign (unop * (ident keys_ptr)) (ident new_keys))
      (assign (unop * (ident vals_ptr)) (ident new_vals))
      (assign (ident i) (number 0))
      (while (binop < (ident i) (ident old_cap))
        (block
          (var old_slot (type_ptr (type_ptr (type_base u8))) (binop + (ident old_keys) (binop * (ident i) (number 8))))
          (var old_key (type_ptr (type_base u8)) (unop * (ident old_slot)))
          (if (binop != (ident old_key) (nil))
            (block
              (var old_val_ptr (type_ptr (type_base i64)) (binop + (ident old_vals) (binop * (ident i) (number 8))))
              (var old_val (type_base i64) (unop * (ident old_val_ptr)))
              (var idx (type_base i64) (call (ident map_find_slot) (ident m) (ident old_key)))
              (var new_slot (type_ptr (type_ptr (type_base u8))) (binop + (ident new_keys) (binop * (ident idx) (number 8))))
              (assign (unop * (ident new_slot)) (ident old_key))
              (var new_val_ptr (type_ptr (type_base i64)) (binop + (ident new_vals) (binop * (ident idx) (number 8))))
              (assign (unop * (ident new_val_ptr)) (ident old_val))
              (var count (type_base i64) (unop * (ident count_ptr)))
              (assign (unop * (ident count_ptr)) (binop + (ident count) (number 1)))))
          (assign (ident i) (binop + (ident i) (number 1)))))
      (expr_stmt (call (ident free) (ident old_keys)))
      (expr_stmt (call (ident free) (ident old_vals)))))
  (func pub map_set ((param m (type_ptr (type_base u8))) (param key (type_ptr (type_base u8))) (param value (type_base i64))) nil
    (block
      (var cap_ptr (type_ptr (type_base i64)) (ident m))
      (var count_ptr (type_ptr (type_base i64)) (binop + (ident m) (number 8)))
      (var keys_ptr (type_ptr (type_ptr (type_base u8))) (binop + (ident m) (number 16)))
      (var vals_ptr (type_ptr (type_ptr (type_base u8))) (binop + (ident m) (number 24)))
      (var cap (type_base i64) (unop * (ident cap_ptr)))
      (var count (type_base i64) (unop * (ident count_ptr)))
      (if (binop > (binop * (ident count) (number 4)) (binop * (ident cap) (number 3)))
        (block
          (expr_stmt (call (ident map_grow) (ident m)))))
      (var keys (type_ptr (type_base u8)) (unop * (ident keys_ptr)))
      (var vals (type_ptr (type_base u8)) (unop * (ident vals_ptr)))
      (var idx (type_base i64) (call (ident map_find_slot) (ident m) (ident key)))
      (var slot (type_ptr (type_ptr (type_base u8))) (binop + (ident keys) (binop * (ident idx) (number 8))))
      (var slot_key (type_ptr (type_base u8)) (unop * (ident slot)))
      (if (binop == (ident slot_key) (nil))
        (block
          (assign (unop * (ident slot)) (ident key))
          (assign (ident count) (unop * (ident count_ptr)))
          (assign (unop * (ident count_ptr)) (binop + (ident count) (number 1)))))
      (var val_ptr (type_ptr (type_base i64)) (binop + (ident vals) (binop * (ident idx) (number 8))))
      (assign (unop * (ident val_ptr)) (ident value))))
  (func pub map_get ((param m (type_ptr (type_base u8))) (param key (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var keys_ptr (type_ptr (type_ptr (type_base u8))) (binop + (ident m) (number 16)))
      (var vals_ptr (type_ptr (type_ptr (type_base u8))) (binop + (ident m) (number 24)))
      (var keys (type_ptr (type_base u8)) (unop * (ident keys_ptr)))
      (var vals (type_ptr (type_base u8)) (unop * (ident vals_ptr)))
      (var idx (type_base i64) (call (ident map_find_slot) (ident m) (ident key)))
      (var slot (type_ptr (type_ptr (type_base u8))) (binop + (ident keys) (binop * (ident idx) (number 8))))
      (var slot_key (type_ptr (type_base u8)) (unop * (ident slot)))
      (if (binop == (ident slot_key) (nil))
        (block
          (return (number 0))))
      (var val_ptr (type_ptr (type_base i64)) (binop + (ident vals) (binop * (ident idx) (number 8))))
      (return (unop * (ident val_ptr)))))
  (func pub map_has ((param m (type_ptr (type_base u8))) (param key (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var keys_ptr (type_ptr (type_ptr (type_base u8))) (binop + (ident m) (number 16)))
      (var keys (type_ptr (type_base u8)) (unop * (ident keys_ptr)))
      (var idx (type_base i64) (call (ident map_find_slot) (ident m) (ident key)))
      (var slot (type_ptr (type_ptr (type_base u8))) (binop + (ident keys) (binop * (ident idx) (number 8))))
      (var slot_key (type_ptr (type_base u8)) (unop * (ident slot)))
      (if (binop == (ident slot_key) (nil))
        (block
          (return (number 0))))
      (return (number 1))))
  (func pub map_free ((param m (type_ptr (type_base u8)))) nil
    (block
      (var keys_ptr (type_ptr (type_ptr (type_base u8))) (binop + (ident m) (number 16)))
      (var vals_ptr (type_ptr (type_ptr (type_base u8))) (binop + (ident m) (number 24)))
      (expr_stmt (call (ident free) (unop * (ident keys_ptr))))
      (expr_stmt (call (ident free) (unop * (ident vals_ptr))))
      (expr_stmt (call (ident free) (ident m)))))
  (func pub map_size ((param m (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var count_ptr (type_ptr (type_base i64)) (binop + (ident m) (number 8)))
      (return (unop * (ident count_ptr)))))
  (func pub map_keys ((param m (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var cap_ptr (type_ptr (type_base i64)) (ident m))
      (var cap (type_base i64) (unop * (ident cap_ptr)))
      (var keys_ptr (type_ptr (type_ptr (type_base u8))) (binop + (ident m) (number 16)))
      (var keys (type_ptr (type_base u8)) (unop * (ident keys_ptr)))
      (var result (type_ptr (type_base u8)) (call (ident vec_new) (number 16)))
      (var i (type_base i64) (number 0))
      (while (binop < (ident i) (ident cap))
        (block
          (var slot (type_ptr (type_ptr (type_base u8))) (binop + (ident keys) (binop * (ident i) (number 8))))
          (var key (type_ptr (type_base u8)) (unop * (ident slot)))
          (if (binop != (ident key) (nil))
            (block
              (expr_stmt (call (ident vec_push) (ident result) (ident key)))))
          (assign (ident i) (binop + (ident i) (number 1)))))
      (return (ident result))))
  (func pub str_dup_n ((param s (type_ptr (type_base u8))) (param len (type_base i64))) (type_ptr (type_base u8))
    (block
      (var result (type_ptr (type_base u8)) (call (ident malloc) (binop + (ident len) (number 1))))
      (var i (type_base i64) (number 0))
      (while (binop < (ident i) (ident len))
        (block
          (assign (unop * (binop + (ident result) (ident i))) (unop * (binop + (ident s) (ident i))))
          (assign (ident i) (binop + (ident i) (number 1)))))
      (assign (unop * (binop + (ident result) (ident len))) (number 0))
      (return (ident result))))
  (func pub map_set_n ((param m (type_ptr (type_base u8))) (param key (type_ptr (type_base u8))) (param key_len (type_base i64)) (param value (type_base i64))) (type_base void)
    (block
      (var key_copy (type_ptr (type_base u8)) (call (ident str_dup_n) (ident key) (ident key_len)))
      (expr_stmt (call (ident map_set) (ident m) (ident key_copy) (ident value)))))
  (func pub map_get_n ((param m (type_ptr (type_base u8))) (param key (type_ptr (type_base u8))) (param key_len (type_base i64))) (type_base i64)
    (block
      (var key_copy (type_ptr (type_base u8)) (call (ident str_dup_n) (ident key) (ident key_len)))
      (var result (type_base i64) (call (ident map_get) (ident m) (ident key_copy)))
      (expr_stmt (call (ident free) (ident key_copy)))
      (return (ident result))))
  (func pub file_open ((param path (type_ptr (type_base u8))) (param flags (type_base i64))) (type_base i64)
    (block
      (return (call (ident os_open) (ident path) (ident flags) (number 420)))))
  (func pub file_read ((param fd (type_base i64)) (param buf (type_ptr (type_base u8))) (param n (type_base i64))) (type_base i64)
    (block
      (return (call (ident os_read) (ident fd) (ident buf) (ident n)))))
  (func pub file_write ((param fd (type_base i64)) (param buf (type_ptr (type_base u8))) (param n (type_base i64))) (type_base i64)
    (block
      (return (call (ident os_write) (ident fd) (ident buf) (ident n)))))
  (func pub file_close ((param fd (type_base i64))) nil
    (block
      (expr_stmt (call (ident os_close) (ident fd)))))
  (func pub strlen ((param s (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var n (type_base i64) (number 0))
      (while (binop != (unop * (binop + (ident s) (ident n))) (number 0))
        (block
          (assign (ident n) (binop + (ident n) (number 1)))))
      (return (ident n))))
  (func pub memcpy ((param dst (type_ptr (type_base u8))) (param src (type_ptr (type_base u8))) (param n (type_base i64))) (type_base void)
    (block
      (var i (type_base i64) (number 0))
      (while (binop < (ident i) (ident n))
        (block
          (assign (unop * (binop + (ident dst) (ident i))) (unop * (binop + (ident src) (ident i))))
          (assign (ident i) (binop + (ident i) (number 1)))))))
  (func pub streq ((param a (type_ptr (type_base u8))) (param b (type_ptr (type_base u8)))) (type_base i64)
    (block
      (while (binop && (binop != (unop * (ident a)) (number 0)) (binop != (unop * (ident b)) (number 0)))
        (block
          (if (binop != (unop * (ident a)) (unop * (ident b)))
            (block
              (return (number 0))))
          (assign (ident a) (binop + (ident a) (number 1)))
          (assign (ident b) (binop + (ident b) (number 1)))))
      (if (binop == (unop * (ident a)) (unop * (ident b)))
        (block
          (return (number 1))))
      (return (number 0))))
  (func pub str_eq_n ((param a (type_ptr (type_base u8))) (param a_len (type_base i64)) (param b (type_ptr (type_base u8))) (param b_len (type_base i64))) (type_base bool)
    (block
      (if (binop != (ident a_len) (ident b_len))
        (block
          (return (bool false))))
      (var i (type_base i64) (number 0))
      (while (binop < (ident i) (ident a_len))
        (block
          (if (binop != (unop * (binop + (ident a) (ident i))) (unop * (binop + (ident b) (ident i))))
            (block
              (return (bool false))))
          (assign (ident i) (binop + (ident i) (number 1)))))
      (return (bool true))))
  (func pub str_concat ((param a (type_ptr (type_base u8))) (param b (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var len_a (type_base i64) (call (ident strlen) (ident a)))
      (var len_b (type_base i64) (call (ident strlen) (ident b)))
      (var result (type_ptr (type_base u8)) (call (ident malloc) (binop + (binop + (ident len_a) (ident len_b)) (number 1))))
      (var i (type_base i64) (number 0))
      (while (binop < (ident i) (ident len_a))
        (block
          (assign (unop * (binop + (ident result) (ident i))) (unop * (binop + (ident a) (ident i))))
          (assign (ident i) (binop + (ident i) (number 1)))))
      (var j (type_base i64) (number 0))
      (while (binop < (ident j) (ident len_b))
        (block
          (assign (unop * (binop + (binop + (ident result) (ident len_a)) (ident j))) (unop * (binop + (ident b) (ident j))))
          (assign (ident j) (binop + (ident j) (number 1)))))
      (assign (unop * (binop + (binop + (ident result) (ident len_a)) (ident len_b))) (number 0))
      (return (ident result))))
  (func pub str_dup ((param s (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var len (type_base i64) (call (ident strlen) (ident s)))
      (var result (type_ptr (type_base u8)) (call (ident malloc) (binop + (ident len) (number 1))))
      (var i (type_base i64) (number 0))
      (while (binop <= (ident i) (ident len))
        (block
          (assign (unop * (binop + (ident result) (ident i))) (unop * (binop + (ident s) (ident i))))
          (assign (ident i) (binop + (ident i) (number 1)))))
      (return (ident result))))
  (func pub str_starts_with ((param s (type_ptr (type_base u8))) (param prefix (type_ptr (type_base u8)))) (type_base i64)
    (block
      (while (binop != (unop * (ident prefix)) (number 0))
        (block
          (if (binop != (unop * (ident s)) (unop * (ident prefix)))
            (block
              (return (number 0))))
          (assign (ident s) (binop + (ident s) (number 1)))
          (assign (ident prefix) (binop + (ident prefix) (number 1)))))
      (return (number 1))))
  (func pub print ((param s (type_ptr (type_base u8)))) nil
    (block
      (expr_stmt (call (ident file_write) (number 1) (ident s) (call (ident strlen) (ident s))))))
  (func pub println ((param s (type_ptr (type_base u8)))) nil
    (block
      (expr_stmt (call (ident print) (ident s)))
      (expr_stmt (call (ident file_write) (number 1) (string "\n") (number 1)))))
  (func pub eprint ((param s (type_ptr (type_base u8)))) nil
    (block
      (expr_stmt (call (ident file_write) (number 2) (ident s) (call (ident strlen) (ident s))))))
  (func pub eprintln ((param s (type_ptr (type_base u8)))) nil
    (block
      (expr_stmt (call (ident eprint) (ident s)))
      (expr_stmt (call (ident file_write) (number 2) (string "\n") (number 1)))))
  (func pub eprint_buf ((param buf (type_ptr (type_base u8))) (param len (type_base i64))) nil
    (block
      (expr_stmt (call (ident file_write) (number 2) (ident buf) (ident len)))))
  (func pub eprint_i64 ((param n (type_base i64))) nil
    (block
      (if (binop < (ident n) (number 0))
        (block
          (expr_stmt (call (ident file_write) (number 2) (string "-") (number 1)))
          (assign (ident n) (binop - (number 0) (ident n)))))
      (if (binop == (ident n) (number 0))
        (block
          (expr_stmt (call (ident file_write) (number 2) (string "0") (number 1)))
          (return)))
      (var divisor (type_base i64) (number 1))
      (var temp (type_base i64) (ident n))
      (while (binop >= (ident temp) (number 10))
        (block
          (assign (ident temp) (binop / (ident temp) (number 10)))
          (assign (ident divisor) (binop * (ident divisor) (number 10)))))
      (while (binop > (ident divisor) (number 0))
        (block
          (var digit (type_base i64) (binop / (ident n) (ident divisor)))
          (var c (type_base u8) (binop + (number 48) (ident digit)))
          (expr_stmt (call (ident file_write) (number 2) (unop & (ident c)) (number 1)))
          (assign (ident n) (binop % (ident n) (ident divisor)))
          (assign (ident divisor) (binop / (ident divisor) (number 10)))))))
  (func pub print_digit ((param d (type_base i64))) nil
    (block
      (var c (type_base u8) (binop + (number 48) (ident d)))
      (expr_stmt (call (ident file_write) (number 1) (unop & (ident c)) (number 1)))))
  (func pub print_int ((param n (type_base i64))) nil
    (block
      (if (binop < (ident n) (number 0))
        (block
          (expr_stmt (call (ident file_write) (number 1) (string "-") (number 1)))
          (assign (ident n) (binop - (number 0) (ident n)))))
      (if (binop == (ident n) (number 0))
        (block
          (expr_stmt (call (ident file_write) (number 1) (string "0") (number 1)))
          (return)))
      (var divisor (type_base i64) (number 1))
      (var temp (type_base i64) (ident n))
      (while (binop >= (ident temp) (number 10))
        (block
          (assign (ident temp) (binop / (ident temp) (number 10)))
          (assign (ident divisor) (binop * (ident divisor) (number 10)))))
      (while (binop > (ident divisor) (number 0))
        (block
          (var digit (type_base i64) (binop / (ident n) (ident divisor)))
          (expr_stmt (call (ident print_digit) (ident digit)))
          (assign (ident n) (binop % (ident n) (ident divisor)))
          (assign (ident divisor) (binop / (ident divisor) (number 10)))))))
  (func pub itoa ((param n (type_base i64)) (param buf (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var pos (type_base i64) (number 0))
      (if (binop < (ident n) (number 0))
        (block
          (assign (unop * (binop + (ident buf) (ident pos))) (number 45))
          (assign (ident pos) (binop + (ident pos) (number 1)))
          (assign (ident n) (binop - (number 0) (ident n)))))
      (if (binop == (ident n) (number 0))
        (block
          (assign (unop * (binop + (ident buf) (ident pos))) (number 48))
          (return (binop + (ident pos) (number 1)))))
      (var divisor (type_base i64) (number 1))
      (var temp (type_base i64) (ident n))
      (while (binop >= (ident temp) (number 10))
        (block
          (assign (ident temp) (binop / (ident temp) (number 10)))
          (assign (ident divisor) (binop * (ident divisor) (number 10)))))
      (while (binop > (ident divisor) (number 0))
        (block
          (var digit (type_base i64) (binop / (ident n) (ident divisor)))
          (assign (unop * (binop + (ident buf) (ident pos))) (binop + (number 48) (ident digit)))
          (assign (ident pos) (binop + (ident pos) (number 1)))
          (assign (ident n) (binop % (ident n) (ident divisor)))
          (assign (ident divisor) (binop / (ident divisor) (number 10)))))
      (return (ident pos))))
  (func pub file_mtime ((param path (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var statbuf (type_ptr (type_base u8)) (call (ident alloc) (number 144)))
      (var result (type_base i64) (call (ident os_stat) (ident path) (ident statbuf)))
      (if (binop < (ident result) (number 0))
        (block
          (return (number 0))))
      (var mtime_ptr (type_ptr (type_base i64)) (binop + (ident statbuf) (number 88)))
      (return (unop * (ident mtime_ptr)))))
  (var TOKEN_EOF (type_base i64) (number 0))
  (var TOKEN_ERROR (type_base i64) (number 1))
  (var TOKEN_IDENT (type_base i64) (number 2))
  (var TOKEN_NUMBER (type_base i64) (number 3))
  (var TOKEN_STRING (type_base i64) (number 4))
  (var TOKEN_FUNC (type_base i64) (number 5))
  (var TOKEN_VAR (type_base i64) (number 6))
  (var TOKEN_STRUCT (type_base i64) (number 7))
  (var TOKEN_IF (type_base i64) (number 8))
  (var TOKEN_ELSE (type_base i64) (number 9))
  (var TOKEN_WHILE (type_base i64) (number 10))
  (var TOKEN_RETURN (type_base i64) (number 11))
  (var TOKEN_TRUE (type_base i64) (number 12))
  (var TOKEN_FALSE (type_base i64) (number 13))
  (var TOKEN_NIL (type_base i64) (number 14))
  (var TOKEN_I8 (type_base i64) (number 15))
  (var TOKEN_I16 (type_base i64) (number 16))
  (var TOKEN_I32 (type_base i64) (number 17))
  (var TOKEN_I64 (type_base i64) (number 18))
  (var TOKEN_U8 (type_base i64) (number 19))
  (var TOKEN_U16 (type_base i64) (number 20))
  (var TOKEN_U32 (type_base i64) (number 21))
  (var TOKEN_U64 (type_base i64) (number 22))
  (var TOKEN_BOOL (type_base i64) (number 23))
  (var TOKEN_VOID (type_base i64) (number 24))
  (var TOKEN_PLUS (type_base i64) (number 25))
  (var TOKEN_MINUS (type_base i64) (number 26))
  (var TOKEN_STAR (type_base i64) (number 27))
  (var TOKEN_SLASH (type_base i64) (number 28))
  (var TOKEN_PERCENT (type_base i64) (number 29))
  (var TOKEN_AMP (type_base i64) (number 30))
  (var TOKEN_BANG (type_base i64) (number 31))
  (var TOKEN_EQ (type_base i64) (number 32))
  (var TOKEN_EQEQ (type_base i64) (number 33))
  (var TOKEN_BANGEQ (type_base i64) (number 34))
  (var TOKEN_LT (type_base i64) (number 35))
  (var TOKEN_GT (type_base i64) (number 36))
  (var TOKEN_LTEQ (type_base i64) (number 37))
  (var TOKEN_GTEQ (type_base i64) (number 38))
  (var TOKEN_AMPAMP (type_base i64) (number 39))
  (var TOKEN_PIPEPIPE (type_base i64) (number 40))
  (var TOKEN_LPAREN (type_base i64) (number 41))
  (var TOKEN_RPAREN (type_base i64) (number 42))
  (var TOKEN_LBRACE (type_base i64) (number 43))
  (var TOKEN_RBRACE (type_base i64) (number 44))
  (var TOKEN_LBRACKET (type_base i64) (number 45))
  (var TOKEN_RBRACKET (type_base i64) (number 46))
  (var TOKEN_COMMA (type_base i64) (number 47))
  (var TOKEN_SEMICOLON (type_base i64) (number 48))
  (var TOKEN_DOT (type_base i64) (number 49))
  (var TOKEN_COLON (type_base i64) (number 50))
  (var TOKEN_COLONEQ (type_base i64) (number 51))
  (var TOKEN_MACRO (type_base i64) (number 52))
  (var TOKEN_DOLLAR_LBRACE (type_base i64) (number 53))
  (var TOKEN_DOLLAR (type_base i64) (number 54))
  (var TOKEN_DOLLAR_AT (type_base i64) (number 55))
  (var TOKEN_IMPORT (type_base i64) (number 56))
  (var TOKEN_READER (type_base i64) (number 57))
  (var TOKEN_READER_MACRO (type_base i64) (number 58))
  (var TOKEN_INCLUDE (type_base i64) (number 59))
  (var TOKEN_PIPE (type_base i64) (number 60))
  (var TOKEN_CARET (type_base i64) (number 61))
  (var TOKEN_LTLT (type_base i64) (number 62))
  (var TOKEN_GTGT (type_base i64) (number 63))
  (var TOKEN_PLUSEQ (type_base i64) (number 64))
  (var TOKEN_MINUSEQ (type_base i64) (number 65))
  (var TOKEN_STAREQ (type_base i64) (number 66))
  (var TOKEN_SLASHEQ (type_base i64) (number 67))
  (var TOKEN_PERCENTEQ (type_base i64) (number 68))
  (var TOKEN_BREAK (type_base i64) (number 69))
  (var TOKEN_CONTINUE (type_base i64) (number 70))
  (var TOKEN_LET (type_base i64) (number 71))
  (var TOKEN_IN (type_base i64) (number 72))
  (var TOKEN_FN (type_base i64) (number 73))
  (var TOKEN_ENUM (type_base i64) (number 74))
  (var TOKEN_MATCH (type_base i64) (number 75))
  (var TOKEN_ARROW (type_base i64) (number 76))
  (var TOKEN_EFFECT (type_base i64) (number 77))
  (var TOKEN_PERFORM (type_base i64) (number 78))
  (var TOKEN_HANDLE (type_base i64) (number 79))
  (var TOKEN_WITH (type_base i64) (number 80))
  (var TOKEN_RESUME (type_base i64) (number 81))
  (var TOKEN_CLOSURE (type_base i64) (number 82))
  (var TOKEN_EXTERN (type_base i64) (number 83))
  (var TOKEN_REQUIRE (type_base i64) (number 84))
  (var TOKEN_PUB (type_base i64) (number 85))
  (struct Token ((field_decl type_tok (type_base i64)) (field_decl lexeme (type_ptr (type_base u8))) (field_decl lexeme_len (type_base i64)) (field_decl line (type_base i64)) (field_decl col (type_base i64)) (field_decl content (type_ptr (type_base u8))) (field_decl content_len (type_base i64))))
  (func tok_type ((param tok (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var t (type_ptr (type_base Token)) (ident tok))
      (return (field (ident t) type_tok))))
  (func tok_set_type ((param tok (type_ptr (type_base u8))) (param typ (type_base i64))) (type_base void)
    (block
      (var t (type_ptr (type_base Token)) (ident tok))
      (assign (field (ident t) type_tok) (ident typ))))
  (func tok_lexeme ((param tok (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var t (type_ptr (type_base Token)) (ident tok))
      (return (field (ident t) lexeme))))
  (func tok_set_lexeme ((param tok (type_ptr (type_base u8))) (param ptr (type_ptr (type_base u8)))) (type_base void)
    (block
      (var t (type_ptr (type_base Token)) (ident tok))
      (assign (field (ident t) lexeme) (ident ptr))))
  (func tok_lexeme_len ((param tok (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var t (type_ptr (type_base Token)) (ident tok))
      (return (field (ident t) lexeme_len))))
  (func tok_set_lexeme_len ((param tok (type_ptr (type_base u8))) (param len (type_base i64))) (type_base void)
    (block
      (var t (type_ptr (type_base Token)) (ident tok))
      (assign (field (ident t) lexeme_len) (ident len))))
  (func tok_line ((param tok (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var t (type_ptr (type_base Token)) (ident tok))
      (return (field (ident t) line))))
  (func tok_set_line ((param tok (type_ptr (type_base u8))) (param ln (type_base i64))) (type_base void)
    (block
      (var t (type_ptr (type_base Token)) (ident tok))
      (assign (field (ident t) line) (ident ln))))
  (func tok_col ((param tok (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var t (type_ptr (type_base Token)) (ident tok))
      (return (field (ident t) col))))
  (func tok_set_col ((param tok (type_ptr (type_base u8))) (param c (type_base i64))) (type_base void)
    (block
      (var t (type_ptr (type_base Token)) (ident tok))
      (assign (field (ident t) col) (ident c))))
  (func tok_content ((param tok (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var t (type_ptr (type_base Token)) (ident tok))
      (return (field (ident t) content))))
  (func tok_set_content ((param tok (type_ptr (type_base u8))) (param ptr (type_ptr (type_base u8)))) (type_base void)
    (block
      (var t (type_ptr (type_base Token)) (ident tok))
      (assign (field (ident t) content) (ident ptr))))
  (func tok_content_len ((param tok (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var t (type_ptr (type_base Token)) (ident tok))
      (return (field (ident t) content_len))))
  (func tok_set_content_len ((param tok (type_ptr (type_base u8))) (param len (type_base i64))) (type_base void)
    (block
      (var t (type_ptr (type_base Token)) (ident tok))
      (assign (field (ident t) content_len) (ident len))))
  (func tok_alloc () (type_ptr (type_base u8))
    (block
      (return (call (ident alloc) (number 56)))))
  (var lex_source (type_ptr (type_base u8)) (nil))
  (var lex_source_len (type_base i64) (number 0))
  (var lex_start (type_base i64) (number 0))
  (var lex_current (type_base i64) (number 0))
  (var lex_line (type_base i64) (number 1))
  (var lex_col (type_base i64) (number 1))
  (var lex_start_col (type_base i64) (number 1))
  (func lexer_init ((param source (type_ptr (type_base u8)))) (type_base void)
    (block
      (assign (ident lex_source) (ident source))
      (assign (ident lex_source_len) (call (ident strlen) (ident source)))
      (assign (ident lex_start) (number 0))
      (assign (ident lex_current) (number 0))
      (assign (ident lex_line) (number 1))
      (assign (ident lex_col) (number 1))
      (assign (ident lex_start_col) (number 1))))
  (func is_alpha ((param c (type_base u8))) (type_base bool)
    (block
      (if (binop >= (ident c) (number 97))
        (block
          (if (binop <= (ident c) (number 122))
            (block
              (return (bool true))))))
      (if (binop >= (ident c) (number 65))
        (block
          (if (binop <= (ident c) (number 90))
            (block
              (return (bool true))))))
      (if (binop == (ident c) (number 95))
        (block
          (return (bool true))))
      (return (bool false))))
  (func is_digit ((param c (type_base u8))) (type_base bool)
    (block
      (if (binop >= (ident c) (number 48))
        (block
          (if (binop <= (ident c) (number 57))
            (block
              (return (bool true))))))
      (return (bool false))))
  (func is_alphanumeric ((param c (type_base u8))) (type_base bool)
    (block
      (return (binop || (call (ident is_alpha) (ident c)) (call (ident is_digit) (ident c))))))
  (func lex_is_at_end () (type_base bool)
    (block
      (return (binop >= (ident lex_current) (ident lex_source_len)))))
  (func lex_peek () (type_base u8)
    (block
      (if (call (ident lex_is_at_end))
        (block
          (return (number 0))))
      (return (unop * (binop + (ident lex_source) (ident lex_current))))))
  (func lex_peek_next () (type_base u8)
    (block
      (if (binop >= (binop + (ident lex_current) (number 1)) (ident lex_source_len))
        (block
          (return (number 0))))
      (return (unop * (binop + (binop + (ident lex_source) (ident lex_current)) (number 1))))))
  (func lex_advance () (type_base u8)
    (block
      (var c (type_base u8) (unop * (binop + (ident lex_source) (ident lex_current))))
      (assign (ident lex_current) (binop + (ident lex_current) (number 1)))
      (assign (ident lex_col) (binop + (ident lex_col) (number 1)))
      (return (ident c))))
  (func lex_match ((param expected (type_base u8))) (type_base bool)
    (block
      (if (call (ident lex_is_at_end))
        (block
          (return (bool false))))
      (if (binop != (unop * (binop + (ident lex_source) (ident lex_current))) (ident expected))
        (block
          (return (bool false))))
      (assign (ident lex_current) (binop + (ident lex_current) (number 1)))
      (assign (ident lex_col) (binop + (ident lex_col) (number 1)))
      (return (bool true))))
  (func make_token ((param tok_type (type_base i64))) (type_ptr (type_base u8))
    (block
      (var tok (type_ptr (type_base u8)) (call (ident tok_alloc)))
      (expr_stmt (call (ident tok_set_type) (ident tok) (ident tok_type)))
      (expr_stmt (call (ident tok_set_lexeme) (ident tok) (binop + (ident lex_source) (ident lex_start))))
      (expr_stmt (call (ident tok_set_lexeme_len) (ident tok) (binop - (ident lex_current) (ident lex_start))))
      (expr_stmt (call (ident tok_set_line) (ident tok) (ident lex_line)))
      (expr_stmt (call (ident tok_set_col) (ident tok) (ident lex_start_col)))
      (return (ident tok))))
  (func error_token ((param msg (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var tok (type_ptr (type_base u8)) (call (ident tok_alloc)))
      (expr_stmt (call (ident tok_set_type) (ident tok) (ident TOKEN_ERROR)))
      (expr_stmt (call (ident tok_set_lexeme) (ident tok) (ident msg)))
      (expr_stmt (call (ident tok_set_lexeme_len) (ident tok) (call (ident strlen) (ident msg))))
      (expr_stmt (call (ident tok_set_line) (ident tok) (ident lex_line)))
      (expr_stmt (call (ident tok_set_col) (ident tok) (ident lex_start_col)))
      (return (ident tok))))
  (func skip_block_comment () (type_base void)
    (block
      (expr_stmt (call (ident lex_advance)))
      (expr_stmt (call (ident lex_advance)))
      (var done (type_base i64) (number 0))
      (while (binop && (unop ! (call (ident lex_is_at_end))) (binop == (ident done) (number 0)))
        (block
          (if (binop && (binop == (call (ident lex_peek)) (number 42)) (binop == (call (ident lex_peek_next)) (number 47)))
            (block
              (expr_stmt (call (ident lex_advance)))
              (expr_stmt (call (ident lex_advance)))
              (assign (ident done) (number 1)))
            (block
              (if (binop == (call (ident lex_peek)) (number 10))
                (block
                  (assign (ident lex_line) (binop + (ident lex_line) (number 1)))
                  (assign (ident lex_col) (number 0))))
              (expr_stmt (call (ident lex_advance)))))))))
  (func skip_whitespace () (type_base void)
    (block
      (var done (type_base i64) (number 0))
      (while (binop == (ident done) (number 0))
        (block
          (if (call (ident lex_is_at_end))
            (block
              (assign (ident done) (number 1)))
            (block
              (var c (type_base u8) (call (ident lex_peek)))
              (if (binop || (binop || (binop == (ident c) (number 32)) (binop == (ident c) (number 9))) (binop == (ident c) (number 13)))
                (block
                  (expr_stmt (call (ident lex_advance))))
                (if (binop == (ident c) (number 10))
                  (block
                    (assign (ident lex_line) (binop + (ident lex_line) (number 1)))
                    (assign (ident lex_col) (number 0))
                    (expr_stmt (call (ident lex_advance))))
                  (if (binop == (ident c) (number 47))
                    (block
                      (if (binop == (call (ident lex_peek_next)) (number 47))
                        (block
                          (while (binop && (unop ! (call (ident lex_is_at_end))) (binop != (call (ident lex_peek)) (number 10)))
                            (block
                              (expr_stmt (call (ident lex_advance))))))
                        (if (binop == (call (ident lex_peek_next)) (number 42))
                          (block
                            (expr_stmt (call (ident skip_block_comment))))
                          (block
                            (assign (ident done) (number 1))))))
                    (block
                      (assign (ident done) (number 1))))))))))))
  (func lexeme_eq ((param kw (type_ptr (type_base u8)))) (type_base bool)
    (block
      (var kw_len (type_base i64) (call (ident strlen) (ident kw)))
      (var lex_len (type_base i64) (binop - (ident lex_current) (ident lex_start)))
      (if (binop != (ident kw_len) (ident lex_len))
        (block
          (return (bool false))))
      (var i (type_base i64) (number 0))
      (while (binop < (ident i) (ident kw_len))
        (block
          (if (binop != (unop * (binop + (binop + (ident lex_source) (ident lex_start)) (ident i))) (unop * (binop + (ident kw) (ident i))))
            (block
              (return (bool false))))
          (assign (ident i) (binop + (ident i) (number 1)))))
      (return (bool true))))
  (func check_keyword () (type_base i64)
    (block
      (if (call (ident lexeme_eq) (string "func"))
        (block
          (return (ident TOKEN_FUNC))))
      (if (call (ident lexeme_eq) (string "var"))
        (block
          (return (ident TOKEN_VAR))))
      (if (call (ident lexeme_eq) (string "struct"))
        (block
          (return (ident TOKEN_STRUCT))))
      (if (call (ident lexeme_eq) (string "macro"))
        (block
          (return (ident TOKEN_MACRO))))
      (if (call (ident lexeme_eq) (string "reader"))
        (block
          (return (ident TOKEN_READER))))
      (if (call (ident lexeme_eq) (string "import"))
        (block
          (return (ident TOKEN_IMPORT))))
      (if (call (ident lexeme_eq) (string "include"))
        (block
          (return (ident TOKEN_INCLUDE))))
      (if (call (ident lexeme_eq) (string "require"))
        (block
          (return (ident TOKEN_REQUIRE))))
      (if (call (ident lexeme_eq) (string "if"))
        (block
          (return (ident TOKEN_IF))))
      (if (call (ident lexeme_eq) (string "else"))
        (block
          (return (ident TOKEN_ELSE))))
      (if (call (ident lexeme_eq) (string "while"))
        (block
          (return (ident TOKEN_WHILE))))
      (if (call (ident lexeme_eq) (string "return"))
        (block
          (return (ident TOKEN_RETURN))))
      (if (call (ident lexeme_eq) (string "break"))
        (block
          (return (ident TOKEN_BREAK))))
      (if (call (ident lexeme_eq) (string "continue"))
        (block
          (return (ident TOKEN_CONTINUE))))
      (if (call (ident lexeme_eq) (string "let"))
        (block
          (return (ident TOKEN_LET))))
      (if (call (ident lexeme_eq) (string "in"))
        (block
          (return (ident TOKEN_IN))))
      (if (call (ident lexeme_eq) (string "fn"))
        (block
          (return (ident TOKEN_FN))))
      (if (call (ident lexeme_eq) (string "enum"))
        (block
          (return (ident TOKEN_ENUM))))
      (if (call (ident lexeme_eq) (string "match"))
        (block
          (return (ident TOKEN_MATCH))))
      (if (call (ident lexeme_eq) (string "effect"))
        (block
          (return (ident TOKEN_EFFECT))))
      (if (call (ident lexeme_eq) (string "perform"))
        (block
          (return (ident TOKEN_PERFORM))))
      (if (call (ident lexeme_eq) (string "handle"))
        (block
          (return (ident TOKEN_HANDLE))))
      (if (call (ident lexeme_eq) (string "with"))
        (block
          (return (ident TOKEN_WITH))))
      (if (call (ident lexeme_eq) (string "resume"))
        (block
          (return (ident TOKEN_RESUME))))
      (if (call (ident lexeme_eq) (string "closure"))
        (block
          (return (ident TOKEN_CLOSURE))))
      (if (call (ident lexeme_eq) (string "extern"))
        (block
          (return (ident TOKEN_EXTERN))))
      (if (call (ident lexeme_eq) (string "pub"))
        (block
          (return (ident TOKEN_PUB))))
      (if (call (ident lexeme_eq) (string "true"))
        (block
          (return (ident TOKEN_TRUE))))
      (if (call (ident lexeme_eq) (string "false"))
        (block
          (return (ident TOKEN_FALSE))))
      (if (call (ident lexeme_eq) (string "nil"))
        (block
          (return (ident TOKEN_NIL))))
      (if (call (ident lexeme_eq) (string "i8"))
        (block
          (return (ident TOKEN_I8))))
      (if (call (ident lexeme_eq) (string "i16"))
        (block
          (return (ident TOKEN_I16))))
      (if (call (ident lexeme_eq) (string "i32"))
        (block
          (return (ident TOKEN_I32))))
      (if (call (ident lexeme_eq) (string "i64"))
        (block
          (return (ident TOKEN_I64))))
      (if (call (ident lexeme_eq) (string "u8"))
        (block
          (return (ident TOKEN_U8))))
      (if (call (ident lexeme_eq) (string "u16"))
        (block
          (return (ident TOKEN_U16))))
      (if (call (ident lexeme_eq) (string "u32"))
        (block
          (return (ident TOKEN_U32))))
      (if (call (ident lexeme_eq) (string "u64"))
        (block
          (return (ident TOKEN_U64))))
      (if (call (ident lexeme_eq) (string "bool"))
        (block
          (return (ident TOKEN_BOOL))))
      (if (call (ident lexeme_eq) (string "void"))
        (block
          (return (ident TOKEN_VOID))))
      (if (call (ident lexeme_eq) (string "syscall"))
        (block
          (return (ident TOKEN_IDENT))))
      (return (ident TOKEN_IDENT))))
  (func scan_identifier () (type_ptr (type_base u8))
    (block
      (while (call (ident is_alphanumeric) (call (ident lex_peek)))
        (block
          (expr_stmt (call (ident lex_advance)))))
      (return (call (ident make_token) (call (ident check_keyword))))))
  (func scan_number () (type_ptr (type_base u8))
    (block
      (while (call (ident is_digit) (call (ident lex_peek)))
        (block
          (expr_stmt (call (ident lex_advance)))))
      (return (call (ident make_token) (ident TOKEN_NUMBER)))))
  (func scan_string () (type_ptr (type_base u8))
    (block
      (while (binop && (unop ! (call (ident lex_is_at_end))) (binop != (call (ident lex_peek)) (number 34)))
        (block
          (if (binop == (call (ident lex_peek)) (number 10))
            (block
              (assign (ident lex_line) (binop + (ident lex_line) (number 1)))
              (assign (ident lex_col) (number 0))))
          (if (binop && (binop == (call (ident lex_peek)) (number 92)) (binop != (call (ident lex_peek_next)) (number 0)))
            (block
              (expr_stmt (call (ident lex_advance)))))
          (expr_stmt (call (ident lex_advance)))))
      (if (call (ident lex_is_at_end))
        (block
          (return (call (ident error_token) (string "unterminated string")))))
      (expr_stmt (call (ident lex_advance)))
      (return (call (ident make_token) (ident TOKEN_STRING)))))
  (func scan_char () (type_ptr (type_base u8))
    (block
      (if (call (ident lex_is_at_end))
        (block
          (return (call (ident error_token) (string "unterminated character literal")))))
      (var c (type_base u8) (call (ident lex_advance)))
      (var value (type_base i64) (number 0))
      (if (binop == (ident c) (number 92))
        (block
          (if (call (ident lex_is_at_end))
            (block
              (return (call (ident error_token) (string "unterminated escape in character literal")))))
          (var esc (type_base u8) (call (ident lex_advance)))
          (if (binop == (ident esc) (number 110))
            (block
              (assign (ident value) (number 10)))
            (if (binop == (ident esc) (number 116))
              (block
                (assign (ident value) (number 9)))
              (if (binop == (ident esc) (number 114))
                (block
                  (assign (ident value) (number 13)))
                (if (binop == (ident esc) (number 48))
                  (block
                    (assign (ident value) (number 0)))
                  (if (binop == (ident esc) (number 92))
                    (block
                      (assign (ident value) (number 92)))
                    (if (binop == (ident esc) (number 39))
                      (block
                        (assign (ident value) (number 39)))
                      (if (binop == (ident esc) (number 34))
                        (block
                          (assign (ident value) (number 34)))
                        (block
                          (return (call (ident error_token) (string "unknown escape sequence"))))))))))))
        (block
          (assign (ident value) (ident c))))
      (if (binop || (call (ident lex_is_at_end)) (binop != (call (ident lex_peek)) (number 39)))
        (block
          (return (call (ident error_token) (string "unterminated character literal")))))
      (expr_stmt (call (ident lex_advance)))
      (var buf (type_ptr (type_base u8)) (call (ident alloc) (number 16)))
      (var len (type_base i64) (call (ident itoa) (ident value) (ident buf)))
      (var tok (type_ptr (type_base u8)) (call (ident tok_alloc)))
      (expr_stmt (call (ident tok_set_type) (ident tok) (ident TOKEN_NUMBER)))
      (expr_stmt (call (ident tok_set_lexeme) (ident tok) (ident buf)))
      (expr_stmt (call (ident tok_set_lexeme_len) (ident tok) (ident len)))
      (expr_stmt (call (ident tok_set_line) (ident tok) (ident lex_line)))
      (expr_stmt (call (ident tok_set_col) (ident tok) (ident lex_start_col)))
      (return (ident tok))))
  (func scan_reader_macro () (type_ptr (type_base u8))
    (block
      (var name_start (type_base i64) (ident lex_current))
      (if (unop ! (call (ident is_alpha) (call (ident lex_peek))))
        (block
          (return (call (ident error_token) (string "expected identifier after '#'")))))
      (while (call (ident is_alphanumeric) (call (ident lex_peek)))
        (block
          (expr_stmt (call (ident lex_advance)))))
      (var name_end (type_base i64) (ident lex_current))
      (var name_len (type_base i64) (binop - (ident name_end) (ident name_start)))
      (if (binop != (call (ident lex_peek)) (number 123))
        (block
          (return (call (ident error_token) (string "expected '{' after reader macro name")))))
      (expr_stmt (call (ident lex_advance)))
      (var content_start (type_base i64) (ident lex_current))
      (var brace_depth (type_base i64) (number 1))
      (while (binop && (unop ! (call (ident lex_is_at_end))) (binop > (ident brace_depth) (number 0)))
        (block
          (var c (type_base u8) (call (ident lex_peek)))
          (if (binop == (ident c) (number 123))
            (block
              (assign (ident brace_depth) (binop + (ident brace_depth) (number 1)))
              (expr_stmt (call (ident lex_advance))))
            (if (binop == (ident c) (number 125))
              (block
                (assign (ident brace_depth) (binop - (ident brace_depth) (number 1)))
                (if (binop > (ident brace_depth) (number 0))
                  (block
                    (expr_stmt (call (ident lex_advance))))))
              (if (binop == (ident c) (number 34))
                (block
                  (expr_stmt (call (ident lex_advance)))
                  (while (binop && (unop ! (call (ident lex_is_at_end))) (binop != (call (ident lex_peek)) (number 34)))
                    (block
                      (if (binop && (binop == (call (ident lex_peek)) (number 92)) (binop != (call (ident lex_peek_next)) (number 0)))
                        (block
                          (expr_stmt (call (ident lex_advance)))))
                      (if (binop == (call (ident lex_peek)) (number 10))
                        (block
                          (assign (ident lex_line) (binop + (ident lex_line) (number 1)))
                          (assign (ident lex_col) (number 0))))
                      (expr_stmt (call (ident lex_advance)))))
                  (if (unop ! (call (ident lex_is_at_end)))
                    (block
                      (expr_stmt (call (ident lex_advance))))))
                (if (binop == (ident c) (number 10))
                  (block
                    (assign (ident lex_line) (binop + (ident lex_line) (number 1)))
                    (assign (ident lex_col) (number 0))
                    (expr_stmt (call (ident lex_advance))))
                  (block
                    (expr_stmt (call (ident lex_advance))))))))))
      (if (binop != (ident brace_depth) (number 0))
        (block
          (return (call (ident error_token) (string "unterminated reader macro content")))))
      (var content_end (type_base i64) (ident lex_current))
      (expr_stmt (call (ident lex_advance)))
      (var tok (type_ptr (type_base u8)) (call (ident tok_alloc)))
      (expr_stmt (call (ident tok_set_type) (ident tok) (ident TOKEN_READER_MACRO)))
      (expr_stmt (call (ident tok_set_lexeme) (ident tok) (binop + (ident lex_source) (ident name_start))))
      (expr_stmt (call (ident tok_set_lexeme_len) (ident tok) (ident name_len)))
      (expr_stmt (call (ident tok_set_line) (ident tok) (ident lex_line)))
      (expr_stmt (call (ident tok_set_col) (ident tok) (ident lex_start_col)))
      (expr_stmt (call (ident tok_set_content) (ident tok) (binop + (ident lex_source) (ident content_start))))
      (expr_stmt (call (ident tok_set_content_len) (ident tok) (binop - (ident content_end) (ident content_start))))
      (return (ident tok))))
  (func scan_token () (type_ptr (type_base u8))
    (block
      (expr_stmt (call (ident skip_whitespace)))
      (assign (ident lex_start) (ident lex_current))
      (assign (ident lex_start_col) (ident lex_col))
      (if (call (ident lex_is_at_end))
        (block
          (return (call (ident make_token) (ident TOKEN_EOF)))))
      (var c (type_base u8) (call (ident lex_advance)))
      (if (call (ident is_alpha) (ident c))
        (block
          (return (call (ident scan_identifier)))))
      (if (call (ident is_digit) (ident c))
        (block
          (return (call (ident scan_number)))))
      (if (binop == (ident c) (number 40))
        (block
          (return (call (ident make_token) (ident TOKEN_LPAREN)))))
      (if (binop == (ident c) (number 41))
        (block
          (return (call (ident make_token) (ident TOKEN_RPAREN)))))
      (if (binop == (ident c) (number 123))
        (block
          (return (call (ident make_token) (ident TOKEN_LBRACE)))))
      (if (binop == (ident c) (number 125))
        (block
          (return (call (ident make_token) (ident TOKEN_RBRACE)))))
      (if (binop == (ident c) (number 91))
        (block
          (return (call (ident make_token) (ident TOKEN_LBRACKET)))))
      (if (binop == (ident c) (number 93))
        (block
          (return (call (ident make_token) (ident TOKEN_RBRACKET)))))
      (if (binop == (ident c) (number 44))
        (block
          (return (call (ident make_token) (ident TOKEN_COMMA)))))
      (if (binop == (ident c) (number 59))
        (block
          (return (call (ident make_token) (ident TOKEN_SEMICOLON)))))
      (if (binop == (ident c) (number 46))
        (block
          (return (call (ident make_token) (ident TOKEN_DOT)))))
      (if (binop == (ident c) (number 43))
        (block
          (if (call (ident lex_match) (number 61))
            (block
              (return (call (ident make_token) (ident TOKEN_PLUSEQ)))))
          (return (call (ident make_token) (ident TOKEN_PLUS)))))
      (if (binop == (ident c) (number 45))
        (block
          (if (call (ident lex_match) (number 61))
            (block
              (return (call (ident make_token) (ident TOKEN_MINUSEQ)))))
          (return (call (ident make_token) (ident TOKEN_MINUS)))))
      (if (binop == (ident c) (number 42))
        (block
          (if (call (ident lex_match) (number 61))
            (block
              (return (call (ident make_token) (ident TOKEN_STAREQ)))))
          (return (call (ident make_token) (ident TOKEN_STAR)))))
      (if (binop == (ident c) (number 47))
        (block
          (if (call (ident lex_match) (number 61))
            (block
              (return (call (ident make_token) (ident TOKEN_SLASHEQ)))))
          (return (call (ident make_token) (ident TOKEN_SLASH)))))
      (if (binop == (ident c) (number 37))
        (block
          (if (call (ident lex_match) (number 61))
            (block
              (return (call (ident make_token) (ident TOKEN_PERCENTEQ)))))
          (return (call (ident make_token) (ident TOKEN_PERCENT)))))
      (if (binop == (ident c) (number 38))
        (block
          (if (call (ident lex_match) (number 38))
            (block
              (return (call (ident make_token) (ident TOKEN_AMPAMP)))))
          (return (call (ident make_token) (ident TOKEN_AMP)))))
      (if (binop == (ident c) (number 124))
        (block
          (if (call (ident lex_match) (number 124))
            (block
              (return (call (ident make_token) (ident TOKEN_PIPEPIPE)))))
          (return (call (ident make_token) (ident TOKEN_PIPE)))))
      (if (binop == (ident c) (number 94))
        (block
          (return (call (ident make_token) (ident TOKEN_CARET)))))
      (if (binop == (ident c) (number 33))
        (block
          (if (call (ident lex_match) (number 61))
            (block
              (return (call (ident make_token) (ident TOKEN_BANGEQ)))))
          (return (call (ident make_token) (ident TOKEN_BANG)))))
      (if (binop == (ident c) (number 61))
        (block
          (if (call (ident lex_match) (number 62))
            (block
              (return (call (ident make_token) (ident TOKEN_ARROW)))))
          (if (call (ident lex_match) (number 61))
            (block
              (return (call (ident make_token) (ident TOKEN_EQEQ)))))
          (return (call (ident make_token) (ident TOKEN_EQ)))))
      (if (binop == (ident c) (number 60))
        (block
          (if (call (ident lex_match) (number 60))
            (block
              (return (call (ident make_token) (ident TOKEN_LTLT)))))
          (if (call (ident lex_match) (number 61))
            (block
              (return (call (ident make_token) (ident TOKEN_LTEQ)))))
          (return (call (ident make_token) (ident TOKEN_LT)))))
      (if (binop == (ident c) (number 62))
        (block
          (if (call (ident lex_match) (number 62))
            (block
              (return (call (ident make_token) (ident TOKEN_GTGT)))))
          (if (call (ident lex_match) (number 61))
            (block
              (return (call (ident make_token) (ident TOKEN_GTEQ)))))
          (return (call (ident make_token) (ident TOKEN_GT)))))
      (if (binop == (ident c) (number 58))
        (block
          (if (call (ident lex_match) (number 61))
            (block
              (return (call (ident make_token) (ident TOKEN_COLONEQ)))))
          (return (call (ident make_token) (ident TOKEN_COLON)))))
      (if (binop == (ident c) (number 36))
        (block
          (if (call (ident lex_match) (number 123))
            (block
              (return (call (ident make_token) (ident TOKEN_DOLLAR_LBRACE)))))
          (if (call (ident lex_match) (number 64))
            (block
              (return (call (ident make_token) (ident TOKEN_DOLLAR_AT)))))
          (return (call (ident make_token) (ident TOKEN_DOLLAR)))))
      (if (binop == (ident c) (number 35))
        (block
          (return (call (ident scan_reader_macro)))))
      (if (binop == (ident c) (number 34))
        (block
          (return (call (ident scan_string)))))
      (if (binop == (ident c) (number 39))
        (block
          (return (call (ident scan_char)))))
      (return (call (ident error_token) (string "unexpected character")))))
  (func print_token_type ((param t (type_base i64))) (type_base void)
    (block
      (if (binop == (ident t) (ident TOKEN_EOF))
        (block
          (expr_stmt (call (ident print) (string "EOF")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_ERROR))
        (block
          (expr_stmt (call (ident print) (string "ERROR")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_IDENT))
        (block
          (expr_stmt (call (ident print) (string "IDENT")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_NUMBER))
        (block
          (expr_stmt (call (ident print) (string "NUMBER")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_STRING))
        (block
          (expr_stmt (call (ident print) (string "STRING")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_FUNC))
        (block
          (expr_stmt (call (ident print) (string "func")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_VAR))
        (block
          (expr_stmt (call (ident print) (string "var")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_STRUCT))
        (block
          (expr_stmt (call (ident print) (string "struct")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_IF))
        (block
          (expr_stmt (call (ident print) (string "if")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_ELSE))
        (block
          (expr_stmt (call (ident print) (string "else")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_WHILE))
        (block
          (expr_stmt (call (ident print) (string "while")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_RETURN))
        (block
          (expr_stmt (call (ident print) (string "return")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_TRUE))
        (block
          (expr_stmt (call (ident print) (string "true")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_FALSE))
        (block
          (expr_stmt (call (ident print) (string "false")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_NIL))
        (block
          (expr_stmt (call (ident print) (string "nil")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_I8))
        (block
          (expr_stmt (call (ident print) (string "i8")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_I16))
        (block
          (expr_stmt (call (ident print) (string "i16")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_I32))
        (block
          (expr_stmt (call (ident print) (string "i32")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_I64))
        (block
          (expr_stmt (call (ident print) (string "i64")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_U8))
        (block
          (expr_stmt (call (ident print) (string "u8")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_U16))
        (block
          (expr_stmt (call (ident print) (string "u16")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_U32))
        (block
          (expr_stmt (call (ident print) (string "u32")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_U64))
        (block
          (expr_stmt (call (ident print) (string "u64")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_BOOL))
        (block
          (expr_stmt (call (ident print) (string "bool")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_VOID))
        (block
          (expr_stmt (call (ident print) (string "void")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_PLUS))
        (block
          (expr_stmt (call (ident print) (string "+")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_MINUS))
        (block
          (expr_stmt (call (ident print) (string "-")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_STAR))
        (block
          (expr_stmt (call (ident print) (string "*")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_SLASH))
        (block
          (expr_stmt (call (ident print) (string "/")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_PERCENT))
        (block
          (expr_stmt (call (ident print) (string "%")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_AMP))
        (block
          (expr_stmt (call (ident print) (string "&")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_BANG))
        (block
          (expr_stmt (call (ident print) (string "!")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_EQ))
        (block
          (expr_stmt (call (ident print) (string "=")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_EQEQ))
        (block
          (expr_stmt (call (ident print) (string "==")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_BANGEQ))
        (block
          (expr_stmt (call (ident print) (string "!=")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_LT))
        (block
          (expr_stmt (call (ident print) (string "<")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_GT))
        (block
          (expr_stmt (call (ident print) (string ">")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_LTEQ))
        (block
          (expr_stmt (call (ident print) (string "<=")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_GTEQ))
        (block
          (expr_stmt (call (ident print) (string ">=")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_AMPAMP))
        (block
          (expr_stmt (call (ident print) (string "&&")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_PIPEPIPE))
        (block
          (expr_stmt (call (ident print) (string "||")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_LPAREN))
        (block
          (expr_stmt (call (ident print) (string "(")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_RPAREN))
        (block
          (expr_stmt (call (ident print) (string ")")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_LBRACE))
        (block
          (expr_stmt (call (ident print) (string "{")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_RBRACE))
        (block
          (expr_stmt (call (ident print) (string "}")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_LBRACKET))
        (block
          (expr_stmt (call (ident print) (string "[")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_RBRACKET))
        (block
          (expr_stmt (call (ident print) (string "]")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_COMMA))
        (block
          (expr_stmt (call (ident print) (string ",")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_SEMICOLON))
        (block
          (expr_stmt (call (ident print) (string ";")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_DOT))
        (block
          (expr_stmt (call (ident print) (string ".")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_COLON))
        (block
          (expr_stmt (call (ident print) (string ":")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_COLONEQ))
        (block
          (expr_stmt (call (ident print) (string ":=")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_MACRO))
        (block
          (expr_stmt (call (ident print) (string "macro")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_DOLLAR_LBRACE))
        (block
          (expr_stmt (call (ident print) (string "${")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_DOLLAR))
        (block
          (expr_stmt (call (ident print) (string "$")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_DOLLAR_AT))
        (block
          (expr_stmt (call (ident print) (string "$@")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_IMPORT))
        (block
          (expr_stmt (call (ident print) (string "import")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_READER))
        (block
          (expr_stmt (call (ident print) (string "reader")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_READER_MACRO))
        (block
          (expr_stmt (call (ident print) (string "READER_MACRO")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_INCLUDE))
        (block
          (expr_stmt (call (ident print) (string "include")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_REQUIRE))
        (block
          (expr_stmt (call (ident print) (string "require")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_PIPE))
        (block
          (expr_stmt (call (ident print) (string "|")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_CARET))
        (block
          (expr_stmt (call (ident print) (string "^")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_LTLT))
        (block
          (expr_stmt (call (ident print) (string "<<")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_GTGT))
        (block
          (expr_stmt (call (ident print) (string ">>")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_PLUSEQ))
        (block
          (expr_stmt (call (ident print) (string "+=")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_MINUSEQ))
        (block
          (expr_stmt (call (ident print) (string "-=")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_STAREQ))
        (block
          (expr_stmt (call (ident print) (string "*=")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_SLASHEQ))
        (block
          (expr_stmt (call (ident print) (string "/=")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_PERCENTEQ))
        (block
          (expr_stmt (call (ident print) (string "%=")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_BREAK))
        (block
          (expr_stmt (call (ident print) (string "break")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_CONTINUE))
        (block
          (expr_stmt (call (ident print) (string "continue")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_LET))
        (block
          (expr_stmt (call (ident print) (string "let")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_IN))
        (block
          (expr_stmt (call (ident print) (string "in")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_FN))
        (block
          (expr_stmt (call (ident print) (string "fn")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_ENUM))
        (block
          (expr_stmt (call (ident print) (string "enum")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_MATCH))
        (block
          (expr_stmt (call (ident print) (string "match")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_ARROW))
        (block
          (expr_stmt (call (ident print) (string "=>")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_EFFECT))
        (block
          (expr_stmt (call (ident print) (string "effect")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_PERFORM))
        (block
          (expr_stmt (call (ident print) (string "perform")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_HANDLE))
        (block
          (expr_stmt (call (ident print) (string "handle")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_WITH))
        (block
          (expr_stmt (call (ident print) (string "with")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_RESUME))
        (block
          (expr_stmt (call (ident print) (string "resume")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_CLOSURE))
        (block
          (expr_stmt (call (ident print) (string "closure")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_EXTERN))
        (block
          (expr_stmt (call (ident print) (string "extern")))
          (return)))
      (if (binop == (ident t) (ident TOKEN_PUB))
        (block
          (expr_stmt (call (ident print) (string "pub")))
          (return)))
      (expr_stmt (call (ident print) (string "UNKNOWN")))))
  (func print_n ((param s (type_ptr (type_base u8))) (param n (type_base i64))) (type_base void)
    (block
      (expr_stmt (call (ident file_write) (number 1) (ident s) (ident n)))))
  (func print_token ((param tok (type_ptr (type_base u8)))) (type_base void)
    (block
      (expr_stmt (call (ident print) (string "[")))
      (expr_stmt (call (ident print_int) (call (ident tok_line) (ident tok))))
      (expr_stmt (call (ident print) (string ":")))
      (expr_stmt (call (ident print_int) (call (ident tok_col) (ident tok))))
      (expr_stmt (call (ident print) (string "] ")))
      (expr_stmt (call (ident print_token_type) (call (ident tok_type) (ident tok))))
      (expr_stmt (call (ident print) (string " '")))
      (expr_stmt (call (ident print_n) (call (ident tok_lexeme) (ident tok)) (call (ident tok_lexeme_len) (ident tok))))
      (expr_stmt (call (ident println) (string "'")))))
  (var NODE_FUNC_DECL (type_base i64) (number 1))
  (var NODE_VAR_DECL (type_base i64) (number 2))
  (var NODE_STRUCT_DECL (type_base i64) (number 3))
  (var NODE_BLOCK_STMT (type_base i64) (number 4))
  (var NODE_IF_STMT (type_base i64) (number 5))
  (var NODE_WHILE_STMT (type_base i64) (number 6))
  (var NODE_RETURN_STMT (type_base i64) (number 7))
  (var NODE_EXPR_STMT (type_base i64) (number 8))
  (var NODE_BINARY_EXPR (type_base i64) (number 9))
  (var NODE_UNARY_EXPR (type_base i64) (number 10))
  (var NODE_CALL_EXPR (type_base i64) (number 11))
  (var NODE_INDEX_EXPR (type_base i64) (number 12))
  (var NODE_FIELD_EXPR (type_base i64) (number 13))
  (var NODE_IDENT_EXPR (type_base i64) (number 14))
  (var NODE_NUMBER_EXPR (type_base i64) (number 15))
  (var NODE_STRING_EXPR (type_base i64) (number 16))
  (var NODE_BOOL_EXPR (type_base i64) (number 17))
  (var NODE_NIL_EXPR (type_base i64) (number 18))
  (var NODE_GROUP_EXPR (type_base i64) (number 19))
  (var NODE_QUOTE_EXPR (type_base i64) (number 20))
  (var NODE_UNQUOTE_EXPR (type_base i64) (number 21))
  (var NODE_MACRO_DECL (type_base i64) (number 22))
  (var NODE_UNQUOTE_STRING_EXPR (type_base i64) (number 23))
  (var NODE_IMPORT (type_base i64) (number 24))
  (var NODE_READER_DECL (type_base i64) (number 25))
  (var NODE_READER_EXPR (type_base i64) (number 26))
  (var NODE_INCLUDE_DECL (type_base i64) (number 27))
  (var NODE_BREAK_STMT (type_base i64) (number 28))
  (var NODE_CONTINUE_STMT (type_base i64) (number 29))
  (var NODE_LET_EXPR (type_base i64) (number 30))
  (var NODE_ASSIGN_STMT (type_base i64) (number 31))
  (var NODE_LAMBDA_EXPR (type_base i64) (number 32))
  (var NODE_ENUM_DECL (type_base i64) (number 33))
  (var NODE_MATCH_EXPR (type_base i64) (number 34))
  (var NODE_PATTERN_VARIANT (type_base i64) (number 35))
  (var NODE_PATTERN_WILDCARD (type_base i64) (number 36))
  (var NODE_EFFECT_DECL (type_base i64) (number 37))
  (var NODE_PERFORM_EXPR (type_base i64) (number 38))
  (var NODE_HANDLE_EXPR (type_base i64) (number 39))
  (var NODE_RESUME_EXPR (type_base i64) (number 40))
  (var NODE_BLOCK_EXPR (type_base i64) (number 41))
  (var NODE_ARRAY_LITERAL (type_base i64) (number 42))
  (var NODE_REQUIRE_DECL (type_base i64) (number 43))
  (var NODE_MODULES_DECL (type_base i64) (number 44))
  (var TYPE_BASE (type_base i64) (number 1))
  (var TYPE_PTR (type_base i64) (number 2))
  (var TYPE_ARRAY (type_base i64) (number 3))
  (var TYPE_FUNC (type_base i64) (number 4))
  (var TYPE_CLOSURE (type_base i64) (number 5))
  (func buf_eq_str ((param buf (type_ptr (type_base u8))) (param len (type_base i64)) (param str (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var i (type_base i64) (number 0))
      (while (binop < (ident i) (ident len))
        (block
          (var c (type_base u8) (unop * (binop + (ident str) (ident i))))
          (if (binop == (ident c) (number 0))
            (block
              (return (number 0))))
          (if (binop != (unop * (binop + (ident buf) (ident i))) (ident c))
            (block
              (return (number 0))))
          (assign (ident i) (binop + (ident i) (number 1)))))
      (if (binop != (unop * (binop + (ident str) (ident i))) (number 0))
        (block
          (return (number 0))))
      (return (number 1))))
  (func parse_number_value ((param tok (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var buf (type_ptr (type_base u8)) (call (ident tok_lexeme) (ident tok)))
      (var len (type_base i64) (call (ident tok_lexeme_len) (ident tok)))
      (var result (type_base i64) (number 0))
      (var i (type_base i64) (number 0))
      (while (binop < (ident i) (ident len))
        (block
          (var c (type_base u8) (unop * (binop + (ident buf) (ident i))))
          (if (binop && (binop >= (ident c) (number 48)) (binop <= (ident c) (number 57)))
            (block
              (assign (ident result) (binop + (binop * (ident result) (number 10)) (binop - (ident c) (number 48))))))
          (assign (ident i) (binop + (ident i) (number 1)))))
      (return (ident result))))
  (func node_kind ((param node (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var p (type_ptr (type_base i64)) (ident node))
      (return (unop * (ident p)))))
  (func node_set_kind ((param node (type_ptr (type_base u8))) (param k (type_base i64))) (type_base void)
    (block
      (var p (type_ptr (type_base i64)) (ident node))
      (assign (unop * (ident p)) (ident k))))
  (func func_decl_alloc () (type_ptr (type_base u8))
    (block
      (var node (type_ptr (type_base u8)) (call (ident alloc) (number 72)))
      (expr_stmt (call (ident node_set_kind) (ident node) (ident NODE_FUNC_DECL)))
      (return (ident node))))
  (func func_decl_name ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (return (unop * (ident p)))))
  (func func_decl_set_name ((param node (type_ptr (type_base u8))) (param ptr (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (assign (unop * (ident p)) (ident ptr))))
  (func func_decl_name_len ((param node (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 16)))
      (return (unop * (ident p)))))
  (func func_decl_set_name_len ((param node (type_ptr (type_base u8))) (param len (type_base i64))) (type_base void)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 16)))
      (assign (unop * (ident p)) (ident len))))
  (func func_decl_params ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 24)))
      (return (unop * (ident p)))))
  (func func_decl_set_params ((param node (type_ptr (type_base u8))) (param params (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 24)))
      (assign (unop * (ident p)) (ident params))))
  (func func_decl_param_count ((param node (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 32)))
      (return (unop * (ident p)))))
  (func func_decl_set_param_count ((param node (type_ptr (type_base u8))) (param count (type_base i64))) (type_base void)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 32)))
      (assign (unop * (ident p)) (ident count))))
  (func func_decl_ret_type ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 40)))
      (return (unop * (ident p)))))
  (func func_decl_set_ret_type ((param node (type_ptr (type_base u8))) (param t (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 40)))
      (assign (unop * (ident p)) (ident t))))
  (func func_decl_body ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 48)))
      (return (unop * (ident p)))))
  (func func_decl_set_body ((param node (type_ptr (type_base u8))) (param body (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 48)))
      (assign (unop * (ident p)) (ident body))))
  (func func_decl_is_extern ((param node (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 56)))
      (return (unop * (ident p)))))
  (func func_decl_set_is_extern ((param node (type_ptr (type_base u8))) (param is_extern (type_base i64))) (type_base void)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 56)))
      (assign (unop * (ident p)) (ident is_extern))))
  (func func_decl_is_pub ((param node (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 64)))
      (return (unop * (ident p)))))
  (func func_decl_set_is_pub ((param node (type_ptr (type_base u8))) (param is_pub (type_base i64))) (type_base void)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 64)))
      (assign (unop * (ident p)) (ident is_pub))))
  (func var_decl_alloc () (type_ptr (type_base u8))
    (block
      (var node (type_ptr (type_base u8)) (call (ident alloc) (number 56)))
      (expr_stmt (call (ident node_set_kind) (ident node) (ident NODE_VAR_DECL)))
      (return (ident node))))
  (func var_decl_name ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (return (unop * (ident p)))))
  (func var_decl_set_name ((param node (type_ptr (type_base u8))) (param ptr (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (assign (unop * (ident p)) (ident ptr))))
  (func var_decl_name_len ((param node (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 16)))
      (return (unop * (ident p)))))
  (func var_decl_set_name_len ((param node (type_ptr (type_base u8))) (param len (type_base i64))) (type_base void)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 16)))
      (assign (unop * (ident p)) (ident len))))
  (func var_decl_type ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 24)))
      (return (unop * (ident p)))))
  (func var_decl_set_type ((param node (type_ptr (type_base u8))) (param t (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 24)))
      (assign (unop * (ident p)) (ident t))))
  (func var_decl_init ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 32)))
      (return (unop * (ident p)))))
  (func var_decl_set_init ((param node (type_ptr (type_base u8))) (param init (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 32)))
      (assign (unop * (ident p)) (ident init))))
  (func var_decl_is_extern ((param node (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 40)))
      (return (unop * (ident p)))))
  (func var_decl_set_is_extern ((param node (type_ptr (type_base u8))) (param is_extern (type_base i64))) (type_base void)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 40)))
      (assign (unop * (ident p)) (ident is_extern))))
  (func var_decl_is_pub ((param node (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 48)))
      (return (unop * (ident p)))))
  (func var_decl_set_is_pub ((param node (type_ptr (type_base u8))) (param is_pub (type_base i64))) (type_base void)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 48)))
      (assign (unop * (ident p)) (ident is_pub))))
  (func struct_decl_alloc () (type_ptr (type_base u8))
    (block
      (var node (type_ptr (type_base u8)) (call (ident alloc) (number 48)))
      (expr_stmt (call (ident node_set_kind) (ident node) (ident NODE_STRUCT_DECL)))
      (return (ident node))))
  (func struct_decl_name ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (return (unop * (ident p)))))
  (func struct_decl_set_name ((param node (type_ptr (type_base u8))) (param ptr (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (assign (unop * (ident p)) (ident ptr))))
  (func struct_decl_name_len ((param node (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 16)))
      (return (unop * (ident p)))))
  (func struct_decl_set_name_len ((param node (type_ptr (type_base u8))) (param len (type_base i64))) (type_base void)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 16)))
      (assign (unop * (ident p)) (ident len))))
  (func struct_decl_fields ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 24)))
      (return (unop * (ident p)))))
  (func struct_decl_set_fields ((param node (type_ptr (type_base u8))) (param fields (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 24)))
      (assign (unop * (ident p)) (ident fields))))
  (func struct_decl_field_count ((param node (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 32)))
      (return (unop * (ident p)))))
  (func struct_decl_set_field_count ((param node (type_ptr (type_base u8))) (param count (type_base i64))) (type_base void)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 32)))
      (assign (unop * (ident p)) (ident count))))
  (func struct_decl_is_pub ((param node (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 40)))
      (return (unop * (ident p)))))
  (func struct_decl_set_is_pub ((param node (type_ptr (type_base u8))) (param is_pub (type_base i64))) (type_base void)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 40)))
      (assign (unop * (ident p)) (ident is_pub))))
  (func struct_field_name ((param field (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (ident field))
      (return (unop * (ident p)))))
  (func struct_field_set_name ((param field (type_ptr (type_base u8))) (param ptr (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (ident field))
      (assign (unop * (ident p)) (ident ptr))))
  (func struct_field_name_len ((param field (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident field) (number 8)))
      (return (unop * (ident p)))))
  (func struct_field_set_name_len ((param field (type_ptr (type_base u8))) (param len (type_base i64))) (type_base void)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident field) (number 8)))
      (assign (unop * (ident p)) (ident len))))
  (func struct_field_type ((param field (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident field) (number 16)))
      (return (unop * (ident p)))))
  (func struct_field_set_type ((param field (type_ptr (type_base u8))) (param t (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident field) (number 16)))
      (assign (unop * (ident p)) (ident t))))
  (func get_struct_field ((param fields (type_ptr (type_base u8))) (param index (type_base i64))) (type_ptr (type_base u8))
    (block
      (return (binop + (ident fields) (binop * (ident index) (number 24))))))
  (func enum_decl_alloc () (type_ptr (type_base u8))
    (block
      (var node (type_ptr (type_base u8)) (call (ident alloc) (number 48)))
      (expr_stmt (call (ident node_set_kind) (ident node) (ident NODE_ENUM_DECL)))
      (return (ident node))))
  (func enum_decl_name ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (return (unop * (ident p)))))
  (func enum_decl_set_name ((param node (type_ptr (type_base u8))) (param ptr (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (assign (unop * (ident p)) (ident ptr))))
  (func enum_decl_name_len ((param node (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 16)))
      (return (unop * (ident p)))))
  (func enum_decl_set_name_len ((param node (type_ptr (type_base u8))) (param len (type_base i64))) (type_base void)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 16)))
      (assign (unop * (ident p)) (ident len))))
  (func enum_decl_variants ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 24)))
      (return (unop * (ident p)))))
  (func enum_decl_set_variants ((param node (type_ptr (type_base u8))) (param variants (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 24)))
      (assign (unop * (ident p)) (ident variants))))
  (func enum_decl_variant_count ((param node (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 32)))
      (return (unop * (ident p)))))
  (func enum_decl_set_variant_count ((param node (type_ptr (type_base u8))) (param count (type_base i64))) (type_base void)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 32)))
      (assign (unop * (ident p)) (ident count))))
  (func enum_decl_is_pub ((param node (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 40)))
      (return (unop * (ident p)))))
  (func enum_decl_set_is_pub ((param node (type_ptr (type_base u8))) (param is_pub (type_base i64))) (type_base void)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 40)))
      (assign (unop * (ident p)) (ident is_pub))))
  (func enum_variant_name ((param v (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (ident v))
      (return (unop * (ident p)))))
  (func enum_variant_set_name ((param v (type_ptr (type_base u8))) (param ptr (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (ident v))
      (assign (unop * (ident p)) (ident ptr))))
  (func enum_variant_name_len ((param v (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident v) (number 8)))
      (return (unop * (ident p)))))
  (func enum_variant_set_name_len ((param v (type_ptr (type_base u8))) (param len (type_base i64))) (type_base void)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident v) (number 8)))
      (assign (unop * (ident p)) (ident len))))
  (func enum_variant_type ((param v (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident v) (number 16)))
      (return (unop * (ident p)))))
  (func enum_variant_set_type ((param v (type_ptr (type_base u8))) (param t (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident v) (number 16)))
      (assign (unop * (ident p)) (ident t))))
  (func enum_variant_tag ((param v (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident v) (number 24)))
      (return (unop * (ident p)))))
  (func enum_variant_set_tag ((param v (type_ptr (type_base u8))) (param tag (type_base i64))) (type_base void)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident v) (number 24)))
      (assign (unop * (ident p)) (ident tag))))
  (func get_enum_variant ((param variants (type_ptr (type_base u8))) (param index (type_base i64))) (type_ptr (type_base u8))
    (block
      (return (binop + (ident variants) (binop * (ident index) (number 32))))))
  (func match_expr_alloc () (type_ptr (type_base u8))
    (block
      (var node (type_ptr (type_base u8)) (call (ident alloc) (number 32)))
      (expr_stmt (call (ident node_set_kind) (ident node) (ident NODE_MATCH_EXPR)))
      (return (ident node))))
  (func match_expr_scrutinee ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (return (unop * (ident p)))))
  (func match_expr_set_scrutinee ((param node (type_ptr (type_base u8))) (param expr (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (assign (unop * (ident p)) (ident expr))))
  (func match_expr_arms ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 16)))
      (return (unop * (ident p)))))
  (func match_expr_set_arms ((param node (type_ptr (type_base u8))) (param arms (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 16)))
      (assign (unop * (ident p)) (ident arms))))
  (func match_expr_arm_count ((param node (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 24)))
      (return (unop * (ident p)))))
  (func match_expr_set_arm_count ((param node (type_ptr (type_base u8))) (param count (type_base i64))) (type_base void)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 24)))
      (assign (unop * (ident p)) (ident count))))
  (func get_match_arm ((param arms (type_ptr (type_base u8))) (param index (type_base i64))) (type_ptr (type_base u8))
    (block
      (return (binop + (ident arms) (binop * (ident index) (number 16))))))
  (func match_arm_pattern ((param arm (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (ident arm))
      (return (unop * (ident p)))))
  (func match_arm_set_pattern ((param arm (type_ptr (type_base u8))) (param pattern (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (ident arm))
      (assign (unop * (ident p)) (ident pattern))))
  (func match_arm_body ((param arm (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident arm) (number 8)))
      (return (unop * (ident p)))))
  (func match_arm_set_body ((param arm (type_ptr (type_base u8))) (param body (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident arm) (number 8)))
      (assign (unop * (ident p)) (ident body))))
  (func pattern_variant_alloc () (type_ptr (type_base u8))
    (block
      (var node (type_ptr (type_base u8)) (call (ident alloc) (number 56)))
      (expr_stmt (call (ident node_set_kind) (ident node) (ident NODE_PATTERN_VARIANT)))
      (return (ident node))))
  (func pattern_variant_enum_name ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (return (unop * (ident p)))))
  (func pattern_variant_set_enum_name ((param node (type_ptr (type_base u8))) (param name (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (assign (unop * (ident p)) (ident name))))
  (func pattern_variant_enum_len ((param node (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 16)))
      (return (unop * (ident p)))))
  (func pattern_variant_set_enum_len ((param node (type_ptr (type_base u8))) (param len (type_base i64))) (type_base void)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 16)))
      (assign (unop * (ident p)) (ident len))))
  (func pattern_variant_name ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 24)))
      (return (unop * (ident p)))))
  (func pattern_variant_set_name ((param node (type_ptr (type_base u8))) (param name (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 24)))
      (assign (unop * (ident p)) (ident name))))
  (func pattern_variant_name_len ((param node (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 32)))
      (return (unop * (ident p)))))
  (func pattern_variant_set_name_len ((param node (type_ptr (type_base u8))) (param len (type_base i64))) (type_base void)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 32)))
      (assign (unop * (ident p)) (ident len))))
  (func pattern_variant_binding ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 40)))
      (return (unop * (ident p)))))
  (func pattern_variant_set_binding ((param node (type_ptr (type_base u8))) (param name (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 40)))
      (assign (unop * (ident p)) (ident name))))
  (func pattern_variant_binding_len ((param node (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 48)))
      (return (unop * (ident p)))))
  (func pattern_variant_set_binding_len ((param node (type_ptr (type_base u8))) (param len (type_base i64))) (type_base void)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 48)))
      (assign (unop * (ident p)) (ident len))))
  (func pattern_wildcard_alloc () (type_ptr (type_base u8))
    (block
      (var node (type_ptr (type_base u8)) (call (ident alloc) (number 8)))
      (expr_stmt (call (ident node_set_kind) (ident node) (ident NODE_PATTERN_WILDCARD)))
      (return (ident node))))
  (func effect_decl_alloc () (type_ptr (type_base u8))
    (block
      (var node (type_ptr (type_base u8)) (call (ident alloc) (number 56)))
      (expr_stmt (call (ident node_set_kind) (ident node) (ident NODE_EFFECT_DECL)))
      (return (ident node))))
  (func effect_decl_name ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (return (unop * (ident p)))))
  (func effect_decl_set_name ((param node (type_ptr (type_base u8))) (param name (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (assign (unop * (ident p)) (ident name))))
  (func effect_decl_name_len ((param node (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 16)))
      (return (unop * (ident p)))))
  (func effect_decl_set_name_len ((param node (type_ptr (type_base u8))) (param len (type_base i64))) (type_base void)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 16)))
      (assign (unop * (ident p)) (ident len))))
  (func effect_decl_param_types ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 24)))
      (return (unop * (ident p)))))
  (func effect_decl_set_param_types ((param node (type_ptr (type_base u8))) (param params (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 24)))
      (assign (unop * (ident p)) (ident params))))
  (func effect_decl_param_type_count ((param node (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 32)))
      (return (unop * (ident p)))))
  (func effect_decl_set_param_type_count ((param node (type_ptr (type_base u8))) (param count (type_base i64))) (type_base void)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 32)))
      (assign (unop * (ident p)) (ident count))))
  (func effect_decl_return_type ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 40)))
      (return (unop * (ident p)))))
  (func effect_decl_set_return_type ((param node (type_ptr (type_base u8))) (param ret_type (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 40)))
      (assign (unop * (ident p)) (ident ret_type))))
  (func effect_decl_is_pub ((param node (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 48)))
      (return (unop * (ident p)))))
  (func effect_decl_set_is_pub ((param node (type_ptr (type_base u8))) (param is_pub (type_base i64))) (type_base void)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 48)))
      (assign (unop * (ident p)) (ident is_pub))))
  (func perform_expr_alloc () (type_ptr (type_base u8))
    (block
      (var node (type_ptr (type_base u8)) (call (ident alloc) (number 40)))
      (expr_stmt (call (ident node_set_kind) (ident node) (ident NODE_PERFORM_EXPR)))
      (return (ident node))))
  (func perform_expr_name ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (return (unop * (ident p)))))
  (func perform_expr_set_name ((param node (type_ptr (type_base u8))) (param name (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (assign (unop * (ident p)) (ident name))))
  (func perform_expr_name_len ((param node (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 16)))
      (return (unop * (ident p)))))
  (func perform_expr_set_name_len ((param node (type_ptr (type_base u8))) (param len (type_base i64))) (type_base void)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 16)))
      (assign (unop * (ident p)) (ident len))))
  (func perform_expr_args ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 24)))
      (return (unop * (ident p)))))
  (func perform_expr_set_args ((param node (type_ptr (type_base u8))) (param args (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 24)))
      (assign (unop * (ident p)) (ident args))))
  (func perform_expr_arg_count ((param node (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 32)))
      (return (unop * (ident p)))))
  (func perform_expr_set_arg_count ((param node (type_ptr (type_base u8))) (param count (type_base i64))) (type_base void)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 32)))
      (assign (unop * (ident p)) (ident count))))
  (func handle_expr_alloc () (type_ptr (type_base u8))
    (block
      (var node (type_ptr (type_base u8)) (call (ident alloc) (number 56)))
      (expr_stmt (call (ident node_set_kind) (ident node) (ident NODE_HANDLE_EXPR)))
      (return (ident node))))
  (func handle_expr_body ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (return (unop * (ident p)))))
  (func handle_expr_set_body ((param node (type_ptr (type_base u8))) (param body (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (assign (unop * (ident p)) (ident body))))
  (func handle_expr_cases ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 16)))
      (return (unop * (ident p)))))
  (func handle_expr_set_cases ((param node (type_ptr (type_base u8))) (param cases (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 16)))
      (assign (unop * (ident p)) (ident cases))))
  (func handle_expr_case_count ((param node (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 24)))
      (return (unop * (ident p)))))
  (func handle_expr_set_case_count ((param node (type_ptr (type_base u8))) (param count (type_base i64))) (type_base void)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 24)))
      (assign (unop * (ident p)) (ident count))))
  (func handle_expr_ret_bind ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 32)))
      (return (unop * (ident p)))))
  (func handle_expr_set_ret_bind ((param node (type_ptr (type_base u8))) (param bind (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 32)))
      (assign (unop * (ident p)) (ident bind))))
  (func handle_expr_ret_bind_len ((param node (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 40)))
      (return (unop * (ident p)))))
  (func handle_expr_set_ret_bind_len ((param node (type_ptr (type_base u8))) (param len (type_base i64))) (type_base void)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 40)))
      (assign (unop * (ident p)) (ident len))))
  (func handle_expr_ret_body ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 48)))
      (return (unop * (ident p)))))
  (func handle_expr_set_ret_body ((param node (type_ptr (type_base u8))) (param body (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 48)))
      (assign (unop * (ident p)) (ident body))))
  (func effect_case_name ((param entry (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (ident entry))
      (return (unop * (ident p)))))
  (func effect_case_name_len ((param entry (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident entry) (number 8)))
      (return (unop * (ident p)))))
  (func effect_case_binding ((param entry (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident entry) (number 16)))
      (return (unop * (ident p)))))
  (func effect_case_binding_len ((param entry (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident entry) (number 24)))
      (return (unop * (ident p)))))
  (func effect_case_k ((param entry (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident entry) (number 32)))
      (return (unop * (ident p)))))
  (func effect_case_k_len ((param entry (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident entry) (number 40)))
      (return (unop * (ident p)))))
  (func effect_case_body ((param entry (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident entry) (number 48)))
      (return (unop * (ident p)))))
  (func resume_expr_alloc () (type_ptr (type_base u8))
    (block
      (var node (type_ptr (type_base u8)) (call (ident alloc) (number 24)))
      (expr_stmt (call (ident node_set_kind) (ident node) (ident NODE_RESUME_EXPR)))
      (return (ident node))))
  (func resume_expr_k ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (return (unop * (ident p)))))
  (func resume_expr_set_k ((param node (type_ptr (type_base u8))) (param k (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (assign (unop * (ident p)) (ident k))))
  (func resume_expr_value ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 16)))
      (return (unop * (ident p)))))
  (func resume_expr_set_value ((param node (type_ptr (type_base u8))) (param value (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 16)))
      (assign (unop * (ident p)) (ident value))))
  (func block_stmt_alloc () (type_ptr (type_base u8))
    (block
      (var node (type_ptr (type_base u8)) (call (ident alloc) (number 24)))
      (expr_stmt (call (ident node_set_kind) (ident node) (ident NODE_BLOCK_STMT)))
      (return (ident node))))
  (func block_stmt_stmts ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (return (unop * (ident p)))))
  (func block_stmt_set_stmts ((param node (type_ptr (type_base u8))) (param stmts (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (assign (unop * (ident p)) (ident stmts))))
  (func block_stmt_count ((param node (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 16)))
      (return (unop * (ident p)))))
  (func block_stmt_set_count ((param node (type_ptr (type_base u8))) (param count (type_base i64))) (type_base void)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 16)))
      (assign (unop * (ident p)) (ident count))))
  (func block_expr_alloc () (type_ptr (type_base u8))
    (block
      (var node (type_ptr (type_base u8)) (call (ident alloc) (number 32)))
      (expr_stmt (call (ident node_set_kind) (ident node) (ident NODE_BLOCK_EXPR)))
      (return (ident node))))
  (func block_expr_stmts ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (return (unop * (ident p)))))
  (func block_expr_set_stmts ((param node (type_ptr (type_base u8))) (param stmts (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (assign (unop * (ident p)) (ident stmts))))
  (func block_expr_count ((param node (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 16)))
      (return (unop * (ident p)))))
  (func block_expr_set_count ((param node (type_ptr (type_base u8))) (param count (type_base i64))) (type_base void)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 16)))
      (assign (unop * (ident p)) (ident count))))
  (func block_expr_tail ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 24)))
      (return (unop * (ident p)))))
  (func block_expr_set_tail ((param node (type_ptr (type_base u8))) (param tail (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 24)))
      (assign (unop * (ident p)) (ident tail))))
  (func if_stmt_alloc () (type_ptr (type_base u8))
    (block
      (var node (type_ptr (type_base u8)) (call (ident alloc) (number 32)))
      (expr_stmt (call (ident node_set_kind) (ident node) (ident NODE_IF_STMT)))
      (return (ident node))))
  (func if_stmt_cond ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (return (unop * (ident p)))))
  (func if_stmt_set_cond ((param node (type_ptr (type_base u8))) (param cond (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (assign (unop * (ident p)) (ident cond))))
  (func if_stmt_then ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 16)))
      (return (unop * (ident p)))))
  (func if_stmt_set_then ((param node (type_ptr (type_base u8))) (param then (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 16)))
      (assign (unop * (ident p)) (ident then))))
  (func if_stmt_else ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 24)))
      (return (unop * (ident p)))))
  (func if_stmt_set_else ((param node (type_ptr (type_base u8))) (param els (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 24)))
      (assign (unop * (ident p)) (ident els))))
  (func while_stmt_alloc () (type_ptr (type_base u8))
    (block
      (var node (type_ptr (type_base u8)) (call (ident alloc) (number 40)))
      (expr_stmt (call (ident node_set_kind) (ident node) (ident NODE_WHILE_STMT)))
      (return (ident node))))
  (func while_stmt_cond ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (return (unop * (ident p)))))
  (func while_stmt_set_cond ((param node (type_ptr (type_base u8))) (param cond (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (assign (unop * (ident p)) (ident cond))))
  (func while_stmt_body ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 16)))
      (return (unop * (ident p)))))
  (func while_stmt_set_body ((param node (type_ptr (type_base u8))) (param body (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 16)))
      (assign (unop * (ident p)) (ident body))))
  (func while_stmt_label ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 24)))
      (return (unop * (ident p)))))
  (func while_stmt_set_label ((param node (type_ptr (type_base u8))) (param label (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 24)))
      (assign (unop * (ident p)) (ident label))))
  (func while_stmt_label_len ((param node (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 32)))
      (return (unop * (ident p)))))
  (func while_stmt_set_label_len ((param node (type_ptr (type_base u8))) (param len (type_base i64))) (type_base void)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 32)))
      (assign (unop * (ident p)) (ident len))))
  (func break_stmt_alloc () (type_ptr (type_base u8))
    (block
      (var node (type_ptr (type_base u8)) (call (ident alloc) (number 24)))
      (expr_stmt (call (ident node_set_kind) (ident node) (ident NODE_BREAK_STMT)))
      (return (ident node))))
  (func break_stmt_label ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (return (unop * (ident p)))))
  (func break_stmt_set_label ((param node (type_ptr (type_base u8))) (param label (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (assign (unop * (ident p)) (ident label))))
  (func break_stmt_label_len ((param node (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 16)))
      (return (unop * (ident p)))))
  (func break_stmt_set_label_len ((param node (type_ptr (type_base u8))) (param len (type_base i64))) (type_base void)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 16)))
      (assign (unop * (ident p)) (ident len))))
  (func continue_stmt_alloc () (type_ptr (type_base u8))
    (block
      (var node (type_ptr (type_base u8)) (call (ident alloc) (number 24)))
      (expr_stmt (call (ident node_set_kind) (ident node) (ident NODE_CONTINUE_STMT)))
      (return (ident node))))
  (func continue_stmt_label ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (return (unop * (ident p)))))
  (func continue_stmt_set_label ((param node (type_ptr (type_base u8))) (param label (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (assign (unop * (ident p)) (ident label))))
  (func continue_stmt_label_len ((param node (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 16)))
      (return (unop * (ident p)))))
  (func continue_stmt_set_label_len ((param node (type_ptr (type_base u8))) (param len (type_base i64))) (type_base void)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 16)))
      (assign (unop * (ident p)) (ident len))))
  (func return_stmt_alloc () (type_ptr (type_base u8))
    (block
      (var node (type_ptr (type_base u8)) (call (ident alloc) (number 16)))
      (expr_stmt (call (ident node_set_kind) (ident node) (ident NODE_RETURN_STMT)))
      (return (ident node))))
  (func return_stmt_value ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (return (unop * (ident p)))))
  (func return_stmt_set_value ((param node (type_ptr (type_base u8))) (param val (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (assign (unop * (ident p)) (ident val))))
  (func expr_stmt_alloc () (type_ptr (type_base u8))
    (block
      (var node (type_ptr (type_base u8)) (call (ident alloc) (number 16)))
      (expr_stmt (call (ident node_set_kind) (ident node) (ident NODE_EXPR_STMT)))
      (return (ident node))))
  (func expr_stmt_expr ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (return (unop * (ident p)))))
  (func expr_stmt_set_expr ((param node (type_ptr (type_base u8))) (param expr (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (assign (unop * (ident p)) (ident expr))))
  (func assign_stmt_alloc () (type_ptr (type_base u8))
    (block
      (var node (type_ptr (type_base u8)) (call (ident alloc) (number 24)))
      (expr_stmt (call (ident node_set_kind) (ident node) (ident NODE_ASSIGN_STMT)))
      (return (ident node))))
  (func assign_stmt_target ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (return (unop * (ident p)))))
  (func assign_stmt_set_target ((param node (type_ptr (type_base u8))) (param target (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (assign (unop * (ident p)) (ident target))))
  (func assign_stmt_value ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 16)))
      (return (unop * (ident p)))))
  (func assign_stmt_set_value ((param node (type_ptr (type_base u8))) (param value (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 16)))
      (assign (unop * (ident p)) (ident value))))
  (func binary_expr_alloc () (type_ptr (type_base u8))
    (block
      (var node (type_ptr (type_base u8)) (call (ident alloc) (number 32)))
      (expr_stmt (call (ident node_set_kind) (ident node) (ident NODE_BINARY_EXPR)))
      (return (ident node))))
  (func binary_expr_op ((param node (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 8)))
      (return (unop * (ident p)))))
  (func binary_expr_set_op ((param node (type_ptr (type_base u8))) (param op (type_base i64))) (type_base void)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 8)))
      (assign (unop * (ident p)) (ident op))))
  (func binary_expr_left ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 16)))
      (return (unop * (ident p)))))
  (func binary_expr_set_left ((param node (type_ptr (type_base u8))) (param left (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 16)))
      (assign (unop * (ident p)) (ident left))))
  (func binary_expr_right ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 24)))
      (return (unop * (ident p)))))
  (func binary_expr_set_right ((param node (type_ptr (type_base u8))) (param right (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 24)))
      (assign (unop * (ident p)) (ident right))))
  (func unary_expr_alloc () (type_ptr (type_base u8))
    (block
      (var node (type_ptr (type_base u8)) (call (ident alloc) (number 24)))
      (expr_stmt (call (ident node_set_kind) (ident node) (ident NODE_UNARY_EXPR)))
      (return (ident node))))
  (func unary_expr_op ((param node (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 8)))
      (return (unop * (ident p)))))
  (func unary_expr_set_op ((param node (type_ptr (type_base u8))) (param op (type_base i64))) (type_base void)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 8)))
      (assign (unop * (ident p)) (ident op))))
  (func unary_expr_expr ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 16)))
      (return (unop * (ident p)))))
  (func unary_expr_set_expr ((param node (type_ptr (type_base u8))) (param expr (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 16)))
      (assign (unop * (ident p)) (ident expr))))
  (func call_expr_alloc () (type_ptr (type_base u8))
    (block
      (var node (type_ptr (type_base u8)) (call (ident alloc) (number 32)))
      (expr_stmt (call (ident node_set_kind) (ident node) (ident NODE_CALL_EXPR)))
      (return (ident node))))
  (func call_expr_func ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (return (unop * (ident p)))))
  (func call_expr_set_func ((param node (type_ptr (type_base u8))) (param f (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (assign (unop * (ident p)) (ident f))))
  (func call_expr_args ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 16)))
      (return (unop * (ident p)))))
  (func call_expr_set_args ((param node (type_ptr (type_base u8))) (param args (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 16)))
      (assign (unop * (ident p)) (ident args))))
  (func call_expr_arg_count ((param node (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 24)))
      (return (unop * (ident p)))))
  (func call_expr_set_arg_count ((param node (type_ptr (type_base u8))) (param count (type_base i64))) (type_base void)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 24)))
      (assign (unop * (ident p)) (ident count))))
  (func ident_expr_alloc () (type_ptr (type_base u8))
    (block
      (var node (type_ptr (type_base u8)) (call (ident alloc) (number 24)))
      (expr_stmt (call (ident node_set_kind) (ident node) (ident NODE_IDENT_EXPR)))
      (return (ident node))))
  (func ident_expr_name ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (return (unop * (ident p)))))
  (func ident_expr_set_name ((param node (type_ptr (type_base u8))) (param ptr (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (assign (unop * (ident p)) (ident ptr))))
  (func ident_expr_name_len ((param node (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 16)))
      (return (unop * (ident p)))))
  (func ident_expr_set_name_len ((param node (type_ptr (type_base u8))) (param len (type_base i64))) (type_base void)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 16)))
      (assign (unop * (ident p)) (ident len))))
  (func field_expr_expr ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (return (unop * (ident p)))))
  (func field_expr_field ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 16)))
      (return (unop * (ident p)))))
  (func field_expr_field_len ((param node (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 24)))
      (return (unop * (ident p)))))
  (func number_expr_alloc () (type_ptr (type_base u8))
    (block
      (var node (type_ptr (type_base u8)) (call (ident alloc) (number 24)))
      (expr_stmt (call (ident node_set_kind) (ident node) (ident NODE_NUMBER_EXPR)))
      (return (ident node))))
  (func number_expr_value ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (return (unop * (ident p)))))
  (func number_expr_set_value ((param node (type_ptr (type_base u8))) (param ptr (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (assign (unop * (ident p)) (ident ptr))))
  (func number_expr_value_len ((param node (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 16)))
      (return (unop * (ident p)))))
  (func number_expr_set_value_len ((param node (type_ptr (type_base u8))) (param len (type_base i64))) (type_base void)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 16)))
      (assign (unop * (ident p)) (ident len))))
  (func string_expr_alloc () (type_ptr (type_base u8))
    (block
      (var node (type_ptr (type_base u8)) (call (ident alloc) (number 24)))
      (expr_stmt (call (ident node_set_kind) (ident node) (ident NODE_STRING_EXPR)))
      (return (ident node))))
  (func string_expr_value ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (return (unop * (ident p)))))
  (func string_expr_set_value ((param node (type_ptr (type_base u8))) (param ptr (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (assign (unop * (ident p)) (ident ptr))))
  (func string_expr_value_len ((param node (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 16)))
      (return (unop * (ident p)))))
  (func string_expr_set_value_len ((param node (type_ptr (type_base u8))) (param len (type_base i64))) (type_base void)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 16)))
      (assign (unop * (ident p)) (ident len))))
  (func parse_string_literal ((param quoted (type_ptr (type_base u8))) (param quoted_len (type_base i64))) (type_ptr (type_base u8))
    (block
      (var buf (type_ptr (type_base u8)) (call (ident alloc) (binop + (ident quoted_len) (number 1))))
      (var out (type_base i64) (number 0))
      (var i (type_base i64) (number 1))
      (while (binop < (ident i) (binop - (ident quoted_len) (number 1)))
        (block
          (var c (type_base u8) (unop * (binop + (ident quoted) (ident i))))
          (if (binop && (binop == (ident c) (number 92)) (binop < (binop + (ident i) (number 1)) (binop - (ident quoted_len) (number 1))))
            (block
              (var next (type_base u8) (unop * (binop + (binop + (ident quoted) (ident i)) (number 1))))
              (if (binop == (ident next) (number 110))
                (block
                  (assign (unop * (binop + (ident buf) (ident out))) (number 10))
                  (assign (ident out) (binop + (ident out) (number 1)))
                  (assign (ident i) (binop + (ident i) (number 2))))
                (if (binop == (ident next) (number 116))
                  (block
                    (assign (unop * (binop + (ident buf) (ident out))) (number 9))
                    (assign (ident out) (binop + (ident out) (number 1)))
                    (assign (ident i) (binop + (ident i) (number 2))))
                  (if (binop == (ident next) (number 114))
                    (block
                      (assign (unop * (binop + (ident buf) (ident out))) (number 13))
                      (assign (ident out) (binop + (ident out) (number 1)))
                      (assign (ident i) (binop + (ident i) (number 2))))
                    (if (binop == (ident next) (number 48))
                      (block
                        (assign (unop * (binop + (ident buf) (ident out))) (number 0))
                        (assign (ident out) (binop + (ident out) (number 1)))
                        (assign (ident i) (binop + (ident i) (number 2))))
                      (if (binop == (ident next) (number 34))
                        (block
                          (assign (unop * (binop + (ident buf) (ident out))) (number 34))
                          (assign (ident out) (binop + (ident out) (number 1)))
                          (assign (ident i) (binop + (ident i) (number 2))))
                        (if (binop == (ident next) (number 92))
                          (block
                            (assign (unop * (binop + (ident buf) (ident out))) (number 92))
                            (assign (ident out) (binop + (ident out) (number 1)))
                            (assign (ident i) (binop + (ident i) (number 2))))
                          (block
                            (assign (unop * (binop + (ident buf) (ident out))) (ident c))
                            (assign (ident out) (binop + (ident out) (number 1)))
                            (assign (ident i) (binop + (ident i) (number 1)))))))))))
            (block
              (assign (unop * (binop + (ident buf) (ident out))) (ident c))
              (assign (ident out) (binop + (ident out) (number 1)))
              (assign (ident i) (binop + (ident i) (number 1)))))))
      (assign (unop * (binop + (ident buf) (ident out))) (number 0))
      (return (ident buf))))
  (func parse_string_literal_len ((param quoted (type_ptr (type_base u8))) (param quoted_len (type_base i64))) (type_base i64)
    (block
      (var out (type_base i64) (number 0))
      (var i (type_base i64) (number 1))
      (while (binop < (ident i) (binop - (ident quoted_len) (number 1)))
        (block
          (var c (type_base u8) (unop * (binop + (ident quoted) (ident i))))
          (if (binop && (binop == (ident c) (number 92)) (binop < (binop + (ident i) (number 1)) (binop - (ident quoted_len) (number 1))))
            (block
              (var next (type_base u8) (unop * (binop + (binop + (ident quoted) (ident i)) (number 1))))
              (if (binop || (binop || (binop || (binop || (binop || (binop == (ident next) (number 110)) (binop == (ident next) (number 116))) (binop == (ident next) (number 114))) (binop == (ident next) (number 48))) (binop == (ident next) (number 34))) (binop == (ident next) (number 92)))
                (block
                  (assign (ident out) (binop + (ident out) (number 1)))
                  (assign (ident i) (binop + (ident i) (number 2))))
                (block
                  (assign (ident out) (binop + (ident out) (number 1)))
                  (assign (ident i) (binop + (ident i) (number 1))))))
            (block
              (assign (ident out) (binop + (ident out) (number 1)))
              (assign (ident i) (binop + (ident i) (number 1)))))))
      (return (ident out))))
  (func bool_expr_alloc () (type_ptr (type_base u8))
    (block
      (var node (type_ptr (type_base u8)) (call (ident alloc) (number 16)))
      (expr_stmt (call (ident node_set_kind) (ident node) (ident NODE_BOOL_EXPR)))
      (return (ident node))))
  (func bool_expr_value ((param node (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 8)))
      (return (unop * (ident p)))))
  (func bool_expr_set_value ((param node (type_ptr (type_base u8))) (param val (type_base i64))) (type_base void)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 8)))
      (assign (unop * (ident p)) (ident val))))
  (func nil_expr_alloc () (type_ptr (type_base u8))
    (block
      (var node (type_ptr (type_base u8)) (call (ident alloc) (number 8)))
      (expr_stmt (call (ident node_set_kind) (ident node) (ident NODE_NIL_EXPR)))
      (return (ident node))))
  (func group_expr_alloc () (type_ptr (type_base u8))
    (block
      (var node (type_ptr (type_base u8)) (call (ident alloc) (number 16)))
      (expr_stmt (call (ident node_set_kind) (ident node) (ident NODE_GROUP_EXPR)))
      (return (ident node))))
  (func group_expr_expr ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (return (unop * (ident p)))))
  (func group_expr_set_expr ((param node (type_ptr (type_base u8))) (param expr (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (assign (unop * (ident p)) (ident expr))))
  (func quote_expr_alloc () (type_ptr (type_base u8))
    (block
      (var node (type_ptr (type_base u8)) (call (ident alloc) (number 16)))
      (expr_stmt (call (ident node_set_kind) (ident node) (ident NODE_QUOTE_EXPR)))
      (return (ident node))))
  (func quote_expr_expr ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (return (unop * (ident p)))))
  (func quote_expr_set_expr ((param node (type_ptr (type_base u8))) (param expr (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (assign (unop * (ident p)) (ident expr))))
  (func unquote_expr_alloc () (type_ptr (type_base u8))
    (block
      (var node (type_ptr (type_base u8)) (call (ident alloc) (number 24)))
      (expr_stmt (call (ident node_set_kind) (ident node) (ident NODE_UNQUOTE_EXPR)))
      (return (ident node))))
  (func unquote_expr_name ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (return (unop * (ident p)))))
  (func unquote_expr_set_name ((param node (type_ptr (type_base u8))) (param ptr (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (assign (unop * (ident p)) (ident ptr))))
  (func unquote_expr_name_len ((param node (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 16)))
      (return (unop * (ident p)))))
  (func unquote_expr_set_name_len ((param node (type_ptr (type_base u8))) (param len (type_base i64))) (type_base void)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 16)))
      (assign (unop * (ident p)) (ident len))))
  (func unquote_string_expr_alloc () (type_ptr (type_base u8))
    (block
      (var node (type_ptr (type_base u8)) (call (ident alloc) (number 24)))
      (expr_stmt (call (ident node_set_kind) (ident node) (ident NODE_UNQUOTE_STRING_EXPR)))
      (return (ident node))))
  (func unquote_string_expr_name ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (return (unop * (ident p)))))
  (func unquote_string_expr_set_name ((param node (type_ptr (type_base u8))) (param ptr (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (assign (unop * (ident p)) (ident ptr))))
  (func unquote_string_expr_name_len ((param node (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 16)))
      (return (unop * (ident p)))))
  (func unquote_string_expr_set_name_len ((param node (type_ptr (type_base u8))) (param len (type_base i64))) (type_base void)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 16)))
      (assign (unop * (ident p)) (ident len))))
  (func macro_decl_alloc () (type_ptr (type_base u8))
    (block
      (var node (type_ptr (type_base u8)) (call (ident alloc) (number 48)))
      (expr_stmt (call (ident node_set_kind) (ident node) (ident NODE_MACRO_DECL)))
      (return (ident node))))
  (func macro_decl_name ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (return (unop * (ident p)))))
  (func macro_decl_set_name ((param node (type_ptr (type_base u8))) (param ptr (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (assign (unop * (ident p)) (ident ptr))))
  (func macro_decl_name_len ((param node (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 16)))
      (return (unop * (ident p)))))
  (func macro_decl_set_name_len ((param node (type_ptr (type_base u8))) (param len (type_base i64))) (type_base void)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 16)))
      (assign (unop * (ident p)) (ident len))))
  (func macro_decl_params ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 24)))
      (return (unop * (ident p)))))
  (func macro_decl_set_params ((param node (type_ptr (type_base u8))) (param params (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 24)))
      (assign (unop * (ident p)) (ident params))))
  (func macro_decl_param_count ((param node (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 32)))
      (return (unop * (ident p)))))
  (func macro_decl_set_param_count ((param node (type_ptr (type_base u8))) (param count (type_base i64))) (type_base void)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 32)))
      (assign (unop * (ident p)) (ident count))))
  (func macro_decl_body ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 40)))
      (return (unop * (ident p)))))
  (func macro_decl_set_body ((param node (type_ptr (type_base u8))) (param body (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 40)))
      (assign (unop * (ident p)) (ident body))))
  (func let_expr_alloc () (type_ptr (type_base u8))
    (block
      (var node (type_ptr (type_base u8)) (call (ident alloc) (number 48)))
      (expr_stmt (call (ident node_set_kind) (ident node) (ident NODE_LET_EXPR)))
      (return (ident node))))
  (func let_expr_name ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (return (unop * (ident p)))))
  (func let_expr_set_name ((param node (type_ptr (type_base u8))) (param ptr (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (assign (unop * (ident p)) (ident ptr))))
  (func let_expr_name_len ((param node (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 16)))
      (return (unop * (ident p)))))
  (func let_expr_set_name_len ((param node (type_ptr (type_base u8))) (param len (type_base i64))) (type_base void)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 16)))
      (assign (unop * (ident p)) (ident len))))
  (func let_expr_type ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 24)))
      (return (unop * (ident p)))))
  (func let_expr_set_type ((param node (type_ptr (type_base u8))) (param typ (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 24)))
      (assign (unop * (ident p)) (ident typ))))
  (func let_expr_init ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 32)))
      (return (unop * (ident p)))))
  (func let_expr_set_init ((param node (type_ptr (type_base u8))) (param init (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 32)))
      (assign (unop * (ident p)) (ident init))))
  (func let_expr_body ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 40)))
      (return (unop * (ident p)))))
  (func let_expr_set_body ((param node (type_ptr (type_base u8))) (param body (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 40)))
      (assign (unop * (ident p)) (ident body))))
  (func lambda_expr_alloc () (type_ptr (type_base u8))
    (block
      (var node (type_ptr (type_base u8)) (call (ident alloc) (number 40)))
      (expr_stmt (call (ident node_set_kind) (ident node) (ident NODE_LAMBDA_EXPR)))
      (return (ident node))))
  (func lambda_expr_params ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (return (unop * (ident p)))))
  (func lambda_expr_set_params ((param node (type_ptr (type_base u8))) (param params (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (assign (unop * (ident p)) (ident params))))
  (func lambda_expr_param_count ((param node (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 16)))
      (return (unop * (ident p)))))
  (func lambda_expr_set_param_count ((param node (type_ptr (type_base u8))) (param count (type_base i64))) (type_base void)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 16)))
      (assign (unop * (ident p)) (ident count))))
  (func lambda_expr_ret_type ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 24)))
      (return (unop * (ident p)))))
  (func lambda_expr_set_ret_type ((param node (type_ptr (type_base u8))) (param typ (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 24)))
      (assign (unop * (ident p)) (ident typ))))
  (func lambda_expr_body ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 32)))
      (return (unop * (ident p)))))
  (func lambda_expr_set_body ((param node (type_ptr (type_base u8))) (param body (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 32)))
      (assign (unop * (ident p)) (ident body))))
  (struct ImportDecl ((field_decl kind (type_base i64)) (field_decl path (type_ptr (type_base u8))) (field_decl path_len (type_base i64))))
  (func import_decl_alloc () (type_ptr (type_base u8))
    (block
      (var node (type_ptr (type_base u8)) (call (ident alloc) (number 24)))
      (expr_stmt (call (ident node_set_kind) (ident node) (ident NODE_IMPORT)))
      (return (ident node))))
  (func import_decl_path ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var n (type_ptr (type_base ImportDecl)) (ident node))
      (return (field (ident n) path))))
  (func import_decl_set_path ((param node (type_ptr (type_base u8))) (param ptr (type_ptr (type_base u8)))) (type_base void)
    (block
      (var n (type_ptr (type_base ImportDecl)) (ident node))
      (assign (field (ident n) path) (ident ptr))))
  (func import_decl_path_len ((param node (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var n (type_ptr (type_base ImportDecl)) (ident node))
      (return (field (ident n) path_len))))
  (func import_decl_set_path_len ((param node (type_ptr (type_base u8))) (param len (type_base i64))) (type_base void)
    (block
      (var n (type_ptr (type_base ImportDecl)) (ident node))
      (assign (field (ident n) path_len) (ident len))))
  (struct ReaderDecl ((field_decl kind (type_base i64)) (field_decl name (type_ptr (type_base u8))) (field_decl name_len (type_base i64)) (field_decl param_name (type_ptr (type_base u8))) (field_decl param_len (type_base i64)) (field_decl body (type_ptr (type_base u8))) (field_decl is_ast (type_base i64)) (field_decl is_pub (type_base i64))))
  (func reader_decl_alloc () (type_ptr (type_base u8))
    (block
      (var node (type_ptr (type_base u8)) (call (ident alloc) (number 64)))
      (expr_stmt (call (ident node_set_kind) (ident node) (ident NODE_READER_DECL)))
      (return (ident node))))
  (func reader_decl_name ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var n (type_ptr (type_base ReaderDecl)) (ident node))
      (return (field (ident n) name))))
  (func reader_decl_set_name ((param node (type_ptr (type_base u8))) (param ptr (type_ptr (type_base u8)))) (type_base void)
    (block
      (var n (type_ptr (type_base ReaderDecl)) (ident node))
      (assign (field (ident n) name) (ident ptr))))
  (func reader_decl_name_len ((param node (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var n (type_ptr (type_base ReaderDecl)) (ident node))
      (return (field (ident n) name_len))))
  (func reader_decl_set_name_len ((param node (type_ptr (type_base u8))) (param len (type_base i64))) (type_base void)
    (block
      (var n (type_ptr (type_base ReaderDecl)) (ident node))
      (assign (field (ident n) name_len) (ident len))))
  (func reader_decl_param_name ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var n (type_ptr (type_base ReaderDecl)) (ident node))
      (return (field (ident n) param_name))))
  (func reader_decl_set_param_name ((param node (type_ptr (type_base u8))) (param ptr (type_ptr (type_base u8)))) (type_base void)
    (block
      (var n (type_ptr (type_base ReaderDecl)) (ident node))
      (assign (field (ident n) param_name) (ident ptr))))
  (func reader_decl_param_len ((param node (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var n (type_ptr (type_base ReaderDecl)) (ident node))
      (return (field (ident n) param_len))))
  (func reader_decl_set_param_len ((param node (type_ptr (type_base u8))) (param len (type_base i64))) (type_base void)
    (block
      (var n (type_ptr (type_base ReaderDecl)) (ident node))
      (assign (field (ident n) param_len) (ident len))))
  (func reader_decl_body ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var n (type_ptr (type_base ReaderDecl)) (ident node))
      (return (field (ident n) body))))
  (func reader_decl_set_body ((param node (type_ptr (type_base u8))) (param body (type_ptr (type_base u8)))) (type_base void)
    (block
      (var n (type_ptr (type_base ReaderDecl)) (ident node))
      (assign (field (ident n) body) (ident body))))
  (func reader_decl_is_ast ((param node (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var n (type_ptr (type_base ReaderDecl)) (ident node))
      (return (field (ident n) is_ast))))
  (func reader_decl_set_is_ast ((param node (type_ptr (type_base u8))) (param val (type_base i64))) (type_base void)
    (block
      (var n (type_ptr (type_base ReaderDecl)) (ident node))
      (assign (field (ident n) is_ast) (ident val))))
  (func reader_decl_is_pub ((param node (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var n (type_ptr (type_base ReaderDecl)) (ident node))
      (return (field (ident n) is_pub))))
  (func reader_decl_set_is_pub ((param node (type_ptr (type_base u8))) (param is_pub (type_base i64))) (type_base void)
    (block
      (var n (type_ptr (type_base ReaderDecl)) (ident node))
      (assign (field (ident n) is_pub) (ident is_pub))))
  (struct ReaderExpr ((field_decl kind (type_base i64)) (field_decl name (type_ptr (type_base u8))) (field_decl name_len (type_base i64)) (field_decl content (type_ptr (type_base u8))) (field_decl content_len (type_base i64))))
  (func reader_expr_alloc () (type_ptr (type_base u8))
    (block
      (var node (type_ptr (type_base u8)) (call (ident alloc) (number 40)))
      (expr_stmt (call (ident node_set_kind) (ident node) (ident NODE_READER_EXPR)))
      (return (ident node))))
  (func reader_expr_name ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var n (type_ptr (type_base ReaderExpr)) (ident node))
      (return (field (ident n) name))))
  (func reader_expr_set_name ((param node (type_ptr (type_base u8))) (param ptr (type_ptr (type_base u8)))) (type_base void)
    (block
      (var n (type_ptr (type_base ReaderExpr)) (ident node))
      (assign (field (ident n) name) (ident ptr))))
  (func reader_expr_name_len ((param node (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var n (type_ptr (type_base ReaderExpr)) (ident node))
      (return (field (ident n) name_len))))
  (func reader_expr_set_name_len ((param node (type_ptr (type_base u8))) (param len (type_base i64))) (type_base void)
    (block
      (var n (type_ptr (type_base ReaderExpr)) (ident node))
      (assign (field (ident n) name_len) (ident len))))
  (func reader_expr_content ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var n (type_ptr (type_base ReaderExpr)) (ident node))
      (return (field (ident n) content))))
  (func reader_expr_set_content ((param node (type_ptr (type_base u8))) (param ptr (type_ptr (type_base u8)))) (type_base void)
    (block
      (var n (type_ptr (type_base ReaderExpr)) (ident node))
      (assign (field (ident n) content) (ident ptr))))
  (func reader_expr_content_len ((param node (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var n (type_ptr (type_base ReaderExpr)) (ident node))
      (return (field (ident n) content_len))))
  (func reader_expr_set_content_len ((param node (type_ptr (type_base u8))) (param len (type_base i64))) (type_base void)
    (block
      (var n (type_ptr (type_base ReaderExpr)) (ident node))
      (assign (field (ident n) content_len) (ident len))))
  (struct IncludeDecl ((field_decl kind (type_base i64)) (field_decl path (type_ptr (type_base u8))) (field_decl path_len (type_base i64))))
  (func include_decl_alloc () (type_ptr (type_base u8))
    (block
      (var node (type_ptr (type_base u8)) (call (ident alloc) (number 24)))
      (expr_stmt (call (ident node_set_kind) (ident node) (ident NODE_INCLUDE_DECL)))
      (return (ident node))))
  (func include_decl_path ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var n (type_ptr (type_base IncludeDecl)) (ident node))
      (return (field (ident n) path))))
  (func include_decl_set_path ((param node (type_ptr (type_base u8))) (param ptr (type_ptr (type_base u8)))) (type_base void)
    (block
      (var n (type_ptr (type_base IncludeDecl)) (ident node))
      (assign (field (ident n) path) (ident ptr))))
  (func include_decl_path_len ((param node (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var n (type_ptr (type_base IncludeDecl)) (ident node))
      (return (field (ident n) path_len))))
  (func include_decl_set_path_len ((param node (type_ptr (type_base u8))) (param len (type_base i64))) (type_base void)
    (block
      (var n (type_ptr (type_base IncludeDecl)) (ident node))
      (assign (field (ident n) path_len) (ident len))))
  (struct RequireDecl ((field_decl kind (type_base i64)) (field_decl module (type_ptr (type_base u8))) (field_decl module_len (type_base i64))))
  (func require_decl_alloc () (type_ptr (type_base u8))
    (block
      (var node (type_ptr (type_base u8)) (call (ident alloc) (number 24)))
      (expr_stmt (call (ident node_set_kind) (ident node) (ident NODE_REQUIRE_DECL)))
      (return (ident node))))
  (func require_decl_module ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var n (type_ptr (type_base RequireDecl)) (ident node))
      (return (field (ident n) module))))
  (func require_decl_set_module ((param node (type_ptr (type_base u8))) (param ptr (type_ptr (type_base u8)))) (type_base void)
    (block
      (var n (type_ptr (type_base RequireDecl)) (ident node))
      (assign (field (ident n) module) (ident ptr))))
  (func require_decl_module_len ((param node (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var n (type_ptr (type_base RequireDecl)) (ident node))
      (return (field (ident n) module_len))))
  (func require_decl_set_module_len ((param node (type_ptr (type_base u8))) (param len (type_base i64))) (type_base void)
    (block
      (var n (type_ptr (type_base RequireDecl)) (ident node))
      (assign (field (ident n) module_len) (ident len))))
  (struct ModulesDecl ((field_decl kind (type_base i64)) (field_decl modules (type_ptr (type_base u8))) (field_decl count (type_base i64))))
  (func modules_decl_alloc () (type_ptr (type_base u8))
    (block
      (var node (type_ptr (type_base u8)) (call (ident alloc) (number 24)))
      (expr_stmt (call (ident node_set_kind) (ident node) (ident NODE_MODULES_DECL)))
      (return (ident node))))
  (func modules_decl_modules ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var n (type_ptr (type_base ModulesDecl)) (ident node))
      (return (field (ident n) modules))))
  (func modules_decl_set_modules ((param node (type_ptr (type_base u8))) (param ptr (type_ptr (type_base u8)))) (type_base void)
    (block
      (var n (type_ptr (type_base ModulesDecl)) (ident node))
      (assign (field (ident n) modules) (ident ptr))))
  (func modules_decl_count ((param node (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var n (type_ptr (type_base ModulesDecl)) (ident node))
      (return (field (ident n) count))))
  (func modules_decl_set_count ((param node (type_ptr (type_base u8))) (param c (type_base i64))) (type_base void)
    (block
      (var n (type_ptr (type_base ModulesDecl)) (ident node))
      (assign (field (ident n) count) (ident c))))
  (func modules_decl_get ((param node (type_ptr (type_base u8))) (param index (type_base i64))) (type_ptr (type_base u8))
    (block
      (var mods (type_ptr (type_base u8)) (call (ident modules_decl_modules) (ident node)))
      (return (binop + (ident mods) (binop * (ident index) (number 16))))))
  (func module_entry_name ((param entry (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (ident entry))
      (return (unop * (ident p)))))
  (func module_entry_len ((param entry (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident entry) (number 8)))
      (return (unop * (ident p)))))
  (func module_entry_set ((param entry (type_ptr (type_base u8))) (param name (type_ptr (type_base u8))) (param len (type_base i64))) (type_base void)
    (block
      (var p1 (type_ptr (type_ptr (type_base u8))) (ident entry))
      (assign (unop * (ident p1)) (ident name))
      (var p2 (type_ptr (type_base i64)) (binop + (ident entry) (number 8)))
      (assign (unop * (ident p2)) (ident len))))
  (func type_kind ((param t (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var p (type_ptr (type_base i64)) (ident t))
      (return (unop * (ident p)))))
  (func type_set_kind ((param t (type_ptr (type_base u8))) (param k (type_base i64))) (type_base void)
    (block
      (var p (type_ptr (type_base i64)) (ident t))
      (assign (unop * (ident p)) (ident k))))
  (func base_type_alloc () (type_ptr (type_base u8))
    (block
      (var t (type_ptr (type_base u8)) (call (ident alloc) (number 24)))
      (expr_stmt (call (ident type_set_kind) (ident t) (ident TYPE_BASE)))
      (return (ident t))))
  (func base_type_name ((param t (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident t) (number 8)))
      (return (unop * (ident p)))))
  (func base_type_set_name ((param t (type_ptr (type_base u8))) (param ptr (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident t) (number 8)))
      (assign (unop * (ident p)) (ident ptr))))
  (func base_type_name_len ((param t (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident t) (number 16)))
      (return (unop * (ident p)))))
  (func base_type_set_name_len ((param t (type_ptr (type_base u8))) (param len (type_base i64))) (type_base void)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident t) (number 16)))
      (assign (unop * (ident p)) (ident len))))
  (func ptr_type_alloc () (type_ptr (type_base u8))
    (block
      (var t (type_ptr (type_base u8)) (call (ident alloc) (number 16)))
      (expr_stmt (call (ident type_set_kind) (ident t) (ident TYPE_PTR)))
      (return (ident t))))
  (func ptr_type_elem ((param t (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident t) (number 8)))
      (return (unop * (ident p)))))
  (func ptr_type_set_elem ((param t (type_ptr (type_base u8))) (param elem (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident t) (number 8)))
      (assign (unop * (ident p)) (ident elem))))
  (func func_type_alloc () (type_ptr (type_base u8))
    (block
      (var t (type_ptr (type_base u8)) (call (ident alloc) (number 32)))
      (expr_stmt (call (ident type_set_kind) (ident t) (ident TYPE_FUNC)))
      (return (ident t))))
  (func func_type_params ((param t (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident t) (number 8)))
      (return (unop * (ident p)))))
  (func func_type_set_params ((param t (type_ptr (type_base u8))) (param params (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident t) (number 8)))
      (assign (unop * (ident p)) (ident params))))
  (func func_type_param_count ((param t (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident t) (number 16)))
      (return (unop * (ident p)))))
  (func func_type_set_param_count ((param t (type_ptr (type_base u8))) (param count (type_base i64))) (type_base void)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident t) (number 16)))
      (assign (unop * (ident p)) (ident count))))
  (func func_type_ret ((param t (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident t) (number 24)))
      (return (unop * (ident p)))))
  (func func_type_set_ret ((param t (type_ptr (type_base u8))) (param ret (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident t) (number 24)))
      (assign (unop * (ident p)) (ident ret))))
  (func closure_type_alloc () (type_ptr (type_base u8))
    (block
      (var t (type_ptr (type_base u8)) (call (ident alloc) (number 32)))
      (expr_stmt (call (ident type_set_kind) (ident t) (ident TYPE_CLOSURE)))
      (return (ident t))))
  (func closure_type_params ((param t (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident t) (number 8)))
      (return (unop * (ident p)))))
  (func closure_type_set_params ((param t (type_ptr (type_base u8))) (param params (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident t) (number 8)))
      (assign (unop * (ident p)) (ident params))))
  (func closure_type_param_count ((param t (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident t) (number 16)))
      (return (unop * (ident p)))))
  (func closure_type_set_param_count ((param t (type_ptr (type_base u8))) (param count (type_base i64))) (type_base void)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident t) (number 16)))
      (assign (unop * (ident p)) (ident count))))
  (func closure_type_ret ((param t (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident t) (number 24)))
      (return (unop * (ident p)))))
  (func closure_type_set_ret ((param t (type_ptr (type_base u8))) (param ret (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident t) (number 24)))
      (assign (unop * (ident p)) (ident ret))))
  (func array_type_alloc () (type_ptr (type_base u8))
    (block
      (var t (type_ptr (type_base u8)) (call (ident alloc) (number 24)))
      (expr_stmt (call (ident type_set_kind) (ident t) (ident TYPE_ARRAY)))
      (return (ident t))))
  (func array_type_size ((param t (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident t) (number 8)))
      (return (unop * (ident p)))))
  (func array_type_set_size ((param t (type_ptr (type_base u8))) (param size (type_base i64))) (type_base void)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident t) (number 8)))
      (assign (unop * (ident p)) (ident size))))
  (func array_type_elem ((param t (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident t) (number 16)))
      (return (unop * (ident p)))))
  (func array_type_set_elem ((param t (type_ptr (type_base u8))) (param elem (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident t) (number 16)))
      (assign (unop * (ident p)) (ident elem))))
  (func array_literal_alloc () (type_ptr (type_base u8))
    (block
      (var node (type_ptr (type_base u8)) (call (ident alloc) (number 24)))
      (expr_stmt (call (ident node_set_kind) (ident node) (ident NODE_ARRAY_LITERAL)))
      (return (ident node))))
  (func array_literal_elems ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (return (unop * (ident p)))))
  (func array_literal_set_elems ((param node (type_ptr (type_base u8))) (param elems (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (assign (unop * (ident p)) (ident elems))))
  (func array_literal_count ((param node (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 16)))
      (return (unop * (ident p)))))
  (func array_literal_set_count ((param node (type_ptr (type_base u8))) (param count (type_base i64))) (type_base void)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident node) (number 16)))
      (assign (unop * (ident p)) (ident count))))
  (func index_expr_alloc () (type_ptr (type_base u8))
    (block
      (var node (type_ptr (type_base u8)) (call (ident alloc) (number 24)))
      (expr_stmt (call (ident node_set_kind) (ident node) (ident NODE_INDEX_EXPR)))
      (return (ident node))))
  (func index_expr_base ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (return (unop * (ident p)))))
  (func index_expr_set_base ((param node (type_ptr (type_base u8))) (param base (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
      (assign (unop * (ident p)) (ident base))))
  (func index_expr_index ((param node (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 16)))
      (return (unop * (ident p)))))
  (func index_expr_set_index ((param node (type_ptr (type_base u8))) (param idx (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 16)))
      (assign (unop * (ident p)) (ident idx))))
  (func param_name ((param p (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var ptr (type_ptr (type_ptr (type_base u8))) (ident p))
      (return (unop * (ident ptr)))))
  (func param_set_name ((param p (type_ptr (type_base u8))) (param name (type_ptr (type_base u8)))) (type_base void)
    (block
      (var ptr (type_ptr (type_ptr (type_base u8))) (ident p))
      (assign (unop * (ident ptr)) (ident name))))
  (func param_name_len ((param p (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var ptr (type_ptr (type_base i64)) (binop + (ident p) (number 8)))
      (return (unop * (ident ptr)))))
  (func param_set_name_len ((param p (type_ptr (type_base u8))) (param len (type_base i64))) (type_base void)
    (block
      (var ptr (type_ptr (type_base i64)) (binop + (ident p) (number 8)))
      (assign (unop * (ident ptr)) (ident len))))
  (func param_type ((param p (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var ptr (type_ptr (type_ptr (type_base u8))) (binop + (ident p) (number 16)))
      (return (unop * (ident ptr)))))
  (func param_set_type ((param p (type_ptr (type_base u8))) (param t (type_ptr (type_base u8)))) (type_base void)
    (block
      (var ptr (type_ptr (type_ptr (type_base u8))) (binop + (ident p) (number 16)))
      (assign (unop * (ident ptr)) (ident t))))
  (var parse_tokens (type_ptr (type_base u8)) (nil))
  (var parse_current (type_base i64) (number 0))
  (var parse_error_count (type_base i64) (number 0))
  (var parse_max_errors (type_base i64) (number 10))
  (func get_token ((param index (type_base i64))) (type_ptr (type_base u8))
    (block
      (var ptr_as_int (type_base i64) (call (ident vec_get) (ident parse_tokens) (ident index)))
      (var p (type_ptr (type_base i64)) (unop & (ident ptr_as_int)))
      (var pp (type_ptr (type_ptr (type_base u8))) (ident p))
      (return (unop * (ident pp)))))
  (func parser_token_count () (type_base i64)
    (block
      (return (call (ident vec_len) (ident parse_tokens)))))
  (func parser_init () (type_base void)
    (block
      (assign (ident parse_tokens) (call (ident vec_new) (number 8)))
      (assign (ident parse_current) (number 0))
      (assign (ident parse_error_count) (number 0))))
  (func parser_add_token ((param tok (type_ptr (type_base u8)))) (type_base void)
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (unop & (ident tok)))
      (var pi (type_ptr (type_base i64)) (ident p))
      (expr_stmt (call (ident vec_push) (ident parse_tokens) (unop * (ident pi))))))
  (func parser_tokenize ((param source (type_ptr (type_base u8)))) (type_base void)
    (block
      (expr_stmt (call (ident parser_init)))
      (expr_stmt (call (ident lexer_init) (ident source)))
      (var done (type_base i64) (number 0))
      (while (binop == (ident done) (number 0))
        (block
          (var tok (type_ptr (type_base u8)) (call (ident scan_token)))
          (expr_stmt (call (ident parser_add_token) (ident tok)))
          (if (binop || (binop == (call (ident tok_type) (ident tok)) (ident TOKEN_EOF)) (binop == (call (ident tok_type) (ident tok)) (ident TOKEN_ERROR)))
            (block
              (assign (ident done) (number 1))))))))
  (func parse_is_at_end () (type_base bool)
    (block
      (return (binop == (call (ident tok_type) (call (ident parse_peek))) (ident TOKEN_EOF)))))
  (func parse_peek () (type_ptr (type_base u8))
    (block
      (return (call (ident get_token) (ident parse_current)))))
  (func parse_peek_next () (type_ptr (type_base u8))
    (block
      (if (binop >= (binop + (ident parse_current) (number 1)) (call (ident parser_token_count)))
        (block
          (return (nil))))
      (return (call (ident get_token) (binop + (ident parse_current) (number 1))))))
  (func parse_previous () (type_ptr (type_base u8))
    (block
      (return (call (ident get_token) (binop - (ident parse_current) (number 1))))))
  (func parse_advance () (type_ptr (type_base u8))
    (block
      (if (unop ! (call (ident parse_is_at_end)))
        (block
          (assign (ident parse_current) (binop + (ident parse_current) (number 1)))))
      (return (call (ident parse_previous)))))
  (func parse_check ((param t (type_base i64))) (type_base bool)
    (block
      (if (call (ident parse_is_at_end))
        (block
          (return (bool false))))
      (return (binop == (call (ident tok_type) (call (ident parse_peek))) (ident t)))))
  (func parse_match ((param t (type_base i64))) (type_base bool)
    (block
      (if (call (ident parse_check) (ident t))
        (block
          (expr_stmt (call (ident parse_advance)))
          (return (bool true))))
      (return (bool false))))
  (func parse_error ((param msg (type_ptr (type_base u8)))) (type_base void)
    (block
      (var tok (type_ptr (type_base u8)) (call (ident parse_peek)))
      (expr_stmt (call (ident eprint) (string "Error at ")))
      (expr_stmt (call (ident eprint_i64) (call (ident tok_line) (ident tok))))
      (expr_stmt (call (ident eprint) (string ":")))
      (expr_stmt (call (ident eprint_i64) (call (ident tok_col) (ident tok))))
      (expr_stmt (call (ident eprint) (string ": ")))
      (expr_stmt (call (ident eprintln) (ident msg)))
      (assign (ident parse_error_count) (binop + (ident parse_error_count) (number 1)))
      (if (binop >= (ident parse_error_count) (ident parse_max_errors))
        (block
          (expr_stmt (call (ident eprintln) (string "Too many errors, stopping.")))
          (expr_stmt (call (ident exit) (number 1)))))))
  (func parse_expect ((param t (type_base i64)) (param msg (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (if (call (ident parse_check) (ident t))
        (block
          (return (call (ident parse_advance)))))
      (expr_stmt (call (ident parse_error) (ident msg)))
      (return (nil))))
  (func parse_type () (type_ptr (type_base u8))
    (block
      (if (call (ident parse_match) (ident TOKEN_STAR))
        (block
          (var elem (type_ptr (type_base u8)) (call (ident parse_type)))
          (var t (type_ptr (type_base u8)) (call (ident ptr_type_alloc)))
          (expr_stmt (call (ident ptr_type_set_elem) (ident t) (ident elem)))
          (return (ident t))))
      (if (call (ident parse_match) (ident TOKEN_LBRACKET))
        (block
          (var size_tok (type_ptr (type_base u8)) (call (ident parse_expect) (ident TOKEN_NUMBER) (string "expected array size")))
          (var size (type_base i64) (call (ident parse_number_value) (ident size_tok)))
          (expr_stmt (call (ident parse_expect) (ident TOKEN_RBRACKET) (string "expected ']' after array size")))
          (var elem (type_ptr (type_base u8)) (call (ident parse_type)))
          (var t (type_ptr (type_base u8)) (call (ident array_type_alloc)))
          (expr_stmt (call (ident array_type_set_size) (ident t) (ident size)))
          (expr_stmt (call (ident array_type_set_elem) (ident t) (ident elem)))
          (return (ident t))))
      (if (call (ident parse_match) (ident TOKEN_FN))
        (block
          (expr_stmt (call (ident parse_expect) (ident TOKEN_LPAREN) (string "expected '(' after 'fn'")))
          (var params (type_ptr (type_base u8)) (call (ident vec_new) (number 8)))
          (if (unop ! (call (ident parse_check) (ident TOKEN_RPAREN)))
            (block
              (var first (type_base i64) (number 1))
              (while (binop || (binop == (ident first) (number 1)) (call (ident parse_match) (ident TOKEN_COMMA)))
                (block
                  (assign (ident first) (number 0))
                  (var param_type (type_ptr (type_base u8)) (call (ident parse_type)))
                  (expr_stmt (call (ident vec_push) (ident params) (ident param_type)))))))
          (expr_stmt (call (ident parse_expect) (ident TOKEN_RPAREN) (string "expected ')' after parameter types")))
          (var ret (type_ptr (type_base u8)) (call (ident parse_type)))
          (var t (type_ptr (type_base u8)) (call (ident func_type_alloc)))
          (expr_stmt (call (ident func_type_set_params) (ident t) (ident params)))
          (expr_stmt (call (ident func_type_set_param_count) (ident t) (call (ident vec_len) (ident params))))
          (expr_stmt (call (ident func_type_set_ret) (ident t) (ident ret)))
          (return (ident t))))
      (if (call (ident parse_match) (ident TOKEN_CLOSURE))
        (block
          (expr_stmt (call (ident parse_expect) (ident TOKEN_LPAREN) (string "expected '(' after 'closure'")))
          (var params (type_ptr (type_base u8)) (call (ident vec_new) (number 8)))
          (if (unop ! (call (ident parse_check) (ident TOKEN_RPAREN)))
            (block
              (var first (type_base i64) (number 1))
              (while (binop || (binop == (ident first) (number 1)) (call (ident parse_match) (ident TOKEN_COMMA)))
                (block
                  (assign (ident first) (number 0))
                  (var param_type (type_ptr (type_base u8)) (call (ident parse_type)))
                  (expr_stmt (call (ident vec_push) (ident params) (ident param_type)))))))
          (expr_stmt (call (ident parse_expect) (ident TOKEN_RPAREN) (string "expected ')' after parameter types")))
          (var ret (type_ptr (type_base u8)) (call (ident parse_type)))
          (var t (type_ptr (type_base u8)) (call (ident closure_type_alloc)))
          (expr_stmt (call (ident closure_type_set_params) (ident t) (ident params)))
          (expr_stmt (call (ident closure_type_set_param_count) (ident t) (call (ident vec_len) (ident params))))
          (expr_stmt (call (ident closure_type_set_ret) (ident t) (ident ret)))
          (return (ident t))))
      (var tok (type_ptr (type_base u8)) (call (ident parse_advance)))
      (var tt (type_base i64) (call (ident tok_type) (ident tok)))
      (if (binop || (binop || (binop || (binop || (binop || (binop || (binop || (binop || (binop || (binop || (binop == (ident tt) (ident TOKEN_I8)) (binop == (ident tt) (ident TOKEN_I16))) (binop == (ident tt) (ident TOKEN_I32))) (binop == (ident tt) (ident TOKEN_I64))) (binop == (ident tt) (ident TOKEN_U8))) (binop == (ident tt) (ident TOKEN_U16))) (binop == (ident tt) (ident TOKEN_U32))) (binop == (ident tt) (ident TOKEN_U64))) (binop == (ident tt) (ident TOKEN_BOOL))) (binop == (ident tt) (ident TOKEN_VOID))) (binop == (ident tt) (ident TOKEN_IDENT)))
        (block
          (var t (type_ptr (type_base u8)) (call (ident base_type_alloc)))
          (expr_stmt (call (ident base_type_set_name) (ident t) (call (ident tok_lexeme) (ident tok))))
          (expr_stmt (call (ident base_type_set_name_len) (ident t) (call (ident tok_lexeme_len) (ident tok))))
          (return (ident t))))
      (expr_stmt (call (ident parse_error) (string "expected type")))
      (var t (type_ptr (type_base u8)) (call (ident base_type_alloc)))
      (expr_stmt (call (ident base_type_set_name) (ident t) (string "error")))
      (expr_stmt (call (ident base_type_set_name_len) (ident t) (number 5)))
      (return (ident t))))
  (func parse_expression () (type_ptr (type_base u8))
    (block
      (return (call (ident parse_assignment)))))
  (func parse_assignment () (type_ptr (type_base u8))
    (block
      (var expr (type_ptr (type_base u8)) (call (ident parse_or)))
      (if (call (ident parse_match) (ident TOKEN_EQ))
        (block
          (var value (type_ptr (type_base u8)) (call (ident parse_assignment)))
          (var node (type_ptr (type_base u8)) (call (ident binary_expr_alloc)))
          (expr_stmt (call (ident binary_expr_set_op) (ident node) (ident TOKEN_EQ)))
          (expr_stmt (call (ident binary_expr_set_left) (ident node) (ident expr)))
          (expr_stmt (call (ident binary_expr_set_right) (ident node) (ident value)))
          (return (ident node))))
      (var compound_op (type_base i64) (number 0))
      (if (call (ident parse_match) (ident TOKEN_PLUSEQ))
        (block
          (assign (ident compound_op) (ident TOKEN_PLUS)))
        (if (call (ident parse_match) (ident TOKEN_MINUSEQ))
          (block
            (assign (ident compound_op) (ident TOKEN_MINUS)))
          (if (call (ident parse_match) (ident TOKEN_STAREQ))
            (block
              (assign (ident compound_op) (ident TOKEN_STAR)))
            (if (call (ident parse_match) (ident TOKEN_SLASHEQ))
              (block
                (assign (ident compound_op) (ident TOKEN_SLASH)))
              (if (call (ident parse_match) (ident TOKEN_PERCENTEQ))
                (block
                  (assign (ident compound_op) (ident TOKEN_PERCENT))))))))
      (if (binop != (ident compound_op) (number 0))
        (block
          (var value (type_ptr (type_base u8)) (call (ident parse_assignment)))
          (var binop (type_ptr (type_base u8)) (call (ident binary_expr_alloc)))
          (expr_stmt (call (ident binary_expr_set_op) (ident binop) (ident compound_op)))
          (expr_stmt (call (ident binary_expr_set_left) (ident binop) (ident expr)))
          (expr_stmt (call (ident binary_expr_set_right) (ident binop) (ident value)))
          (var assign (type_ptr (type_base u8)) (call (ident binary_expr_alloc)))
          (expr_stmt (call (ident binary_expr_set_op) (ident assign) (ident TOKEN_EQ)))
          (expr_stmt (call (ident binary_expr_set_left) (ident assign) (ident expr)))
          (expr_stmt (call (ident binary_expr_set_right) (ident assign) (ident binop)))
          (return (ident assign))))
      (return (ident expr))))
  (func parse_or () (type_ptr (type_base u8))
    (block
      (var expr (type_ptr (type_base u8)) (call (ident parse_and)))
      (while (call (ident parse_match) (ident TOKEN_PIPEPIPE))
        (block
          (var right (type_ptr (type_base u8)) (call (ident parse_and)))
          (var node (type_ptr (type_base u8)) (call (ident binary_expr_alloc)))
          (expr_stmt (call (ident binary_expr_set_op) (ident node) (ident TOKEN_PIPEPIPE)))
          (expr_stmt (call (ident binary_expr_set_left) (ident node) (ident expr)))
          (expr_stmt (call (ident binary_expr_set_right) (ident node) (ident right)))
          (assign (ident expr) (ident node))))
      (return (ident expr))))
  (func parse_and () (type_ptr (type_base u8))
    (block
      (var expr (type_ptr (type_base u8)) (call (ident parse_bitor)))
      (while (call (ident parse_match) (ident TOKEN_AMPAMP))
        (block
          (var right (type_ptr (type_base u8)) (call (ident parse_bitor)))
          (var node (type_ptr (type_base u8)) (call (ident binary_expr_alloc)))
          (expr_stmt (call (ident binary_expr_set_op) (ident node) (ident TOKEN_AMPAMP)))
          (expr_stmt (call (ident binary_expr_set_left) (ident node) (ident expr)))
          (expr_stmt (call (ident binary_expr_set_right) (ident node) (ident right)))
          (assign (ident expr) (ident node))))
      (return (ident expr))))
  (func parse_bitor () (type_ptr (type_base u8))
    (block
      (var expr (type_ptr (type_base u8)) (call (ident parse_bitxor)))
      (while (call (ident parse_match) (ident TOKEN_PIPE))
        (block
          (var right (type_ptr (type_base u8)) (call (ident parse_bitxor)))
          (var node (type_ptr (type_base u8)) (call (ident binary_expr_alloc)))
          (expr_stmt (call (ident binary_expr_set_op) (ident node) (ident TOKEN_PIPE)))
          (expr_stmt (call (ident binary_expr_set_left) (ident node) (ident expr)))
          (expr_stmt (call (ident binary_expr_set_right) (ident node) (ident right)))
          (assign (ident expr) (ident node))))
      (return (ident expr))))
  (func parse_bitxor () (type_ptr (type_base u8))
    (block
      (var expr (type_ptr (type_base u8)) (call (ident parse_bitand)))
      (while (call (ident parse_match) (ident TOKEN_CARET))
        (block
          (var right (type_ptr (type_base u8)) (call (ident parse_bitand)))
          (var node (type_ptr (type_base u8)) (call (ident binary_expr_alloc)))
          (expr_stmt (call (ident binary_expr_set_op) (ident node) (ident TOKEN_CARET)))
          (expr_stmt (call (ident binary_expr_set_left) (ident node) (ident expr)))
          (expr_stmt (call (ident binary_expr_set_right) (ident node) (ident right)))
          (assign (ident expr) (ident node))))
      (return (ident expr))))
  (func parse_bitand () (type_ptr (type_base u8))
    (block
      (var expr (type_ptr (type_base u8)) (call (ident parse_equality)))
      (while (call (ident parse_match) (ident TOKEN_AMP))
        (block
          (var right (type_ptr (type_base u8)) (call (ident parse_equality)))
          (var node (type_ptr (type_base u8)) (call (ident binary_expr_alloc)))
          (expr_stmt (call (ident binary_expr_set_op) (ident node) (ident TOKEN_AMP)))
          (expr_stmt (call (ident binary_expr_set_left) (ident node) (ident expr)))
          (expr_stmt (call (ident binary_expr_set_right) (ident node) (ident right)))
          (assign (ident expr) (ident node))))
      (return (ident expr))))
  (func parse_equality () (type_ptr (type_base u8))
    (block
      (var expr (type_ptr (type_base u8)) (call (ident parse_comparison)))
      (while (binop || (call (ident parse_check) (ident TOKEN_EQEQ)) (call (ident parse_check) (ident TOKEN_BANGEQ)))
        (block
          (var op (type_base i64) (call (ident tok_type) (call (ident parse_advance))))
          (var right (type_ptr (type_base u8)) (call (ident parse_comparison)))
          (var node (type_ptr (type_base u8)) (call (ident binary_expr_alloc)))
          (expr_stmt (call (ident binary_expr_set_op) (ident node) (ident op)))
          (expr_stmt (call (ident binary_expr_set_left) (ident node) (ident expr)))
          (expr_stmt (call (ident binary_expr_set_right) (ident node) (ident right)))
          (assign (ident expr) (ident node))))
      (return (ident expr))))
  (func parse_comparison () (type_ptr (type_base u8))
    (block
      (var expr (type_ptr (type_base u8)) (call (ident parse_shift)))
      (while (binop || (binop || (binop || (call (ident parse_check) (ident TOKEN_LT)) (call (ident parse_check) (ident TOKEN_GT))) (call (ident parse_check) (ident TOKEN_LTEQ))) (call (ident parse_check) (ident TOKEN_GTEQ)))
        (block
          (var op (type_base i64) (call (ident tok_type) (call (ident parse_advance))))
          (var right (type_ptr (type_base u8)) (call (ident parse_shift)))
          (var node (type_ptr (type_base u8)) (call (ident binary_expr_alloc)))
          (expr_stmt (call (ident binary_expr_set_op) (ident node) (ident op)))
          (expr_stmt (call (ident binary_expr_set_left) (ident node) (ident expr)))
          (expr_stmt (call (ident binary_expr_set_right) (ident node) (ident right)))
          (assign (ident expr) (ident node))))
      (return (ident expr))))
  (func parse_shift () (type_ptr (type_base u8))
    (block
      (var expr (type_ptr (type_base u8)) (call (ident parse_additive)))
      (while (binop || (call (ident parse_check) (ident TOKEN_LTLT)) (call (ident parse_check) (ident TOKEN_GTGT)))
        (block
          (var op (type_base i64) (call (ident tok_type) (call (ident parse_advance))))
          (var right (type_ptr (type_base u8)) (call (ident parse_additive)))
          (var node (type_ptr (type_base u8)) (call (ident binary_expr_alloc)))
          (expr_stmt (call (ident binary_expr_set_op) (ident node) (ident op)))
          (expr_stmt (call (ident binary_expr_set_left) (ident node) (ident expr)))
          (expr_stmt (call (ident binary_expr_set_right) (ident node) (ident right)))
          (assign (ident expr) (ident node))))
      (return (ident expr))))
  (func parse_additive () (type_ptr (type_base u8))
    (block
      (var expr (type_ptr (type_base u8)) (call (ident parse_mult)))
      (while (binop || (call (ident parse_check) (ident TOKEN_PLUS)) (call (ident parse_check) (ident TOKEN_MINUS)))
        (block
          (var op (type_base i64) (call (ident tok_type) (call (ident parse_advance))))
          (var right (type_ptr (type_base u8)) (call (ident parse_mult)))
          (var node (type_ptr (type_base u8)) (call (ident binary_expr_alloc)))
          (expr_stmt (call (ident binary_expr_set_op) (ident node) (ident op)))
          (expr_stmt (call (ident binary_expr_set_left) (ident node) (ident expr)))
          (expr_stmt (call (ident binary_expr_set_right) (ident node) (ident right)))
          (assign (ident expr) (ident node))))
      (return (ident expr))))
  (func parse_mult () (type_ptr (type_base u8))
    (block
      (var expr (type_ptr (type_base u8)) (call (ident parse_unary)))
      (while (binop || (binop || (call (ident parse_check) (ident TOKEN_STAR)) (call (ident parse_check) (ident TOKEN_SLASH))) (call (ident parse_check) (ident TOKEN_PERCENT)))
        (block
          (var op (type_base i64) (call (ident tok_type) (call (ident parse_advance))))
          (var right (type_ptr (type_base u8)) (call (ident parse_unary)))
          (var node (type_ptr (type_base u8)) (call (ident binary_expr_alloc)))
          (expr_stmt (call (ident binary_expr_set_op) (ident node) (ident op)))
          (expr_stmt (call (ident binary_expr_set_left) (ident node) (ident expr)))
          (expr_stmt (call (ident binary_expr_set_right) (ident node) (ident right)))
          (assign (ident expr) (ident node))))
      (return (ident expr))))
  (func parse_unary () (type_ptr (type_base u8))
    (block
      (if (binop || (binop || (binop || (call (ident parse_check) (ident TOKEN_MINUS)) (call (ident parse_check) (ident TOKEN_BANG))) (call (ident parse_check) (ident TOKEN_STAR))) (call (ident parse_check) (ident TOKEN_AMP)))
        (block
          (var op (type_base i64) (call (ident tok_type) (call (ident parse_advance))))
          (var expr (type_ptr (type_base u8)) (call (ident parse_unary)))
          (var node (type_ptr (type_base u8)) (call (ident unary_expr_alloc)))
          (expr_stmt (call (ident unary_expr_set_op) (ident node) (ident op)))
          (expr_stmt (call (ident unary_expr_set_expr) (ident node) (ident expr)))
          (return (ident node))))
      (return (call (ident parse_postfix)))))
  (func parse_postfix () (type_ptr (type_base u8))
    (block
      (var expr (type_ptr (type_base u8)) (call (ident parse_primary)))
      (var done (type_base i64) (number 0))
      (while (binop == (ident done) (number 0))
        (block
          (if (call (ident parse_match) (ident TOKEN_LPAREN))
            (block
              (assign (ident expr) (call (ident parse_finish_call) (ident expr))))
            (if (call (ident parse_match) (ident TOKEN_LBRACKET))
              (block
                (var index (type_ptr (type_base u8)) (call (ident parse_expression)))
                (expr_stmt (call (ident parse_expect) (ident TOKEN_RBRACKET) (string "expected ']' after index")))
                (var node (type_ptr (type_base u8)) (call (ident alloc) (number 24)))
                (expr_stmt (call (ident node_set_kind) (ident node) (ident NODE_INDEX_EXPR)))
                (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
                (assign (unop * (ident p)) (ident expr))
                (assign (ident p) (binop + (ident node) (number 16)))
                (assign (unop * (ident p)) (ident index))
                (assign (ident expr) (ident node)))
              (if (call (ident parse_match) (ident TOKEN_DOT))
                (block
                  (var name_tok (type_ptr (type_base u8)) (call (ident parse_expect) (ident TOKEN_IDENT) (string "expected field name")))
                  (var node (type_ptr (type_base u8)) (call (ident alloc) (number 32)))
                  (expr_stmt (call (ident node_set_kind) (ident node) (ident NODE_FIELD_EXPR)))
                  (var pe (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
                  (assign (unop * (ident pe)) (ident expr))
                  (var pn (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 16)))
                  (assign (unop * (ident pn)) (call (ident tok_lexeme) (ident name_tok)))
                  (var pl (type_ptr (type_base i64)) (binop + (ident node) (number 24)))
                  (assign (unop * (ident pl)) (call (ident tok_lexeme_len) (ident name_tok)))
                  (assign (ident expr) (ident node)))
                (block
                  (assign (ident done) (number 1))))))))
      (return (ident expr))))
  (func parse_finish_call ((param callee (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var args (type_ptr (type_base u8)) (call (ident alloc) (binop * (ident LIMIT_CALL_ARGS) (number 8))))
      (var arg_count (type_base i64) (number 0))
      (if (unop ! (call (ident parse_check) (ident TOKEN_RPAREN)))
        (block
          (var done (type_base i64) (number 0))
          (while (binop == (ident done) (number 0))
            (block
              (var arg (type_ptr (type_base u8)) (call (ident parse_expression)))
              (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident args) (binop * (ident arg_count) (number 8))))
              (assign (unop * (ident p)) (ident arg))
              (assign (ident arg_count) (binop + (ident arg_count) (number 1)))
              (if (unop ! (call (ident parse_match) (ident TOKEN_COMMA)))
                (block
                  (assign (ident done) (number 1))))))))
      (expr_stmt (call (ident parse_expect) (ident TOKEN_RPAREN) (string "expected ')' after arguments")))
      (var node (type_ptr (type_base u8)) (call (ident call_expr_alloc)))
      (expr_stmt (call (ident call_expr_set_func) (ident node) (ident callee)))
      (expr_stmt (call (ident call_expr_set_args) (ident node) (ident args)))
      (expr_stmt (call (ident call_expr_set_arg_count) (ident node) (ident arg_count)))
      (return (ident node))))
  (func parse_pattern () (type_ptr (type_base u8))
    (block
      (if (call (ident parse_check) (ident TOKEN_IDENT))
        (block
          (var tok (type_ptr (type_base u8)) (call (ident parse_peek)))
          (var name (type_ptr (type_base u8)) (call (ident tok_lexeme) (ident tok)))
          (var len (type_base i64) (call (ident tok_lexeme_len) (ident tok)))
          (if (binop && (binop == (ident len) (number 1)) (binop == (unop * (ident name)) (number 95)))
            (block
              (expr_stmt (call (ident parse_advance)))
              (return (call (ident pattern_wildcard_alloc)))))))
      (var enum_tok (type_ptr (type_base u8)) (call (ident parse_expect) (ident TOKEN_IDENT) (string "expected pattern")))
      (expr_stmt (call (ident parse_expect) (ident TOKEN_DOT) (string "expected '.' after enum name in pattern")))
      (var variant_tok (type_ptr (type_base u8)) (call (ident parse_expect) (ident TOKEN_IDENT) (string "expected variant name after '.'")))
      (var node (type_ptr (type_base u8)) (call (ident pattern_variant_alloc)))
      (expr_stmt (call (ident pattern_variant_set_enum_name) (ident node) (call (ident tok_lexeme) (ident enum_tok))))
      (expr_stmt (call (ident pattern_variant_set_enum_len) (ident node) (call (ident tok_lexeme_len) (ident enum_tok))))
      (expr_stmt (call (ident pattern_variant_set_name) (ident node) (call (ident tok_lexeme) (ident variant_tok))))
      (expr_stmt (call (ident pattern_variant_set_name_len) (ident node) (call (ident tok_lexeme_len) (ident variant_tok))))
      (if (call (ident parse_match) (ident TOKEN_LPAREN))
        (block
          (var binding_tok (type_ptr (type_base u8)) (call (ident parse_expect) (ident TOKEN_IDENT) (string "expected binding name")))
          (expr_stmt (call (ident pattern_variant_set_binding) (ident node) (call (ident tok_lexeme) (ident binding_tok))))
          (expr_stmt (call (ident pattern_variant_set_binding_len) (ident node) (call (ident tok_lexeme_len) (ident binding_tok))))
          (expr_stmt (call (ident parse_expect) (ident TOKEN_RPAREN) (string "expected ')' after binding"))))
        (block
          (expr_stmt (call (ident pattern_variant_set_binding) (ident node) (nil)))
          (expr_stmt (call (ident pattern_variant_set_binding_len) (ident node) (number 0)))))
      (return (ident node))))
  (func parse_primary () (type_ptr (type_base u8))
    (block
      (if (call (ident parse_match) (ident TOKEN_NUMBER))
        (block
          (var tok (type_ptr (type_base u8)) (call (ident parse_previous)))
          (var node (type_ptr (type_base u8)) (call (ident number_expr_alloc)))
          (expr_stmt (call (ident number_expr_set_value) (ident node) (call (ident tok_lexeme) (ident tok))))
          (expr_stmt (call (ident number_expr_set_value_len) (ident node) (call (ident tok_lexeme_len) (ident tok))))
          (return (ident node))))
      (if (call (ident parse_match) (ident TOKEN_STRING))
        (block
          (var tok (type_ptr (type_base u8)) (call (ident parse_previous)))
          (var node (type_ptr (type_base u8)) (call (ident string_expr_alloc)))
          (var raw (type_ptr (type_base u8)) (call (ident parse_string_literal) (call (ident tok_lexeme) (ident tok)) (call (ident tok_lexeme_len) (ident tok))))
          (var raw_len (type_base i64) (call (ident parse_string_literal_len) (call (ident tok_lexeme) (ident tok)) (call (ident tok_lexeme_len) (ident tok))))
          (expr_stmt (call (ident string_expr_set_value) (ident node) (ident raw)))
          (expr_stmt (call (ident string_expr_set_value_len) (ident node) (ident raw_len)))
          (return (ident node))))
      (if (call (ident parse_match) (ident TOKEN_TRUE))
        (block
          (var node (type_ptr (type_base u8)) (call (ident bool_expr_alloc)))
          (expr_stmt (call (ident bool_expr_set_value) (ident node) (number 1)))
          (return (ident node))))
      (if (call (ident parse_match) (ident TOKEN_FALSE))
        (block
          (var node (type_ptr (type_base u8)) (call (ident bool_expr_alloc)))
          (expr_stmt (call (ident bool_expr_set_value) (ident node) (number 0)))
          (return (ident node))))
      (if (call (ident parse_match) (ident TOKEN_NIL))
        (block
          (return (call (ident nil_expr_alloc)))))
      (if (call (ident parse_match) (ident TOKEN_LBRACKET))
        (block
          (var elems (type_ptr (type_base u8)) (call (ident vec_new) (number 8)))
          (if (unop ! (call (ident parse_check) (ident TOKEN_RBRACKET)))
            (block
              (expr_stmt (call (ident vec_push) (ident elems) (call (ident parse_expression))))
              (while (call (ident parse_match) (ident TOKEN_COMMA))
                (block
                  (expr_stmt (call (ident vec_push) (ident elems) (call (ident parse_expression))))))))
          (expr_stmt (call (ident parse_expect) (ident TOKEN_RBRACKET) (string "expected ']' after array elements")))
          (var count (type_base i64) (call (ident vec_len) (ident elems)))
          (var elems_arr (type_ptr (type_base u8)) (call (ident alloc) (binop * (ident count) (number 8))))
          (var i (type_base i64) (number 0))
          (while (binop < (ident i) (ident count))
            (block
              (var elem_val (type_base i64) (call (ident vec_get) (ident elems) (ident i)))
              (var p (type_ptr (type_base i64)) (binop + (ident elems_arr) (binop * (ident i) (number 8))))
              (assign (unop * (ident p)) (ident elem_val))
              (assign (ident i) (binop + (ident i) (number 1)))))
          (var node (type_ptr (type_base u8)) (call (ident array_literal_alloc)))
          (expr_stmt (call (ident array_literal_set_elems) (ident node) (ident elems_arr)))
          (expr_stmt (call (ident array_literal_set_count) (ident node) (ident count)))
          (return (ident node))))
      (if (call (ident parse_match) (ident TOKEN_IDENT))
        (block
          (var tok (type_ptr (type_base u8)) (call (ident parse_previous)))
          (var node (type_ptr (type_base u8)) (call (ident ident_expr_alloc)))
          (expr_stmt (call (ident ident_expr_set_name) (ident node) (call (ident tok_lexeme) (ident tok))))
          (expr_stmt (call (ident ident_expr_set_name_len) (ident node) (call (ident tok_lexeme_len) (ident tok))))
          (return (ident node))))
      (if (call (ident parse_match) (ident TOKEN_LPAREN))
        (block
          (var expr (type_ptr (type_base u8)) (call (ident parse_expression)))
          (expr_stmt (call (ident parse_expect) (ident TOKEN_RPAREN) (string "expected ')' after expression")))
          (var node (type_ptr (type_base u8)) (call (ident group_expr_alloc)))
          (expr_stmt (call (ident group_expr_set_expr) (ident node) (ident expr)))
          (return (ident node))))
      (if (call (ident parse_match) (ident TOKEN_DOLLAR_LBRACE))
        (block
          (var expr (type_ptr (type_base u8)) (call (ident parse_expression)))
          (expr_stmt (call (ident parse_expect) (ident TOKEN_RBRACE) (string "expected '}' after quoted expression")))
          (var node (type_ptr (type_base u8)) (call (ident quote_expr_alloc)))
          (expr_stmt (call (ident quote_expr_set_expr) (ident node) (ident expr)))
          (return (ident node))))
      (if (call (ident parse_match) (ident TOKEN_DOLLAR))
        (block
          (expr_stmt (call (ident parse_expect) (ident TOKEN_IDENT) (string "expected identifier after '$'")))
          (var tok (type_ptr (type_base u8)) (call (ident parse_previous)))
          (var node (type_ptr (type_base u8)) (call (ident unquote_expr_alloc)))
          (expr_stmt (call (ident unquote_expr_set_name) (ident node) (call (ident tok_lexeme) (ident tok))))
          (expr_stmt (call (ident unquote_expr_set_name_len) (ident node) (call (ident tok_lexeme_len) (ident tok))))
          (return (ident node))))
      (if (call (ident parse_match) (ident TOKEN_DOLLAR_AT))
        (block
          (expr_stmt (call (ident parse_expect) (ident TOKEN_IDENT) (string "expected identifier after '$@'")))
          (var tok (type_ptr (type_base u8)) (call (ident parse_previous)))
          (var node (type_ptr (type_base u8)) (call (ident unquote_string_expr_alloc)))
          (expr_stmt (call (ident unquote_string_expr_set_name) (ident node) (call (ident tok_lexeme) (ident tok))))
          (expr_stmt (call (ident unquote_string_expr_set_name_len) (ident node) (call (ident tok_lexeme_len) (ident tok))))
          (return (ident node))))
      (if (call (ident parse_match) (ident TOKEN_READER_MACRO))
        (block
          (var tok (type_ptr (type_base u8)) (call (ident parse_previous)))
          (var node (type_ptr (type_base u8)) (call (ident reader_expr_alloc)))
          (expr_stmt (call (ident reader_expr_set_name) (ident node) (call (ident tok_lexeme) (ident tok))))
          (expr_stmt (call (ident reader_expr_set_name_len) (ident node) (call (ident tok_lexeme_len) (ident tok))))
          (expr_stmt (call (ident reader_expr_set_content) (ident node) (call (ident tok_content) (ident tok))))
          (expr_stmt (call (ident reader_expr_set_content_len) (ident node) (call (ident tok_content_len) (ident tok))))
          (return (ident node))))
      (if (call (ident parse_match) (ident TOKEN_LET))
        (block
          (var name_tok (type_ptr (type_base u8)) (call (ident parse_expect) (ident TOKEN_IDENT) (string "expected identifier after 'let'")))
          (var typ (type_ptr (type_base u8)) (nil))
          (if (unop ! (call (ident parse_check) (ident TOKEN_EQ)))
            (block
              (assign (ident typ) (call (ident parse_type)))))
          (expr_stmt (call (ident parse_expect) (ident TOKEN_EQ) (string "expected '=' in let expression")))
          (var init (type_ptr (type_base u8)) (call (ident parse_expression)))
          (expr_stmt (call (ident parse_expect) (ident TOKEN_IN) (string "expected 'in' after let initializer")))
          (var body (type_ptr (type_base u8)) (call (ident parse_expression)))
          (var node (type_ptr (type_base u8)) (call (ident let_expr_alloc)))
          (expr_stmt (call (ident let_expr_set_name) (ident node) (call (ident tok_lexeme) (ident name_tok))))
          (expr_stmt (call (ident let_expr_set_name_len) (ident node) (call (ident tok_lexeme_len) (ident name_tok))))
          (expr_stmt (call (ident let_expr_set_type) (ident node) (ident typ)))
          (expr_stmt (call (ident let_expr_set_init) (ident node) (ident init)))
          (expr_stmt (call (ident let_expr_set_body) (ident node) (ident body)))
          (return (ident node))))
      (if (call (ident parse_match) (ident TOKEN_FN))
        (block
          (expr_stmt (call (ident parse_expect) (ident TOKEN_LPAREN) (string "expected '(' after 'fn' in lambda")))
          (var params (type_ptr (type_base u8)) (call (ident alloc) (binop * (ident LIMIT_FUNC_PARAMS) (number 24))))
          (var param_count (type_base i64) (number 0))
          (if (unop ! (call (ident parse_check) (ident TOKEN_RPAREN)))
            (block
              (var done (type_base i64) (number 0))
              (while (binop == (ident done) (number 0))
                (block
                  (var pname_tok (type_ptr (type_base u8)) (call (ident parse_expect) (ident TOKEN_IDENT) (string "expected parameter name")))
                  (var ptype (type_ptr (type_base u8)) (call (ident parse_type)))
                  (var p (type_ptr (type_base u8)) (binop + (ident params) (binop * (ident param_count) (number 24))))
                  (expr_stmt (call (ident param_set_name) (ident p) (call (ident tok_lexeme) (ident pname_tok))))
                  (expr_stmt (call (ident param_set_name_len) (ident p) (call (ident tok_lexeme_len) (ident pname_tok))))
                  (expr_stmt (call (ident param_set_type) (ident p) (ident ptype)))
                  (assign (ident param_count) (binop + (ident param_count) (number 1)))
                  (if (unop ! (call (ident parse_match) (ident TOKEN_COMMA)))
                    (block
                      (assign (ident done) (number 1))))))))
          (expr_stmt (call (ident parse_expect) (ident TOKEN_RPAREN) (string "expected ')' after lambda parameters")))
          (var ret_type (type_ptr (type_base u8)) (nil))
          (if (unop ! (call (ident parse_check) (ident TOKEN_LBRACE)))
            (block
              (assign (ident ret_type) (call (ident parse_type)))))
          (var body (type_ptr (type_base u8)) (call (ident parse_block)))
          (var node (type_ptr (type_base u8)) (call (ident lambda_expr_alloc)))
          (expr_stmt (call (ident lambda_expr_set_params) (ident node) (ident params)))
          (expr_stmt (call (ident lambda_expr_set_param_count) (ident node) (ident param_count)))
          (expr_stmt (call (ident lambda_expr_set_ret_type) (ident node) (ident ret_type)))
          (expr_stmt (call (ident lambda_expr_set_body) (ident node) (ident body)))
          (return (ident node))))
      (if (call (ident parse_match) (ident TOKEN_MATCH))
        (block
          (var scrutinee (type_ptr (type_base u8)) (call (ident parse_expression)))
          (expr_stmt (call (ident parse_expect) (ident TOKEN_LBRACE) (string "expected '{' after match expression")))
          (var arms (type_ptr (type_base u8)) (call (ident alloc) (binop * (number 32) (number 16))))
          (var arm_count (type_base i64) (number 0))
          (while (binop && (unop ! (call (ident parse_check) (ident TOKEN_RBRACE))) (unop ! (call (ident parse_is_at_end))))
            (block
              (var pattern (type_ptr (type_base u8)) (call (ident parse_pattern)))
              (expr_stmt (call (ident parse_expect) (ident TOKEN_ARROW) (string "expected '=>' after pattern")))
              (var body (type_ptr (type_base u8)) (nil))
              (if (call (ident parse_check) (ident TOKEN_LBRACE))
                (block
                  (assign (ident body) (call (ident parse_block_expr))))
                (block
                  (assign (ident body) (call (ident parse_expression)))))
              (var arm (type_ptr (type_base u8)) (call (ident get_match_arm) (ident arms) (ident arm_count)))
              (expr_stmt (call (ident match_arm_set_pattern) (ident arm) (ident pattern)))
              (expr_stmt (call (ident match_arm_set_body) (ident arm) (ident body)))
              (assign (ident arm_count) (binop + (ident arm_count) (number 1)))
              (expr_stmt (call (ident parse_match) (ident TOKEN_COMMA)))))
          (expr_stmt (call (ident parse_expect) (ident TOKEN_RBRACE) (string "expected '}' after match arms")))
          (var node (type_ptr (type_base u8)) (call (ident match_expr_alloc)))
          (expr_stmt (call (ident match_expr_set_scrutinee) (ident node) (ident scrutinee)))
          (expr_stmt (call (ident match_expr_set_arms) (ident node) (ident arms)))
          (expr_stmt (call (ident match_expr_set_arm_count) (ident node) (ident arm_count)))
          (return (ident node))))
      (if (call (ident parse_match) (ident TOKEN_PERFORM))
        (block
          (var name_tok (type_ptr (type_base u8)) (call (ident parse_expect) (ident TOKEN_IDENT) (string "expected effect name after 'perform'")))
          (expr_stmt (call (ident parse_expect) (ident TOKEN_LPAREN) (string "expected '(' after effect name")))
          (var args (type_ptr (type_base u8)) (call (ident alloc) (binop * (number 64) (number 8))))
          (var arg_count (type_base i64) (number 0))
          (if (unop ! (call (ident parse_check) (ident TOKEN_RPAREN)))
            (block
              (var first_arg (type_ptr (type_base u8)) (call (ident parse_expression)))
              (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident args) (binop * (ident arg_count) (number 8))))
              (assign (unop * (ident p)) (ident first_arg))
              (assign (ident arg_count) (binop + (ident arg_count) (number 1)))
              (while (call (ident parse_match) (ident TOKEN_COMMA))
                (block
                  (var arg (type_ptr (type_base u8)) (call (ident parse_expression)))
                  (var pp (type_ptr (type_ptr (type_base u8))) (binop + (ident args) (binop * (ident arg_count) (number 8))))
                  (assign (unop * (ident pp)) (ident arg))
                  (assign (ident arg_count) (binop + (ident arg_count) (number 1)))))))
          (expr_stmt (call (ident parse_expect) (ident TOKEN_RPAREN) (string "expected ')' after effect arguments")))
          (var node (type_ptr (type_base u8)) (call (ident perform_expr_alloc)))
          (expr_stmt (call (ident perform_expr_set_name) (ident node) (call (ident tok_lexeme) (ident name_tok))))
          (expr_stmt (call (ident perform_expr_set_name_len) (ident node) (call (ident tok_lexeme_len) (ident name_tok))))
          (expr_stmt (call (ident perform_expr_set_args) (ident node) (ident args)))
          (expr_stmt (call (ident perform_expr_set_arg_count) (ident node) (ident arg_count)))
          (return (ident node))))
      (if (call (ident parse_match) (ident TOKEN_RESUME))
        (block
          (var k_tok (type_ptr (type_base u8)) (call (ident parse_expect) (ident TOKEN_IDENT) (string "expected continuation name after 'resume'")))
          (var k_expr (type_ptr (type_base u8)) (call (ident ident_expr_alloc)))
          (expr_stmt (call (ident ident_expr_set_name) (ident k_expr) (call (ident tok_lexeme) (ident k_tok))))
          (expr_stmt (call (ident ident_expr_set_name_len) (ident k_expr) (call (ident tok_lexeme_len) (ident k_tok))))
          (expr_stmt (call (ident parse_expect) (ident TOKEN_LPAREN) (string "expected '(' after continuation")))
          (var value (type_ptr (type_base u8)) (nil))
          (if (unop ! (call (ident parse_check) (ident TOKEN_RPAREN)))
            (block
              (assign (ident value) (call (ident parse_expression)))))
          (expr_stmt (call (ident parse_expect) (ident TOKEN_RPAREN) (string "expected ')' after resume value")))
          (var node (type_ptr (type_base u8)) (call (ident resume_expr_alloc)))
          (expr_stmt (call (ident resume_expr_set_k) (ident node) (ident k_expr)))
          (expr_stmt (call (ident resume_expr_set_value) (ident node) (ident value)))
          (return (ident node))))
      (if (call (ident parse_match) (ident TOKEN_HANDLE))
        (block
          (expr_stmt (call (ident parse_expect) (ident TOKEN_LBRACE) (string "expected '{' after 'handle'")))
          (var stmts (type_ptr (type_base u8)) (call (ident alloc) (binop * (ident LIMIT_STMTS_PER_BLOCK) (number 8))))
          (var stmt_count (type_base i64) (number 0))
          (var tail_expr (type_ptr (type_base u8)) (nil))
          (while (binop && (unop ! (call (ident parse_check) (ident TOKEN_RBRACE))) (unop ! (call (ident parse_is_at_end))))
            (block
              (if (binop || (binop || (binop || (binop || (binop || (binop || (call (ident parse_check) (ident TOKEN_VAR)) (call (ident parse_check) (ident TOKEN_IF))) (call (ident parse_check) (ident TOKEN_WHILE))) (call (ident parse_check) (ident TOKEN_RETURN))) (call (ident parse_check) (ident TOKEN_BREAK))) (call (ident parse_check) (ident TOKEN_CONTINUE))) (call (ident parse_check) (ident TOKEN_LBRACE)))
                (block
                  (var stmt (type_ptr (type_base u8)) (call (ident parse_statement)))
                  (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident stmts) (binop * (ident stmt_count) (number 8))))
                  (assign (unop * (ident p)) (ident stmt))
                  (assign (ident stmt_count) (binop + (ident stmt_count) (number 1))))
                (block
                  (var expr (type_ptr (type_base u8)) (call (ident parse_expression)))
                  (if (call (ident parse_check) (ident TOKEN_SEMICOLON))
                    (block
                      (expr_stmt (call (ident parse_advance)))
                      (var stmt (type_ptr (type_base u8)) (call (ident expr_stmt_alloc)))
                      (expr_stmt (call (ident expr_stmt_set_expr) (ident stmt) (ident expr)))
                      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident stmts) (binop * (ident stmt_count) (number 8))))
                      (assign (unop * (ident p)) (ident stmt))
                      (assign (ident stmt_count) (binop + (ident stmt_count) (number 1))))
                    (if (call (ident parse_check) (ident TOKEN_RBRACE))
                      (block
                        (assign (ident tail_expr) (ident expr)))
                      (if (call (ident parse_check) (ident TOKEN_EQ))
                        (block
                          (expr_stmt (call (ident parse_advance)))
                          (var val (type_ptr (type_base u8)) (call (ident parse_expression)))
                          (expr_stmt (call (ident parse_expect) (ident TOKEN_SEMICOLON) (string "expected ';' after assignment")))
                          (var stmt (type_ptr (type_base u8)) (call (ident assign_stmt_alloc)))
                          (expr_stmt (call (ident assign_stmt_set_target) (ident stmt) (ident expr)))
                          (expr_stmt (call (ident assign_stmt_set_value) (ident stmt) (ident val)))
                          (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident stmts) (binop * (ident stmt_count) (number 8))))
                          (assign (unop * (ident p)) (ident stmt))
                          (assign (ident stmt_count) (binop + (ident stmt_count) (number 1))))
                        (block
                          (expr_stmt (call (ident parse_error) (string "expected ';' or '}' after expression in handle body")))))))))))
          (var body (type_ptr (type_base u8)) (call (ident block_expr_alloc)))
          (expr_stmt (call (ident block_expr_set_stmts) (ident body) (ident stmts)))
          (expr_stmt (call (ident block_expr_set_count) (ident body) (ident stmt_count)))
          (expr_stmt (call (ident block_expr_set_tail) (ident body) (ident tail_expr)))
          (expr_stmt (call (ident parse_expect) (ident TOKEN_RBRACE) (string "expected '}' after handle body")))
          (expr_stmt (call (ident parse_expect) (ident TOKEN_WITH) (string "expected 'with' after handle body")))
          (expr_stmt (call (ident parse_expect) (ident TOKEN_LBRACE) (string "expected '{' after 'with'")))
          (var ret_bind (type_ptr (type_base u8)) (nil))
          (var ret_bind_len (type_base i64) (number 0))
          (var ret_body (type_ptr (type_base u8)) (nil))
          (var cases (type_ptr (type_base u8)) (call (ident alloc) (binop * (number 32) (number 56))))
          (var case_count (type_base i64) (number 0))
          (while (binop && (unop ! (call (ident parse_check) (ident TOKEN_RBRACE))) (unop ! (call (ident parse_is_at_end))))
            (block
              (var case_name_tok (type_ptr (type_base u8)) (nil))
              (if (call (ident parse_match) (ident TOKEN_RETURN))
                (block
                  (assign (ident case_name_tok) (call (ident parse_previous))))
                (block
                  (assign (ident case_name_tok) (call (ident parse_expect) (ident TOKEN_IDENT) (string "expected effect name or 'return'")))))
              (expr_stmt (call (ident parse_expect) (ident TOKEN_LPAREN) (string "expected '(' after handler case name")))
              (var binding_tok (type_ptr (type_base u8)) (call (ident parse_expect) (ident TOKEN_IDENT) (string "expected binding name")))
              (var k_tok (type_ptr (type_base u8)) (nil))
              (if (call (ident parse_match) (ident TOKEN_COMMA))
                (block
                  (assign (ident k_tok) (call (ident parse_expect) (ident TOKEN_IDENT) (string "expected continuation name")))))
              (expr_stmt (call (ident parse_expect) (ident TOKEN_RPAREN) (string "expected ')' after binding")))
              (expr_stmt (call (ident parse_expect) (ident TOKEN_ARROW) (string "expected '=>' after pattern")))
              (var case_body (type_ptr (type_base u8)) (nil))
              (if (call (ident parse_check) (ident TOKEN_LBRACE))
                (block
                  (assign (ident case_body) (call (ident parse_block))))
                (block
                  (assign (ident case_body) (call (ident parse_expression)))))
              (if (call (ident buf_eq_str) (call (ident tok_lexeme) (ident case_name_tok)) (call (ident tok_lexeme_len) (ident case_name_tok)) (string "return"))
                (block
                  (assign (ident ret_bind) (call (ident tok_lexeme) (ident binding_tok)))
                  (assign (ident ret_bind_len) (call (ident tok_lexeme_len) (ident binding_tok)))
                  (assign (ident ret_body) (ident case_body)))
                (block
                  (var entry (type_ptr (type_base u8)) (binop + (ident cases) (binop * (ident case_count) (number 56))))
                  (var p1 (type_ptr (type_ptr (type_base u8))) (ident entry))
                  (assign (unop * (ident p1)) (call (ident tok_lexeme) (ident case_name_tok)))
                  (var p2 (type_ptr (type_base i64)) (binop + (ident entry) (number 8)))
                  (assign (unop * (ident p2)) (call (ident tok_lexeme_len) (ident case_name_tok)))
                  (var p3 (type_ptr (type_ptr (type_base u8))) (binop + (ident entry) (number 16)))
                  (assign (unop * (ident p3)) (call (ident tok_lexeme) (ident binding_tok)))
                  (var p4 (type_ptr (type_base i64)) (binop + (ident entry) (number 24)))
                  (assign (unop * (ident p4)) (call (ident tok_lexeme_len) (ident binding_tok)))
                  (var p5 (type_ptr (type_ptr (type_base u8))) (binop + (ident entry) (number 32)))
                  (var p6 (type_ptr (type_base i64)) (binop + (ident entry) (number 40)))
                  (if (binop != (ident k_tok) (nil))
                    (block
                      (assign (unop * (ident p5)) (call (ident tok_lexeme) (ident k_tok)))
                      (assign (unop * (ident p6)) (call (ident tok_lexeme_len) (ident k_tok))))
                    (block
                      (assign (unop * (ident p5)) (nil))
                      (assign (unop * (ident p6)) (number 0))))
                  (var p7 (type_ptr (type_ptr (type_base u8))) (binop + (ident entry) (number 48)))
                  (assign (unop * (ident p7)) (ident case_body))
                  (assign (ident case_count) (binop + (ident case_count) (number 1)))))
              (expr_stmt (call (ident parse_match) (ident TOKEN_COMMA)))))
          (expr_stmt (call (ident parse_expect) (ident TOKEN_RBRACE) (string "expected '}' after handler cases")))
          (var node (type_ptr (type_base u8)) (call (ident handle_expr_alloc)))
          (expr_stmt (call (ident handle_expr_set_body) (ident node) (ident body)))
          (expr_stmt (call (ident handle_expr_set_cases) (ident node) (ident cases)))
          (expr_stmt (call (ident handle_expr_set_case_count) (ident node) (ident case_count)))
          (expr_stmt (call (ident handle_expr_set_ret_bind) (ident node) (ident ret_bind)))
          (expr_stmt (call (ident handle_expr_set_ret_bind_len) (ident node) (ident ret_bind_len)))
          (expr_stmt (call (ident handle_expr_set_ret_body) (ident node) (ident ret_body)))
          (return (ident node))))
      (expr_stmt (call (ident parse_error) (string "expected expression")))
      (var node (type_ptr (type_base u8)) (call (ident number_expr_alloc)))
      (expr_stmt (call (ident number_expr_set_value) (ident node) (string "0")))
      (expr_stmt (call (ident number_expr_set_value_len) (ident node) (number 1)))
      (return (ident node))))
  (func parse_block () (type_ptr (type_base u8))
    (block
      (expr_stmt (call (ident parse_expect) (ident TOKEN_LBRACE) (string "expected '{'")))
      (var stmts (type_ptr (type_base u8)) (call (ident alloc) (binop * (ident LIMIT_STMTS_PER_BLOCK) (number 8))))
      (var stmt_count (type_base i64) (number 0))
      (while (binop && (unop ! (call (ident parse_check) (ident TOKEN_RBRACE))) (unop ! (call (ident parse_is_at_end))))
        (block
          (var stmt (type_ptr (type_base u8)) (call (ident parse_statement)))
          (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident stmts) (binop * (ident stmt_count) (number 8))))
          (assign (unop * (ident p)) (ident stmt))
          (assign (ident stmt_count) (binop + (ident stmt_count) (number 1)))))
      (expr_stmt (call (ident parse_expect) (ident TOKEN_RBRACE) (string "expected '}'")))
      (var node (type_ptr (type_base u8)) (call (ident block_stmt_alloc)))
      (expr_stmt (call (ident block_stmt_set_stmts) (ident node) (ident stmts)))
      (expr_stmt (call (ident block_stmt_set_count) (ident node) (ident stmt_count)))
      (return (ident node))))
  (func parse_block_expr () (type_ptr (type_base u8))
    (block
      (expr_stmt (call (ident parse_expect) (ident TOKEN_LBRACE) (string "expected '{'")))
      (var stmts (type_ptr (type_base u8)) (call (ident alloc) (binop * (ident LIMIT_STMTS_PER_BLOCK) (number 8))))
      (var stmt_count (type_base i64) (number 0))
      (var tail_expr (type_ptr (type_base u8)) (nil))
      (while (binop && (unop ! (call (ident parse_check) (ident TOKEN_RBRACE))) (unop ! (call (ident parse_is_at_end))))
        (block
          (if (binop || (binop || (binop || (binop || (binop || (binop || (call (ident parse_check) (ident TOKEN_VAR)) (call (ident parse_check) (ident TOKEN_IF))) (call (ident parse_check) (ident TOKEN_WHILE))) (call (ident parse_check) (ident TOKEN_RETURN))) (call (ident parse_check) (ident TOKEN_BREAK))) (call (ident parse_check) (ident TOKEN_CONTINUE))) (call (ident parse_check) (ident TOKEN_LBRACE)))
            (block
              (var stmt (type_ptr (type_base u8)) (call (ident parse_statement)))
              (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident stmts) (binop * (ident stmt_count) (number 8))))
              (assign (unop * (ident p)) (ident stmt))
              (assign (ident stmt_count) (binop + (ident stmt_count) (number 1))))
            (block
              (var expr (type_ptr (type_base u8)) (call (ident parse_expression)))
              (if (call (ident parse_check) (ident TOKEN_SEMICOLON))
                (block
                  (expr_stmt (call (ident parse_advance)))
                  (var stmt (type_ptr (type_base u8)) (call (ident expr_stmt_alloc)))
                  (expr_stmt (call (ident expr_stmt_set_expr) (ident stmt) (ident expr)))
                  (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident stmts) (binop * (ident stmt_count) (number 8))))
                  (assign (unop * (ident p)) (ident stmt))
                  (assign (ident stmt_count) (binop + (ident stmt_count) (number 1))))
                (if (call (ident parse_check) (ident TOKEN_RBRACE))
                  (block
                    (assign (ident tail_expr) (ident expr)))
                  (block
                    (if (call (ident parse_check) (ident TOKEN_EQ))
                      (block
                        (expr_stmt (call (ident parse_advance)))
                        (var val (type_ptr (type_base u8)) (call (ident parse_expression)))
                        (expr_stmt (call (ident parse_expect) (ident TOKEN_SEMICOLON) (string "expected ';' after assignment")))
                        (var stmt (type_ptr (type_base u8)) (call (ident assign_stmt_alloc)))
                        (expr_stmt (call (ident assign_stmt_set_target) (ident stmt) (ident expr)))
                        (expr_stmt (call (ident assign_stmt_set_value) (ident stmt) (ident val)))
                        (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident stmts) (binop * (ident stmt_count) (number 8))))
                        (assign (unop * (ident p)) (ident stmt))
                        (assign (ident stmt_count) (binop + (ident stmt_count) (number 1))))
                      (block
                        (expr_stmt (call (ident parse_error) (string "expected ';' or '}' after expression in block"))))))))))))
      (expr_stmt (call (ident parse_expect) (ident TOKEN_RBRACE) (string "expected '}'")))
      (var node (type_ptr (type_base u8)) (call (ident block_expr_alloc)))
      (expr_stmt (call (ident block_expr_set_stmts) (ident node) (ident stmts)))
      (expr_stmt (call (ident block_expr_set_count) (ident node) (ident stmt_count)))
      (expr_stmt (call (ident block_expr_set_tail) (ident node) (ident tail_expr)))
      (return (ident node))))
  (var parse_pending_label (type_ptr (type_base u8)) (nil))
  (var parse_pending_label_len (type_base i64) (number 0))
  (func parse_statement () (type_ptr (type_base u8))
    (block
      (if (call (ident parse_check) (ident TOKEN_IDENT))
        (block
          (var tok (type_ptr (type_base u8)) (call (ident parse_peek)))
          (var next (type_ptr (type_base u8)) (call (ident parse_peek_next)))
          (if (binop && (binop != (ident next) (nil)) (binop == (call (ident tok_type) (ident next)) (ident TOKEN_COLON)))
            (block
              (expr_stmt (call (ident parse_advance)))
              (expr_stmt (call (ident parse_advance)))
              (assign (ident parse_pending_label) (call (ident tok_lexeme) (ident tok)))
              (assign (ident parse_pending_label_len) (call (ident tok_lexeme_len) (ident tok)))
              (return (call (ident parse_statement)))))))
      (if (call (ident parse_match) (ident TOKEN_VAR))
        (block
          (return (call (ident parse_var_decl)))))
      (if (call (ident parse_match) (ident TOKEN_IF))
        (block
          (return (call (ident parse_if_stmt)))))
      (if (call (ident parse_match) (ident TOKEN_WHILE))
        (block
          (return (call (ident parse_while_stmt)))))
      (if (call (ident parse_match) (ident TOKEN_RETURN))
        (block
          (return (call (ident parse_return_stmt)))))
      (if (call (ident parse_match) (ident TOKEN_BREAK))
        (block
          (var node (type_ptr (type_base u8)) (call (ident break_stmt_alloc)))
          (if (call (ident parse_check) (ident TOKEN_IDENT))
            (block
              (var label_tok (type_ptr (type_base u8)) (call (ident parse_advance)))
              (expr_stmt (call (ident break_stmt_set_label) (ident node) (call (ident tok_lexeme) (ident label_tok))))
              (expr_stmt (call (ident break_stmt_set_label_len) (ident node) (call (ident tok_lexeme_len) (ident label_tok)))))
            (block
              (expr_stmt (call (ident break_stmt_set_label) (ident node) (nil)))
              (expr_stmt (call (ident break_stmt_set_label_len) (ident node) (number 0)))))
          (expr_stmt (call (ident parse_expect) (ident TOKEN_SEMICOLON) (string "expected ';' after break")))
          (return (ident node))))
      (if (call (ident parse_match) (ident TOKEN_CONTINUE))
        (block
          (var node (type_ptr (type_base u8)) (call (ident continue_stmt_alloc)))
          (if (call (ident parse_check) (ident TOKEN_IDENT))
            (block
              (var label_tok (type_ptr (type_base u8)) (call (ident parse_advance)))
              (expr_stmt (call (ident continue_stmt_set_label) (ident node) (call (ident tok_lexeme) (ident label_tok))))
              (expr_stmt (call (ident continue_stmt_set_label_len) (ident node) (call (ident tok_lexeme_len) (ident label_tok)))))
            (block
              (expr_stmt (call (ident continue_stmt_set_label) (ident node) (nil)))
              (expr_stmt (call (ident continue_stmt_set_label_len) (ident node) (number 0)))))
          (expr_stmt (call (ident parse_expect) (ident TOKEN_SEMICOLON) (string "expected ';' after continue")))
          (return (ident node))))
      (if (call (ident parse_check) (ident TOKEN_LBRACE))
        (block
          (return (call (ident parse_block)))))
      (return (call (ident parse_expr_stmt)))))
  (func parse_var_decl () (type_ptr (type_base u8))
    (block
      (var name_tok (type_ptr (type_base u8)) (call (ident parse_expect) (ident TOKEN_IDENT) (string "expected variable name")))
      (var typ (type_ptr (type_base u8)) (call (ident parse_type)))
      (var init (type_ptr (type_base u8)) (nil))
      (if (call (ident parse_match) (ident TOKEN_EQ))
        (block
          (assign (ident init) (call (ident parse_expression)))))
      (expr_stmt (call (ident parse_expect) (ident TOKEN_SEMICOLON) (string "expected ';' after variable declaration")))
      (var node (type_ptr (type_base u8)) (call (ident var_decl_alloc)))
      (expr_stmt (call (ident var_decl_set_name) (ident node) (call (ident tok_lexeme) (ident name_tok))))
      (expr_stmt (call (ident var_decl_set_name_len) (ident node) (call (ident tok_lexeme_len) (ident name_tok))))
      (expr_stmt (call (ident var_decl_set_type) (ident node) (ident typ)))
      (expr_stmt (call (ident var_decl_set_init) (ident node) (ident init)))
      (expr_stmt (call (ident var_decl_set_is_extern) (ident node) (number 0)))
      (return (ident node))))
  (func parse_extern_var_decl () (type_ptr (type_base u8))
    (block
      (var name_tok (type_ptr (type_base u8)) (call (ident parse_expect) (ident TOKEN_IDENT) (string "expected variable name")))
      (var typ (type_ptr (type_base u8)) (call (ident parse_type)))
      (expr_stmt (call (ident parse_expect) (ident TOKEN_SEMICOLON) (string "expected ';' after extern variable declaration")))
      (var node (type_ptr (type_base u8)) (call (ident var_decl_alloc)))
      (expr_stmt (call (ident var_decl_set_name) (ident node) (call (ident tok_lexeme) (ident name_tok))))
      (expr_stmt (call (ident var_decl_set_name_len) (ident node) (call (ident tok_lexeme_len) (ident name_tok))))
      (expr_stmt (call (ident var_decl_set_type) (ident node) (ident typ)))
      (expr_stmt (call (ident var_decl_set_init) (ident node) (nil)))
      (expr_stmt (call (ident var_decl_set_is_extern) (ident node) (number 1)))
      (return (ident node))))
  (func parse_if_stmt () (type_ptr (type_base u8))
    (block
      (var cond (type_ptr (type_base u8)) (call (ident parse_expression)))
      (var then (type_ptr (type_base u8)) (call (ident parse_block)))
      (var els (type_ptr (type_base u8)) (nil))
      (if (call (ident parse_match) (ident TOKEN_ELSE))
        (block
          (if (call (ident parse_check) (ident TOKEN_IF))
            (block
              (expr_stmt (call (ident parse_advance)))
              (assign (ident els) (call (ident parse_if_stmt))))
            (block
              (assign (ident els) (call (ident parse_block)))))))
      (var node (type_ptr (type_base u8)) (call (ident if_stmt_alloc)))
      (expr_stmt (call (ident if_stmt_set_cond) (ident node) (ident cond)))
      (expr_stmt (call (ident if_stmt_set_then) (ident node) (ident then)))
      (expr_stmt (call (ident if_stmt_set_else) (ident node) (ident els)))
      (return (ident node))))
  (func parse_while_stmt () (type_ptr (type_base u8))
    (block
      (var label (type_ptr (type_base u8)) (ident parse_pending_label))
      (var label_len (type_base i64) (ident parse_pending_label_len))
      (assign (ident parse_pending_label) (nil))
      (assign (ident parse_pending_label_len) (number 0))
      (var cond (type_ptr (type_base u8)) (call (ident parse_expression)))
      (var body (type_ptr (type_base u8)) (call (ident parse_block)))
      (var node (type_ptr (type_base u8)) (call (ident while_stmt_alloc)))
      (expr_stmt (call (ident while_stmt_set_cond) (ident node) (ident cond)))
      (expr_stmt (call (ident while_stmt_set_body) (ident node) (ident body)))
      (expr_stmt (call (ident while_stmt_set_label) (ident node) (ident label)))
      (expr_stmt (call (ident while_stmt_set_label_len) (ident node) (ident label_len)))
      (return (ident node))))
  (func parse_return_stmt () (type_ptr (type_base u8))
    (block
      (var value (type_ptr (type_base u8)) (nil))
      (if (unop ! (call (ident parse_check) (ident TOKEN_SEMICOLON)))
        (block
          (assign (ident value) (call (ident parse_expression)))))
      (expr_stmt (call (ident parse_expect) (ident TOKEN_SEMICOLON) (string "expected ';' after return")))
      (var node (type_ptr (type_base u8)) (call (ident return_stmt_alloc)))
      (expr_stmt (call (ident return_stmt_set_value) (ident node) (ident value)))
      (return (ident node))))
  (func parse_expr_stmt () (type_ptr (type_base u8))
    (block
      (var expr (type_ptr (type_base u8)) (call (ident parse_expression)))
      (expr_stmt (call (ident parse_expect) (ident TOKEN_SEMICOLON) (string "expected ';' after expression")))
      (if (binop == (call (ident node_kind) (ident expr)) (ident NODE_BINARY_EXPR))
        (block
          (if (binop == (call (ident binary_expr_op) (ident expr)) (ident TOKEN_EQ))
            (block
              (var node (type_ptr (type_base u8)) (call (ident assign_stmt_alloc)))
              (expr_stmt (call (ident assign_stmt_set_target) (ident node) (call (ident binary_expr_left) (ident expr))))
              (expr_stmt (call (ident assign_stmt_set_value) (ident node) (call (ident binary_expr_right) (ident expr))))
              (return (ident node))))))
      (var node (type_ptr (type_base u8)) (call (ident expr_stmt_alloc)))
      (expr_stmt (call (ident expr_stmt_set_expr) (ident node) (ident expr)))
      (return (ident node))))
  (func parse_func_decl_impl ((param is_extern (type_base i64))) (type_ptr (type_base u8))
    (block
      (var name_tok (type_ptr (type_base u8)) (call (ident parse_expect) (ident TOKEN_IDENT) (string "expected function name")))
      (expr_stmt (call (ident parse_expect) (ident TOKEN_LPAREN) (string "expected '(' after function name")))
      (var params (type_ptr (type_base u8)) (call (ident alloc) (binop * (ident LIMIT_FUNC_PARAMS) (number 24))))
      (var param_count (type_base i64) (number 0))
      (if (unop ! (call (ident parse_check) (ident TOKEN_RPAREN)))
        (block
          (var done (type_base i64) (number 0))
          (while (binop == (ident done) (number 0))
            (block
              (var pname_tok (type_ptr (type_base u8)) (call (ident parse_expect) (ident TOKEN_IDENT) (string "expected parameter name")))
              (var ptype (type_ptr (type_base u8)) (call (ident parse_type)))
              (var p (type_ptr (type_base u8)) (binop + (ident params) (binop * (ident param_count) (number 24))))
              (expr_stmt (call (ident param_set_name) (ident p) (call (ident tok_lexeme) (ident pname_tok))))
              (expr_stmt (call (ident param_set_name_len) (ident p) (call (ident tok_lexeme_len) (ident pname_tok))))
              (expr_stmt (call (ident param_set_type) (ident p) (ident ptype)))
              (assign (ident param_count) (binop + (ident param_count) (number 1)))
              (if (unop ! (call (ident parse_match) (ident TOKEN_COMMA)))
                (block
                  (assign (ident done) (number 1))))))))
      (expr_stmt (call (ident parse_expect) (ident TOKEN_RPAREN) (string "expected ')' after parameters")))
      (var ret_type (type_ptr (type_base u8)) (nil))
      (var body (type_ptr (type_base u8)) (nil))
      (if (ident is_extern)
        (block
          (if (unop ! (call (ident parse_check) (ident TOKEN_SEMICOLON)))
            (block
              (assign (ident ret_type) (call (ident parse_type)))))
          (expr_stmt (call (ident parse_expect) (ident TOKEN_SEMICOLON) (string "expected ';' after extern function declaration"))))
        (block
          (if (unop ! (call (ident parse_check) (ident TOKEN_LBRACE)))
            (block
              (assign (ident ret_type) (call (ident parse_type)))))
          (assign (ident body) (call (ident parse_block)))))
      (var node (type_ptr (type_base u8)) (call (ident func_decl_alloc)))
      (expr_stmt (call (ident func_decl_set_name) (ident node) (call (ident tok_lexeme) (ident name_tok))))
      (expr_stmt (call (ident func_decl_set_name_len) (ident node) (call (ident tok_lexeme_len) (ident name_tok))))
      (expr_stmt (call (ident func_decl_set_params) (ident node) (ident params)))
      (expr_stmt (call (ident func_decl_set_param_count) (ident node) (ident param_count)))
      (expr_stmt (call (ident func_decl_set_ret_type) (ident node) (ident ret_type)))
      (expr_stmt (call (ident func_decl_set_body) (ident node) (ident body)))
      (expr_stmt (call (ident func_decl_set_is_extern) (ident node) (ident is_extern)))
      (return (ident node))))
  (func parse_func_decl () (type_ptr (type_base u8))
    (block
      (return (call (ident parse_func_decl_impl) (number 0)))))
  (func parse_extern_func_decl () (type_ptr (type_base u8))
    (block
      (return (call (ident parse_func_decl_impl) (number 1)))))
  (func parse_struct_decl () (type_ptr (type_base u8))
    (block
      (var name_tok (type_ptr (type_base u8)) (call (ident parse_expect) (ident TOKEN_IDENT) (string "expected struct name")))
      (expr_stmt (call (ident parse_expect) (ident TOKEN_LBRACE) (string "expected '{' after struct name")))
      (var fields (type_ptr (type_base u8)) (call (ident alloc) (binop * (number 64) (number 24))))
      (var field_count (type_base i64) (number 0))
      (while (binop && (unop ! (call (ident parse_check) (ident TOKEN_RBRACE))) (unop ! (call (ident parse_is_at_end))))
        (block
          (var field_name (type_ptr (type_base u8)) (call (ident parse_expect) (ident TOKEN_IDENT) (string "expected field name")))
          (var field_type (type_ptr (type_base u8)) (call (ident parse_type)))
          (expr_stmt (call (ident parse_expect) (ident TOKEN_SEMICOLON) (string "expected ';' after field")))
          (var f (type_ptr (type_base u8)) (call (ident get_struct_field) (ident fields) (ident field_count)))
          (expr_stmt (call (ident struct_field_set_name) (ident f) (call (ident tok_lexeme) (ident field_name))))
          (expr_stmt (call (ident struct_field_set_name_len) (ident f) (call (ident tok_lexeme_len) (ident field_name))))
          (expr_stmt (call (ident struct_field_set_type) (ident f) (ident field_type)))
          (assign (ident field_count) (binop + (ident field_count) (number 1)))))
      (expr_stmt (call (ident parse_expect) (ident TOKEN_RBRACE) (string "expected '}' after struct fields")))
      (var node (type_ptr (type_base u8)) (call (ident struct_decl_alloc)))
      (expr_stmt (call (ident struct_decl_set_name) (ident node) (call (ident tok_lexeme) (ident name_tok))))
      (expr_stmt (call (ident struct_decl_set_name_len) (ident node) (call (ident tok_lexeme_len) (ident name_tok))))
      (expr_stmt (call (ident struct_decl_set_fields) (ident node) (ident fields)))
      (expr_stmt (call (ident struct_decl_set_field_count) (ident node) (ident field_count)))
      (return (ident node))))
  (func parse_enum_decl () (type_ptr (type_base u8))
    (block
      (var name_tok (type_ptr (type_base u8)) (call (ident parse_expect) (ident TOKEN_IDENT) (string "expected enum name")))
      (expr_stmt (call (ident parse_expect) (ident TOKEN_LBRACE) (string "expected '{' after enum name")))
      (var variants (type_ptr (type_base u8)) (call (ident alloc) (binop * (number 64) (number 32))))
      (var variant_count (type_base i64) (number 0))
      (while (binop && (unop ! (call (ident parse_check) (ident TOKEN_RBRACE))) (unop ! (call (ident parse_is_at_end))))
        (block
          (var vname_tok (type_ptr (type_base u8)) (call (ident parse_expect) (ident TOKEN_IDENT) (string "expected variant name")))
          (var v (type_ptr (type_base u8)) (call (ident get_enum_variant) (ident variants) (ident variant_count)))
          (expr_stmt (call (ident enum_variant_set_name) (ident v) (call (ident tok_lexeme) (ident vname_tok))))
          (expr_stmt (call (ident enum_variant_set_name_len) (ident v) (call (ident tok_lexeme_len) (ident vname_tok))))
          (expr_stmt (call (ident enum_variant_set_tag) (ident v) (ident variant_count)))
          (if (call (ident parse_match) (ident TOKEN_LPAREN))
            (block
              (var vtype (type_ptr (type_base u8)) (call (ident parse_type)))
              (expr_stmt (call (ident enum_variant_set_type) (ident v) (ident vtype)))
              (expr_stmt (call (ident parse_expect) (ident TOKEN_RPAREN) (string "expected ')' after variant type"))))
            (block
              (expr_stmt (call (ident enum_variant_set_type) (ident v) (nil)))))
          (assign (ident variant_count) (binop + (ident variant_count) (number 1)))
          (expr_stmt (call (ident parse_match) (ident TOKEN_COMMA)))))
      (expr_stmt (call (ident parse_expect) (ident TOKEN_RBRACE) (string "expected '}' after enum variants")))
      (var node (type_ptr (type_base u8)) (call (ident enum_decl_alloc)))
      (expr_stmt (call (ident enum_decl_set_name) (ident node) (call (ident tok_lexeme) (ident name_tok))))
      (expr_stmt (call (ident enum_decl_set_name_len) (ident node) (call (ident tok_lexeme_len) (ident name_tok))))
      (expr_stmt (call (ident enum_decl_set_variants) (ident node) (ident variants)))
      (expr_stmt (call (ident enum_decl_set_variant_count) (ident node) (ident variant_count)))
      (return (ident node))))
  (func parse_effect_decl () (type_ptr (type_base u8))
    (block
      (var name_tok (type_ptr (type_base u8)) (call (ident parse_expect) (ident TOKEN_IDENT) (string "expected effect name")))
      (expr_stmt (call (ident parse_expect) (ident TOKEN_LPAREN) (string "expected '(' after effect name")))
      (var param_types (type_ptr (type_base u8)) (call (ident alloc) (binop * (number 64) (number 8))))
      (var param_type_count (type_base i64) (number 0))
      (if (unop ! (call (ident parse_check) (ident TOKEN_RPAREN)))
        (block
          (var first_type (type_ptr (type_base u8)) (call (ident parse_type)))
          (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident param_types) (binop * (ident param_type_count) (number 8))))
          (assign (unop * (ident p)) (ident first_type))
          (assign (ident param_type_count) (binop + (ident param_type_count) (number 1)))
          (while (call (ident parse_match) (ident TOKEN_COMMA))
            (block
              (var ptype (type_ptr (type_base u8)) (call (ident parse_type)))
              (var pp (type_ptr (type_ptr (type_base u8))) (binop + (ident param_types) (binop * (ident param_type_count) (number 8))))
              (assign (unop * (ident pp)) (ident ptype))
              (assign (ident param_type_count) (binop + (ident param_type_count) (number 1)))))))
      (expr_stmt (call (ident parse_expect) (ident TOKEN_RPAREN) (string "expected ')' after effect parameters")))
      (var ret_type (type_ptr (type_base u8)) (call (ident parse_type)))
      (var node (type_ptr (type_base u8)) (call (ident effect_decl_alloc)))
      (expr_stmt (call (ident effect_decl_set_name) (ident node) (call (ident tok_lexeme) (ident name_tok))))
      (expr_stmt (call (ident effect_decl_set_name_len) (ident node) (call (ident tok_lexeme_len) (ident name_tok))))
      (expr_stmt (call (ident effect_decl_set_param_types) (ident node) (ident param_types)))
      (expr_stmt (call (ident effect_decl_set_param_type_count) (ident node) (ident param_type_count)))
      (expr_stmt (call (ident effect_decl_set_return_type) (ident node) (ident ret_type)))
      (return (ident node))))
  (func parse_macro_decl () (type_ptr (type_base u8))
    (block
      (var name_tok (type_ptr (type_base u8)) (call (ident parse_expect) (ident TOKEN_IDENT) (string "expected macro name")))
      (expr_stmt (call (ident parse_expect) (ident TOKEN_LPAREN) (string "expected '(' after macro name")))
      (var params (type_ptr (type_base u8)) (call (ident alloc) (binop * (ident LIMIT_FUNC_PARAMS) (number 24))))
      (var param_count (type_base i64) (number 0))
      (if (unop ! (call (ident parse_check) (ident TOKEN_RPAREN)))
        (block
          (var done (type_base i64) (number 0))
          (while (binop == (ident done) (number 0))
            (block
              (var pname_tok (type_ptr (type_base u8)) (call (ident parse_expect) (ident TOKEN_IDENT) (string "expected parameter name")))
              (var p (type_ptr (type_base u8)) (binop + (ident params) (binop * (ident param_count) (number 24))))
              (expr_stmt (call (ident param_set_name) (ident p) (call (ident tok_lexeme) (ident pname_tok))))
              (expr_stmt (call (ident param_set_name_len) (ident p) (call (ident tok_lexeme_len) (ident pname_tok))))
              (expr_stmt (call (ident param_set_type) (ident p) (nil)))
              (assign (ident param_count) (binop + (ident param_count) (number 1)))
              (if (unop ! (call (ident parse_match) (ident TOKEN_COMMA)))
                (block
                  (assign (ident done) (number 1))))))))
      (expr_stmt (call (ident parse_expect) (ident TOKEN_RPAREN) (string "expected ')' after macro parameters")))
      (var body (type_ptr (type_base u8)) (call (ident parse_block)))
      (var node (type_ptr (type_base u8)) (call (ident macro_decl_alloc)))
      (expr_stmt (call (ident macro_decl_set_name) (ident node) (call (ident tok_lexeme) (ident name_tok))))
      (expr_stmt (call (ident macro_decl_set_name_len) (ident node) (call (ident tok_lexeme_len) (ident name_tok))))
      (expr_stmt (call (ident macro_decl_set_params) (ident node) (ident params)))
      (expr_stmt (call (ident macro_decl_set_param_count) (ident node) (ident param_count)))
      (expr_stmt (call (ident macro_decl_set_body) (ident node) (ident body)))
      (return (ident node))))
  (func parse_import () (type_ptr (type_base u8))
    (block
      (var path_tok (type_ptr (type_base u8)) (call (ident parse_expect) (ident TOKEN_STRING) (string "expected string after 'import'")))
      (expr_stmt (call (ident parse_expect) (ident TOKEN_SEMICOLON) (string "expected ';' after import path")))
      (var node (type_ptr (type_base u8)) (call (ident import_decl_alloc)))
      (expr_stmt (call (ident import_decl_set_path) (ident node) (binop + (call (ident tok_lexeme) (ident path_tok)) (number 1))))
      (expr_stmt (call (ident import_decl_set_path_len) (ident node) (binop - (call (ident tok_lexeme_len) (ident path_tok)) (number 2))))
      (return (ident node))))
  (func parse_reader_decl () (type_ptr (type_base u8))
    (block
      (var name_tok (type_ptr (type_base u8)) (call (ident parse_expect) (ident TOKEN_IDENT) (string "expected reader name")))
      (expr_stmt (call (ident parse_expect) (ident TOKEN_LPAREN) (string "expected '(' after reader name")))
      (var param_tok (type_ptr (type_base u8)) (call (ident parse_expect) (ident TOKEN_IDENT) (string "expected parameter name")))
      (expr_stmt (call (ident parse_type)))
      (expr_stmt (call (ident parse_expect) (ident TOKEN_RPAREN) (string "expected ')' after reader parameter")))
      (expr_stmt (call (ident parse_type)))
      (var body (type_ptr (type_base u8)) (call (ident parse_block)))
      (var node (type_ptr (type_base u8)) (call (ident reader_decl_alloc)))
      (expr_stmt (call (ident reader_decl_set_name) (ident node) (call (ident tok_lexeme) (ident name_tok))))
      (expr_stmt (call (ident reader_decl_set_name_len) (ident node) (call (ident tok_lexeme_len) (ident name_tok))))
      (expr_stmt (call (ident reader_decl_set_param_name) (ident node) (call (ident tok_lexeme) (ident param_tok))))
      (expr_stmt (call (ident reader_decl_set_param_len) (ident node) (call (ident tok_lexeme_len) (ident param_tok))))
      (expr_stmt (call (ident reader_decl_set_body) (ident node) (ident body)))
      (return (ident node))))
  (func parse_include () (type_ptr (type_base u8))
    (block
      (if (unop ! (call (ident parse_match) (ident TOKEN_STRING)))
        (block
          (expr_stmt (call (ident parse_error) (string "expected string path after include")))
          (return (nil))))
      (var path_tok (type_ptr (type_base u8)) (call (ident parse_previous)))
      (var path (type_ptr (type_base u8)) (call (ident tok_lexeme) (ident path_tok)))
      (var path_len (type_base i64) (call (ident tok_lexeme_len) (ident path_tok)))
      (assign (ident path) (binop + (ident path) (number 1)))
      (assign (ident path_len) (binop - (ident path_len) (number 2)))
      (var node (type_ptr (type_base u8)) (call (ident include_decl_alloc)))
      (expr_stmt (call (ident include_decl_set_path) (ident node) (ident path)))
      (expr_stmt (call (ident include_decl_set_path_len) (ident node) (ident path_len)))
      (return (ident node))))
  (func parse_require () (type_ptr (type_base u8))
    (block
      (if (unop ! (call (ident parse_match) (ident TOKEN_STRING)))
        (block
          (expr_stmt (call (ident parse_error) (string "expected string module path after require")))
          (return (nil))))
      (var module_tok (type_ptr (type_base u8)) (call (ident parse_previous)))
      (var module (type_ptr (type_base u8)) (call (ident tok_lexeme) (ident module_tok)))
      (var module_len (type_base i64) (call (ident tok_lexeme_len) (ident module_tok)))
      (assign (ident module) (binop + (ident module) (number 1)))
      (assign (ident module_len) (binop - (ident module_len) (number 2)))
      (var node (type_ptr (type_base u8)) (call (ident require_decl_alloc)))
      (expr_stmt (call (ident require_decl_set_module) (ident node) (ident module)))
      (expr_stmt (call (ident require_decl_set_module_len) (ident node) (ident module_len)))
      (return (ident node))))
  (func parse_declaration () (type_ptr (type_base u8))
    (block
      (var is_pub (type_base i64) (number 0))
      (if (call (ident parse_match) (ident TOKEN_PUB))
        (block
          (assign (ident is_pub) (number 1))))
      (if (call (ident parse_match) (ident TOKEN_EXTERN))
        (block
          (if (call (ident parse_match) (ident TOKEN_FUNC))
            (block
              (var node (type_ptr (type_base u8)) (call (ident parse_extern_func_decl)))
              (if (binop != (ident node) (nil))
                (block
                  (expr_stmt (call (ident func_decl_set_is_pub) (ident node) (ident is_pub)))))
              (return (ident node))))
          (if (call (ident parse_match) (ident TOKEN_VAR))
            (block
              (var node (type_ptr (type_base u8)) (call (ident parse_extern_var_decl)))
              (if (binop != (ident node) (nil))
                (block
                  (expr_stmt (call (ident var_decl_set_is_pub) (ident node) (ident is_pub)))))
              (return (ident node))))
          (expr_stmt (call (ident parse_error) (string "expected 'func' or 'var' after 'extern'")))
          (return (nil))))
      (if (call (ident parse_match) (ident TOKEN_FUNC))
        (block
          (var node (type_ptr (type_base u8)) (call (ident parse_func_decl)))
          (if (binop != (ident node) (nil))
            (block
              (expr_stmt (call (ident func_decl_set_is_pub) (ident node) (ident is_pub)))))
          (return (ident node))))
      (if (call (ident parse_match) (ident TOKEN_VAR))
        (block
          (var node (type_ptr (type_base u8)) (call (ident parse_var_decl)))
          (if (binop != (ident node) (nil))
            (block
              (expr_stmt (call (ident var_decl_set_is_pub) (ident node) (ident is_pub)))))
          (return (ident node))))
      (if (call (ident parse_match) (ident TOKEN_STRUCT))
        (block
          (var node (type_ptr (type_base u8)) (call (ident parse_struct_decl)))
          (if (binop != (ident node) (nil))
            (block
              (expr_stmt (call (ident struct_decl_set_is_pub) (ident node) (ident is_pub)))))
          (return (ident node))))
      (if (call (ident parse_match) (ident TOKEN_ENUM))
        (block
          (var node (type_ptr (type_base u8)) (call (ident parse_enum_decl)))
          (if (binop != (ident node) (nil))
            (block
              (expr_stmt (call (ident enum_decl_set_is_pub) (ident node) (ident is_pub)))))
          (return (ident node))))
      (if (call (ident parse_match) (ident TOKEN_EFFECT))
        (block
          (var node (type_ptr (type_base u8)) (call (ident parse_effect_decl)))
          (if (binop != (ident node) (nil))
            (block
              (expr_stmt (call (ident effect_decl_set_is_pub) (ident node) (ident is_pub)))))
          (return (ident node))))
      (if (call (ident parse_match) (ident TOKEN_MACRO))
        (block
          (if (ident is_pub)
            (block
              (expr_stmt (call (ident parse_error) (string "macros cannot have 'pub' visibility")))
              (return (nil))))
          (return (call (ident parse_macro_decl)))))
      (if (call (ident parse_match) (ident TOKEN_IMPORT))
        (block
          (if (ident is_pub)
            (block
              (expr_stmt (call (ident parse_error) (string "import cannot have 'pub' visibility")))
              (return (nil))))
          (return (call (ident parse_import)))))
      (if (call (ident parse_match) (ident TOKEN_READER))
        (block
          (var node (type_ptr (type_base u8)) (call (ident parse_reader_decl)))
          (if (binop != (ident node) (nil))
            (block
              (expr_stmt (call (ident reader_decl_set_is_pub) (ident node) (ident is_pub)))))
          (return (ident node))))
      (if (call (ident parse_match) (ident TOKEN_INCLUDE))
        (block
          (if (ident is_pub)
            (block
              (expr_stmt (call (ident parse_error) (string "include cannot have 'pub' visibility")))
              (return (nil))))
          (return (call (ident parse_include)))))
      (if (call (ident parse_match) (ident TOKEN_REQUIRE))
        (block
          (if (ident is_pub)
            (block
              (expr_stmt (call (ident parse_error) (string "require cannot have 'pub' visibility")))
              (return (nil))))
          (return (call (ident parse_require)))))
      (if (call (ident parse_match) (ident TOKEN_READER_MACRO))
        (block
          (if (ident is_pub)
            (block
              (expr_stmt (call (ident parse_error) (string "reader macro invocation cannot have 'pub' visibility")))
              (return (nil))))
          (var tok (type_ptr (type_base u8)) (call (ident parse_previous)))
          (var node (type_ptr (type_base u8)) (call (ident reader_expr_alloc)))
          (expr_stmt (call (ident reader_expr_set_name) (ident node) (call (ident tok_lexeme) (ident tok))))
          (expr_stmt (call (ident reader_expr_set_name_len) (ident node) (call (ident tok_lexeme_len) (ident tok))))
          (expr_stmt (call (ident reader_expr_set_content) (ident node) (call (ident tok_content) (ident tok))))
          (expr_stmt (call (ident reader_expr_set_content_len) (ident node) (call (ident tok_content_len) (ident tok))))
          (return (ident node))))
      (if (ident is_pub)
        (block
          (expr_stmt (call (ident parse_error) (string "expected declaration after 'pub'")))
          (return (nil))))
      (if (call (ident parse_check) (ident TOKEN_SEMICOLON))
        (block
          (expr_stmt (call (ident parse_error) (string "unexpected ';' - lang doesn't use semicolons after include/import")))
          (expr_stmt (call (ident parse_advance)))
          (return (nil))))
      (expr_stmt (call (ident parse_error) (string "expected declaration")))
      (expr_stmt (call (ident parse_advance)))
      (return (nil))))
  (func parse_program () (type_ptr (type_base u8))
    (block
      (var decls (type_ptr (type_base u8)) (call (ident alloc) (binop * (ident LIMIT_TOP_DECLS) (number 8))))
      (var decl_count (type_base i64) (number 0))
      (while (unop ! (call (ident parse_is_at_end)))
        (block
          (var decl (type_ptr (type_base u8)) (call (ident parse_declaration)))
          (if (binop != (ident decl) (nil))
            (block
              (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident decls) (binop * (ident decl_count) (number 8))))
              (assign (unop * (ident p)) (ident decl))
              (assign (ident decl_count) (binop + (ident decl_count) (number 1)))))))
      (var prog (type_ptr (type_base u8)) (call (ident alloc) (number 16)))
      (var pd (type_ptr (type_ptr (type_base u8))) (ident prog))
      (assign (unop * (ident pd)) (ident decls))
      (var pc (type_ptr (type_base i64)) (binop + (ident prog) (number 8)))
      (assign (unop * (ident pc)) (ident decl_count))
      (return (ident prog))))
  (func program_decls ((param prog (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (ident prog))
      (return (unop * (ident p)))))
  (func program_decl_count ((param prog (type_ptr (type_base u8)))) (type_base i64)
    (block
      (var p (type_ptr (type_base i64)) (binop + (ident prog) (number 8)))
      (return (unop * (ident p)))))
  (func get_decl ((param decls (type_ptr (type_base u8))) (param index (type_base i64))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident decls) (binop * (ident index) (number 8))))
      (return (unop * (ident p)))))
  (func parse_expression_from_string ((param source (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var saved_tokens (type_ptr (type_base u8)) (ident parse_tokens))
      (var saved_current (type_base i64) (ident parse_current))
      (var saved_errors (type_base i64) (ident parse_error_count))
      (assign (ident parse_tokens) (call (ident vec_new) (number 8)))
      (assign (ident parse_current) (number 0))
      (assign (ident parse_error_count) (number 0))
      (expr_stmt (call (ident parser_tokenize) (ident source)))
      (var expr (type_ptr (type_base u8)) (nil))
      (if (binop > (call (ident parser_token_count)) (number 0))
        (block
          (assign (ident expr) (call (ident parse_expression)))))
      (expr_stmt (call (ident vec_free) (ident parse_tokens)))
      (assign (ident parse_tokens) (ident saved_tokens))
      (assign (ident parse_current) (ident saved_current))
      (assign (ident parse_error_count) (ident saved_errors))
      (return (ident expr))))
  (func parse_program_from_string ((param source (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (var saved_tokens (type_ptr (type_base u8)) (ident parse_tokens))
      (var saved_current (type_base i64) (ident parse_current))
      (var saved_errors (type_base i64) (ident parse_error_count))
      (assign (ident parse_tokens) (call (ident vec_new) (number 8)))
      (assign (ident parse_current) (number 0))
      (assign (ident parse_error_count) (number 0))
      (expr_stmt (call (ident parser_tokenize) (ident source)))
      (var prog (type_ptr (type_base u8)) (nil))
      (if (binop > (call (ident parser_token_count)) (number 0))
        (block
          (assign (ident prog) (call (ident parse_program)))))
      (expr_stmt (call (ident vec_free) (ident parse_tokens)))
      (assign (ident parse_tokens) (ident saved_tokens))
      (assign (ident parse_current) (ident saved_current))
      (assign (ident parse_error_count) (ident saved_errors))
      (return (ident prog))))
  (func get_param ((param params (type_ptr (type_base u8))) (param index (type_base i64))) (type_ptr (type_base u8))
    (block
      (return (binop + (ident params) (binop * (ident index) (number 24))))))
  (func get_stmt ((param stmts (type_ptr (type_base u8))) (param index (type_base i64))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident stmts) (binop * (ident index) (number 8))))
      (return (unop * (ident p)))))
  (func get_ptr_at ((param arr (type_ptr (type_base u8))) (param index (type_base i64))) (type_ptr (type_base u8))
    (block
      (var p (type_ptr (type_ptr (type_base u8))) (binop + (ident arr) (binop * (ident index) (number 8))))
      (return (unop * (ident p)))))
  (func get_effect_case ((param cases (type_ptr (type_base u8))) (param index (type_base i64))) (type_ptr (type_base u8))
    (block
      (return (binop + (ident cases) (binop * (ident index) (number 56))))))
  (var ast_emit_buf (type_ptr (type_base u8)) (nil))
  (var ast_emit_len (type_base i64) (number 0))
  (var ast_emit_cap (type_base i64) (number 0))
  (var ast_emit_indent (type_base i64) (number 0))
  (func ast_emit_init () (type_base void)
    (block
      (assign (ident ast_emit_cap) (ident SIZE_AST_EMIT))
      (assign (ident ast_emit_buf) (call (ident alloc) (ident ast_emit_cap)))
      (assign (ident ast_emit_len) (number 0))
      (assign (ident ast_emit_indent) (number 0))))
  (func ast_emit_char ((param c (type_base u8))) (type_base void)
    (block
      (if (binop < (ident ast_emit_len) (binop - (ident ast_emit_cap) (number 1)))
        (block
          (assign (unop * (binop + (ident ast_emit_buf) (ident ast_emit_len))) (ident c))
          (assign (ident ast_emit_len) (binop + (ident ast_emit_len) (number 1)))))))
  (func ast_emit_str ((param s (type_ptr (type_base u8)))) (type_base void)
    (block
      (while (binop != (unop * (ident s)) (number 0))
        (block
          (expr_stmt (call (ident ast_emit_char) (unop * (ident s))))
          (assign (ident s) (binop + (ident s) (number 1)))))))
  (func ast_emit_strn ((param s (type_ptr (type_base u8))) (param len (type_base i64))) (type_base void)
    (block
      (var i (type_base i64) (number 0))
      (while (binop < (ident i) (ident len))
        (block
          (expr_stmt (call (ident ast_emit_char) (unop * (binop + (ident s) (ident i)))))
          (assign (ident i) (binop + (ident i) (number 1)))))))
  (func ast_emit_int ((param n (type_base i64))) (type_base void)
    (block
      (if (binop < (ident n) (number 0))
        (block
          (expr_stmt (call (ident ast_emit_char) (number 45)))
          (assign (ident n) (binop - (number 0) (ident n)))))
      (if (binop == (ident n) (number 0))
        (block
          (expr_stmt (call (ident ast_emit_char) (number 48)))
          (return)))
      (var buf (type_ptr (type_base u8)) (call (ident alloc) (number 32)))
      (var i (type_base i64) (number 0))
      (while (binop > (ident n) (number 0))
        (block
          (assign (unop * (binop + (ident buf) (ident i))) (binop + (binop % (ident n) (number 10)) (number 48)))
          (assign (ident n) (binop / (ident n) (number 10)))
          (assign (ident i) (binop + (ident i) (number 1)))))
      (while (binop > (ident i) (number 0))
        (block
          (assign (ident i) (binop - (ident i) (number 1)))
          (expr_stmt (call (ident ast_emit_char) (unop * (binop + (ident buf) (ident i)))))))))
  (func ast_emit_newline () (type_base void)
    (block
      (expr_stmt (call (ident ast_emit_char) (number 10)))
      (var i (type_base i64) (number 0))
      (while (binop < (ident i) (ident ast_emit_indent))
        (block
          (expr_stmt (call (ident ast_emit_char) (number 32)))
          (expr_stmt (call (ident ast_emit_char) (number 32)))
          (assign (ident i) (binop + (ident i) (number 1)))))))
  (func ast_emit_finish () (type_ptr (type_base u8))
    (block
      (assign (unop * (binop + (ident ast_emit_buf) (ident ast_emit_len))) (number 0))
      (return (ident ast_emit_buf))))
  (func ast_emit_quoted_string ((param s (type_ptr (type_base u8))) (param len (type_base i64))) (type_base void)
    (block
      (expr_stmt (call (ident ast_emit_char) (number 34)))
      (var i (type_base i64) (number 0))
      (while (binop < (ident i) (ident len))
        (block
          (var c (type_base u8) (unop * (binop + (ident s) (ident i))))
          (if (binop == (ident c) (number 34))
            (block
              (expr_stmt (call (ident ast_emit_char) (number 92)))
              (expr_stmt (call (ident ast_emit_char) (number 34))))
            (if (binop == (ident c) (number 92))
              (block
                (expr_stmt (call (ident ast_emit_char) (number 92)))
                (expr_stmt (call (ident ast_emit_char) (number 92))))
              (if (binop == (ident c) (number 10))
                (block
                  (expr_stmt (call (ident ast_emit_char) (number 92)))
                  (expr_stmt (call (ident ast_emit_char) (number 110))))
                (if (binop == (ident c) (number 9))
                  (block
                    (expr_stmt (call (ident ast_emit_char) (number 92)))
                    (expr_stmt (call (ident ast_emit_char) (number 116))))
                  (if (binop == (ident c) (number 13))
                    (block
                      (expr_stmt (call (ident ast_emit_char) (number 92)))
                      (expr_stmt (call (ident ast_emit_char) (number 114))))
                    (if (binop == (ident c) (number 0))
                      (block
                        (expr_stmt (call (ident ast_emit_char) (number 92)))
                        (expr_stmt (call (ident ast_emit_char) (number 48))))
                      (block
                        (expr_stmt (call (ident ast_emit_char) (ident c))))))))))
          (assign (ident i) (binop + (ident i) (number 1)))))
      (expr_stmt (call (ident ast_emit_char) (number 34)))))
  (func ast_emit_op ((param op (type_base i64))) (type_base void)
    (block
      (if (binop == (ident op) (ident TOKEN_PLUS))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "+")))
          (return)))
      (if (binop == (ident op) (ident TOKEN_MINUS))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "-")))
          (return)))
      (if (binop == (ident op) (ident TOKEN_STAR))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "*")))
          (return)))
      (if (binop == (ident op) (ident TOKEN_SLASH))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "/")))
          (return)))
      (if (binop == (ident op) (ident TOKEN_PERCENT))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "%")))
          (return)))
      (if (binop == (ident op) (ident TOKEN_AMP))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "&")))
          (return)))
      (if (binop == (ident op) (ident TOKEN_PIPE))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "|")))
          (return)))
      (if (binop == (ident op) (ident TOKEN_CARET))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "^")))
          (return)))
      (if (binop == (ident op) (ident TOKEN_LTLT))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "<<")))
          (return)))
      (if (binop == (ident op) (ident TOKEN_GTGT))
        (block
          (expr_stmt (call (ident ast_emit_str) (string ">>")))
          (return)))
      (if (binop == (ident op) (ident TOKEN_EQEQ))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "==")))
          (return)))
      (if (binop == (ident op) (ident TOKEN_BANGEQ))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "!=")))
          (return)))
      (if (binop == (ident op) (ident TOKEN_LT))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "<")))
          (return)))
      (if (binop == (ident op) (ident TOKEN_GT))
        (block
          (expr_stmt (call (ident ast_emit_str) (string ">")))
          (return)))
      (if (binop == (ident op) (ident TOKEN_LTEQ))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "<=")))
          (return)))
      (if (binop == (ident op) (ident TOKEN_GTEQ))
        (block
          (expr_stmt (call (ident ast_emit_str) (string ">=")))
          (return)))
      (if (binop == (ident op) (ident TOKEN_AMPAMP))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "&&")))
          (return)))
      (if (binop == (ident op) (ident TOKEN_PIPEPIPE))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "||")))
          (return)))
      (if (binop == (ident op) (ident TOKEN_BANG))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "!")))
          (return)))
      (if (binop == (ident op) (ident TOKEN_EQ))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "=")))
          (return)))
      (expr_stmt (call (ident ast_emit_str) (string "op")))
      (expr_stmt (call (ident ast_emit_int) (ident op)))))
  (func ast_emit_type ((param t (type_ptr (type_base u8)))) (type_base void)
    (block
      (if (binop == (ident t) (nil))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "nil")))
          (return)))
      (var kind (type_base i64) (call (ident node_kind) (ident t)))
      (if (binop == (ident kind) (ident TYPE_BASE))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "(type_base ")))
          (expr_stmt (call (ident ast_emit_strn) (call (ident base_type_name) (ident t)) (call (ident base_type_name_len) (ident t))))
          (expr_stmt (call (ident ast_emit_str) (string ")")))
          (return)))
      (if (binop == (ident kind) (ident TYPE_PTR))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "(type_ptr ")))
          (expr_stmt (call (ident ast_emit_type) (call (ident ptr_type_elem) (ident t))))
          (expr_stmt (call (ident ast_emit_str) (string ")")))
          (return)))
      (if (binop == (ident kind) (ident TYPE_FUNC))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "(type_func (")))
          (var params (type_ptr (type_base u8)) (call (ident func_type_params) (ident t)))
          (var count (type_base i64) (call (ident func_type_param_count) (ident t)))
          (var i (type_base i64) (number 0))
          (while (binop < (ident i) (ident count))
            (block
              (if (binop > (ident i) (number 0))
                (block
                  (expr_stmt (call (ident ast_emit_str) (string " ")))))
              (var param_type (type_ptr (type_base u8)) (call (ident vec_get) (ident params) (ident i)))
              (expr_stmt (call (ident ast_emit_type) (ident param_type)))
              (assign (ident i) (binop + (ident i) (number 1)))))
          (expr_stmt (call (ident ast_emit_str) (string ") ")))
          (expr_stmt (call (ident ast_emit_type) (call (ident func_type_ret) (ident t))))
          (expr_stmt (call (ident ast_emit_str) (string ")")))
          (return)))
      (if (binop == (ident kind) (ident TYPE_CLOSURE))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "(type_closure (")))
          (var params (type_ptr (type_base u8)) (call (ident closure_type_params) (ident t)))
          (var count (type_base i64) (call (ident closure_type_param_count) (ident t)))
          (var i (type_base i64) (number 0))
          (while (binop < (ident i) (ident count))
            (block
              (if (binop > (ident i) (number 0))
                (block
                  (expr_stmt (call (ident ast_emit_str) (string " ")))))
              (var param_type (type_ptr (type_base u8)) (call (ident vec_get) (ident params) (ident i)))
              (expr_stmt (call (ident ast_emit_type) (ident param_type)))
              (assign (ident i) (binop + (ident i) (number 1)))))
          (expr_stmt (call (ident ast_emit_str) (string ") ")))
          (expr_stmt (call (ident ast_emit_type) (call (ident closure_type_ret) (ident t))))
          (expr_stmt (call (ident ast_emit_str) (string ")")))
          (return)))
      (if (binop == (ident kind) (ident TYPE_ARRAY))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "(type_array ")))
          (expr_stmt (call (ident ast_emit_int) (call (ident array_type_size) (ident t))))
          (expr_stmt (call (ident ast_emit_str) (string " ")))
          (expr_stmt (call (ident ast_emit_type) (call (ident array_type_elem) (ident t))))
          (expr_stmt (call (ident ast_emit_str) (string ")")))
          (return)))
      (expr_stmt (call (ident ast_emit_str) (string "(type_unknown ")))
      (expr_stmt (call (ident ast_emit_int) (ident kind)))
      (expr_stmt (call (ident ast_emit_str) (string ")")))))
  (func ast_emit_param ((param p (type_ptr (type_base u8)))) (type_base void)
    (block
      (expr_stmt (call (ident ast_emit_str) (string "(param ")))
      (expr_stmt (call (ident ast_emit_strn) (call (ident param_name) (ident p)) (call (ident param_name_len) (ident p))))
      (expr_stmt (call (ident ast_emit_str) (string " ")))
      (expr_stmt (call (ident ast_emit_type) (call (ident param_type) (ident p))))
      (expr_stmt (call (ident ast_emit_str) (string ")")))))
  (func ast_emit_node ((param node (type_ptr (type_base u8)))) (type_base void)
    (block
      (if (binop == (ident node) (nil))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "nil")))
          (return)))
      (var kind (type_base i64) (call (ident node_kind) (ident node)))
      (if (binop == (ident kind) (ident NODE_FUNC_DECL))
        (block
          (if (call (ident func_decl_is_extern) (ident node))
            (block
              (expr_stmt (call (ident ast_emit_str) (string "(extern_func "))))
            (block
              (expr_stmt (call (ident ast_emit_str) (string "(func ")))))
          (if (call (ident func_decl_is_pub) (ident node))
            (block
              (expr_stmt (call (ident ast_emit_str) (string "pub ")))))
          (expr_stmt (call (ident ast_emit_strn) (call (ident func_decl_name) (ident node)) (call (ident func_decl_name_len) (ident node))))
          (expr_stmt (call (ident ast_emit_str) (string " (")))
          (var params (type_ptr (type_base u8)) (call (ident func_decl_params) (ident node)))
          (var count (type_base i64) (call (ident func_decl_param_count) (ident node)))
          (var i (type_base i64) (number 0))
          (while (binop < (ident i) (ident count))
            (block
              (if (binop > (ident i) (number 0))
                (block
                  (expr_stmt (call (ident ast_emit_str) (string " ")))))
              (expr_stmt (call (ident ast_emit_param) (call (ident get_param) (ident params) (ident i))))
              (assign (ident i) (binop + (ident i) (number 1)))))
          (expr_stmt (call (ident ast_emit_str) (string ") ")))
          (expr_stmt (call (ident ast_emit_type) (call (ident func_decl_ret_type) (ident node))))
          (assign (ident ast_emit_indent) (binop + (ident ast_emit_indent) (number 1)))
          (expr_stmt (call (ident ast_emit_newline)))
          (expr_stmt (call (ident ast_emit_node) (call (ident func_decl_body) (ident node))))
          (expr_stmt (call (ident ast_emit_str) (string ")")))
          (assign (ident ast_emit_indent) (binop - (ident ast_emit_indent) (number 1)))
          (return)))
      (if (binop == (ident kind) (ident NODE_VAR_DECL))
        (block
          (if (call (ident var_decl_is_extern) (ident node))
            (block
              (expr_stmt (call (ident ast_emit_str) (string "(extern_var "))))
            (block
              (expr_stmt (call (ident ast_emit_str) (string "(var ")))))
          (if (call (ident var_decl_is_pub) (ident node))
            (block
              (expr_stmt (call (ident ast_emit_str) (string "pub ")))))
          (expr_stmt (call (ident ast_emit_strn) (call (ident var_decl_name) (ident node)) (call (ident var_decl_name_len) (ident node))))
          (expr_stmt (call (ident ast_emit_str) (string " ")))
          (expr_stmt (call (ident ast_emit_type) (call (ident var_decl_type) (ident node))))
          (var init (type_ptr (type_base u8)) (call (ident var_decl_init) (ident node)))
          (if (binop != (ident init) (nil))
            (block
              (expr_stmt (call (ident ast_emit_str) (string " ")))
              (expr_stmt (call (ident ast_emit_node) (ident init)))))
          (expr_stmt (call (ident ast_emit_str) (string ")")))
          (return)))
      (if (binop == (ident kind) (ident NODE_STRUCT_DECL))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "(struct ")))
          (if (call (ident struct_decl_is_pub) (ident node))
            (block
              (expr_stmt (call (ident ast_emit_str) (string "pub ")))))
          (expr_stmt (call (ident ast_emit_strn) (call (ident struct_decl_name) (ident node)) (call (ident struct_decl_name_len) (ident node))))
          (expr_stmt (call (ident ast_emit_str) (string " (")))
          (var fields (type_ptr (type_base u8)) (call (ident struct_decl_fields) (ident node)))
          (var count (type_base i64) (call (ident struct_decl_field_count) (ident node)))
          (var i (type_base i64) (number 0))
          (while (binop < (ident i) (ident count))
            (block
              (if (binop > (ident i) (number 0))
                (block
                  (expr_stmt (call (ident ast_emit_str) (string " ")))))
              (var field (type_ptr (type_base u8)) (call (ident get_struct_field) (ident fields) (ident i)))
              (expr_stmt (call (ident ast_emit_str) (string "(field_decl ")))
              (expr_stmt (call (ident ast_emit_strn) (call (ident struct_field_name) (ident field)) (call (ident struct_field_name_len) (ident field))))
              (expr_stmt (call (ident ast_emit_str) (string " ")))
              (expr_stmt (call (ident ast_emit_type) (call (ident struct_field_type) (ident field))))
              (expr_stmt (call (ident ast_emit_str) (string ")")))
              (assign (ident i) (binop + (ident i) (number 1)))))
          (expr_stmt (call (ident ast_emit_str) (string "))")))
          (return)))
      (if (binop == (ident kind) (ident NODE_ENUM_DECL))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "(enum ")))
          (if (call (ident enum_decl_is_pub) (ident node))
            (block
              (expr_stmt (call (ident ast_emit_str) (string "pub ")))))
          (expr_stmt (call (ident ast_emit_strn) (call (ident enum_decl_name) (ident node)) (call (ident enum_decl_name_len) (ident node))))
          (expr_stmt (call (ident ast_emit_str) (string " (")))
          (var variants (type_ptr (type_base u8)) (call (ident enum_decl_variants) (ident node)))
          (var count (type_base i64) (call (ident enum_decl_variant_count) (ident node)))
          (var i (type_base i64) (number 0))
          (while (binop < (ident i) (ident count))
            (block
              (if (binop > (ident i) (number 0))
                (block
                  (expr_stmt (call (ident ast_emit_str) (string " ")))))
              (var v (type_ptr (type_base u8)) (call (ident get_enum_variant) (ident variants) (ident i)))
              (expr_stmt (call (ident ast_emit_str) (string "(variant_decl ")))
              (expr_stmt (call (ident ast_emit_strn) (call (ident enum_variant_name) (ident v)) (call (ident enum_variant_name_len) (ident v))))
              (var payload (type_ptr (type_base u8)) (call (ident enum_variant_type) (ident v)))
              (if (binop != (ident payload) (nil))
                (block
                  (expr_stmt (call (ident ast_emit_str) (string " ")))
                  (expr_stmt (call (ident ast_emit_type) (ident payload)))))
              (expr_stmt (call (ident ast_emit_str) (string ")")))
              (assign (ident i) (binop + (ident i) (number 1)))))
          (expr_stmt (call (ident ast_emit_str) (string "))")))
          (return)))
      (if (binop == (ident kind) (ident NODE_EFFECT_DECL))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "(effect ")))
          (if (call (ident effect_decl_is_pub) (ident node))
            (block
              (expr_stmt (call (ident ast_emit_str) (string "pub ")))))
          (expr_stmt (call (ident ast_emit_strn) (call (ident effect_decl_name) (ident node)) (call (ident effect_decl_name_len) (ident node))))
          (expr_stmt (call (ident ast_emit_str) (string " (")))
          (var params (type_ptr (type_base u8)) (call (ident effect_decl_param_types) (ident node)))
          (var count (type_base i64) (call (ident effect_decl_param_type_count) (ident node)))
          (var i (type_base i64) (number 0))
          (while (binop < (ident i) (ident count))
            (block
              (if (binop > (ident i) (number 0))
                (block
                  (expr_stmt (call (ident ast_emit_str) (string " ")))))
              (expr_stmt (call (ident ast_emit_type) (call (ident get_ptr_at) (ident params) (ident i))))
              (assign (ident i) (binop + (ident i) (number 1)))))
          (expr_stmt (call (ident ast_emit_str) (string ") ")))
          (expr_stmt (call (ident ast_emit_type) (call (ident effect_decl_return_type) (ident node))))
          (expr_stmt (call (ident ast_emit_str) (string ")")))
          (return)))
      (if (binop == (ident kind) (ident NODE_MACRO_DECL))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "(macro ")))
          (expr_stmt (call (ident ast_emit_strn) (call (ident macro_decl_name) (ident node)) (call (ident macro_decl_name_len) (ident node))))
          (expr_stmt (call (ident ast_emit_str) (string " (")))
          (var params (type_ptr (type_base u8)) (call (ident macro_decl_params) (ident node)))
          (var count (type_base i64) (call (ident macro_decl_param_count) (ident node)))
          (var i (type_base i64) (number 0))
          (while (binop < (ident i) (ident count))
            (block
              (if (binop > (ident i) (number 0))
                (block
                  (expr_stmt (call (ident ast_emit_str) (string " ")))))
              (var p (type_ptr (type_base u8)) (call (ident get_param) (ident params) (ident i)))
              (expr_stmt (call (ident ast_emit_strn) (call (ident param_name) (ident p)) (call (ident param_name_len) (ident p))))
              (assign (ident i) (binop + (ident i) (number 1)))))
          (expr_stmt (call (ident ast_emit_str) (string ") ")))
          (expr_stmt (call (ident ast_emit_node) (call (ident macro_decl_body) (ident node))))
          (expr_stmt (call (ident ast_emit_str) (string ")")))
          (return)))
      (if (binop == (ident kind) (ident NODE_READER_DECL))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "(reader ")))
          (if (call (ident reader_decl_is_pub) (ident node))
            (block
              (expr_stmt (call (ident ast_emit_str) (string "pub ")))))
          (expr_stmt (call (ident ast_emit_strn) (call (ident reader_decl_name) (ident node)) (call (ident reader_decl_name_len) (ident node))))
          (expr_stmt (call (ident ast_emit_str) (string " ")))
          (expr_stmt (call (ident ast_emit_strn) (call (ident reader_decl_param_name) (ident node)) (call (ident reader_decl_param_len) (ident node))))
          (expr_stmt (call (ident ast_emit_str) (string " ")))
          (expr_stmt (call (ident ast_emit_node) (call (ident reader_decl_body) (ident node))))
          (expr_stmt (call (ident ast_emit_str) (string ")")))
          (return)))
      (if (binop == (ident kind) (ident NODE_INCLUDE_DECL))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "(include ")))
          (expr_stmt (call (ident ast_emit_quoted_string) (call (ident include_decl_path) (ident node)) (call (ident include_decl_path_len) (ident node))))
          (expr_stmt (call (ident ast_emit_str) (string ")")))
          (return)))
      (if (binop == (ident kind) (ident NODE_REQUIRE_DECL))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "(require ")))
          (expr_stmt (call (ident ast_emit_quoted_string) (call (ident require_decl_module) (ident node)) (call (ident require_decl_module_len) (ident node))))
          (expr_stmt (call (ident ast_emit_str) (string ")")))
          (return)))
      (if (binop == (ident kind) (ident NODE_MODULES_DECL))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "(modules")))
          (var count (type_base i64) (call (ident modules_decl_count) (ident node)))
          (var i (type_base i64) (number 0))
          (while (binop < (ident i) (ident count))
            (block
              (expr_stmt (call (ident ast_emit_str) (string " ")))
              (var entry (type_ptr (type_base u8)) (call (ident modules_decl_get) (ident node) (ident i)))
              (expr_stmt (call (ident ast_emit_quoted_string) (call (ident module_entry_name) (ident entry)) (call (ident module_entry_len) (ident entry))))
              (assign (ident i) (binop + (ident i) (number 1)))))
          (expr_stmt (call (ident ast_emit_str) (string ")")))
          (return)))
      (if (binop == (ident kind) (ident NODE_IMPORT))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "(import ")))
          (expr_stmt (call (ident ast_emit_quoted_string) (call (ident import_decl_path) (ident node)) (call (ident import_decl_path_len) (ident node))))
          (expr_stmt (call (ident ast_emit_str) (string ")")))
          (return)))
      (if (binop == (ident kind) (ident NODE_BLOCK_STMT))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "(block")))
          (var stmts (type_ptr (type_base u8)) (call (ident block_stmt_stmts) (ident node)))
          (var count (type_base i64) (call (ident block_stmt_count) (ident node)))
          (assign (ident ast_emit_indent) (binop + (ident ast_emit_indent) (number 1)))
          (var i (type_base i64) (number 0))
          (while (binop < (ident i) (ident count))
            (block
              (expr_stmt (call (ident ast_emit_newline)))
              (expr_stmt (call (ident ast_emit_node) (call (ident get_stmt) (ident stmts) (ident i))))
              (assign (ident i) (binop + (ident i) (number 1)))))
          (expr_stmt (call (ident ast_emit_str) (string ")")))
          (assign (ident ast_emit_indent) (binop - (ident ast_emit_indent) (number 1)))
          (return)))
      (if (binop == (ident kind) (ident NODE_BLOCK_EXPR))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "(block_expr")))
          (var stmts (type_ptr (type_base u8)) (call (ident block_expr_stmts) (ident node)))
          (var count (type_base i64) (call (ident block_expr_count) (ident node)))
          (assign (ident ast_emit_indent) (binop + (ident ast_emit_indent) (number 1)))
          (var i (type_base i64) (number 0))
          (while (binop < (ident i) (ident count))
            (block
              (expr_stmt (call (ident ast_emit_newline)))
              (expr_stmt (call (ident ast_emit_node) (call (ident get_stmt) (ident stmts) (ident i))))
              (assign (ident i) (binop + (ident i) (number 1)))))
          (expr_stmt (call (ident ast_emit_newline)))
          (expr_stmt (call (ident ast_emit_node) (call (ident block_expr_tail) (ident node))))
          (expr_stmt (call (ident ast_emit_str) (string ")")))
          (assign (ident ast_emit_indent) (binop - (ident ast_emit_indent) (number 1)))
          (return)))
      (if (binop == (ident kind) (ident NODE_ARRAY_LITERAL))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "(array_literal")))
          (var elems (type_ptr (type_base u8)) (call (ident array_literal_elems) (ident node)))
          (var count (type_base i64) (call (ident array_literal_count) (ident node)))
          (var i (type_base i64) (number 0))
          (while (binop < (ident i) (ident count))
            (block
              (expr_stmt (call (ident ast_emit_str) (string " ")))
              (var elem_ptr (type_ptr (type_base i64)) (binop + (ident elems) (binop * (ident i) (number 8))))
              (var elem (type_ptr (type_base u8)) (unop * (ident elem_ptr)))
              (expr_stmt (call (ident ast_emit_node) (ident elem)))
              (assign (ident i) (binop + (ident i) (number 1)))))
          (expr_stmt (call (ident ast_emit_str) (string ")")))
          (return)))
      (if (binop == (ident kind) (ident NODE_IF_STMT))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "(if ")))
          (expr_stmt (call (ident ast_emit_node) (call (ident if_stmt_cond) (ident node))))
          (assign (ident ast_emit_indent) (binop + (ident ast_emit_indent) (number 1)))
          (expr_stmt (call (ident ast_emit_newline)))
          (expr_stmt (call (ident ast_emit_node) (call (ident if_stmt_then) (ident node))))
          (var else_branch (type_ptr (type_base u8)) (call (ident if_stmt_else) (ident node)))
          (if (binop != (ident else_branch) (nil))
            (block
              (expr_stmt (call (ident ast_emit_newline)))
              (expr_stmt (call (ident ast_emit_node) (ident else_branch)))))
          (expr_stmt (call (ident ast_emit_str) (string ")")))
          (assign (ident ast_emit_indent) (binop - (ident ast_emit_indent) (number 1)))
          (return)))
      (if (binop == (ident kind) (ident NODE_WHILE_STMT))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "(while ")))
          (expr_stmt (call (ident ast_emit_node) (call (ident while_stmt_cond) (ident node))))
          (assign (ident ast_emit_indent) (binop + (ident ast_emit_indent) (number 1)))
          (expr_stmt (call (ident ast_emit_newline)))
          (expr_stmt (call (ident ast_emit_node) (call (ident while_stmt_body) (ident node))))
          (var label_len (type_base i64) (call (ident while_stmt_label_len) (ident node)))
          (if (binop > (ident label_len) (number 0))
            (block
              (expr_stmt (call (ident ast_emit_str) (string " ")))
              (expr_stmt (call (ident ast_emit_strn) (call (ident while_stmt_label) (ident node)) (ident label_len)))))
          (expr_stmt (call (ident ast_emit_str) (string ")")))
          (assign (ident ast_emit_indent) (binop - (ident ast_emit_indent) (number 1)))
          (return)))
      (if (binop == (ident kind) (ident NODE_RETURN_STMT))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "(return")))
          (var val (type_ptr (type_base u8)) (call (ident return_stmt_value) (ident node)))
          (if (binop != (ident val) (nil))
            (block
              (expr_stmt (call (ident ast_emit_str) (string " ")))
              (expr_stmt (call (ident ast_emit_node) (ident val)))))
          (expr_stmt (call (ident ast_emit_str) (string ")")))
          (return)))
      (if (binop == (ident kind) (ident NODE_BREAK_STMT))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "(break")))
          (var label_len (type_base i64) (call (ident break_stmt_label_len) (ident node)))
          (if (binop > (ident label_len) (number 0))
            (block
              (expr_stmt (call (ident ast_emit_str) (string " ")))
              (expr_stmt (call (ident ast_emit_strn) (call (ident break_stmt_label) (ident node)) (ident label_len)))))
          (expr_stmt (call (ident ast_emit_str) (string ")")))
          (return)))
      (if (binop == (ident kind) (ident NODE_CONTINUE_STMT))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "(continue")))
          (var label_len (type_base i64) (call (ident continue_stmt_label_len) (ident node)))
          (if (binop > (ident label_len) (number 0))
            (block
              (expr_stmt (call (ident ast_emit_str) (string " ")))
              (expr_stmt (call (ident ast_emit_strn) (call (ident continue_stmt_label) (ident node)) (ident label_len)))))
          (expr_stmt (call (ident ast_emit_str) (string ")")))
          (return)))
      (if (binop == (ident kind) (ident NODE_EXPR_STMT))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "(expr_stmt ")))
          (expr_stmt (call (ident ast_emit_node) (call (ident expr_stmt_expr) (ident node))))
          (expr_stmt (call (ident ast_emit_str) (string ")")))
          (return)))
      (if (binop == (ident kind) (ident NODE_ASSIGN_STMT))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "(assign ")))
          (expr_stmt (call (ident ast_emit_node) (call (ident assign_stmt_target) (ident node))))
          (expr_stmt (call (ident ast_emit_str) (string " ")))
          (expr_stmt (call (ident ast_emit_node) (call (ident assign_stmt_value) (ident node))))
          (expr_stmt (call (ident ast_emit_str) (string ")")))
          (return)))
      (if (binop == (ident kind) (ident NODE_BINARY_EXPR))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "(binop ")))
          (expr_stmt (call (ident ast_emit_op) (call (ident binary_expr_op) (ident node))))
          (expr_stmt (call (ident ast_emit_str) (string " ")))
          (expr_stmt (call (ident ast_emit_node) (call (ident binary_expr_left) (ident node))))
          (expr_stmt (call (ident ast_emit_str) (string " ")))
          (expr_stmt (call (ident ast_emit_node) (call (ident binary_expr_right) (ident node))))
          (expr_stmt (call (ident ast_emit_str) (string ")")))
          (return)))
      (if (binop == (ident kind) (ident NODE_UNARY_EXPR))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "(unop ")))
          (expr_stmt (call (ident ast_emit_op) (call (ident unary_expr_op) (ident node))))
          (expr_stmt (call (ident ast_emit_str) (string " ")))
          (expr_stmt (call (ident ast_emit_node) (call (ident unary_expr_expr) (ident node))))
          (expr_stmt (call (ident ast_emit_str) (string ")")))
          (return)))
      (if (binop == (ident kind) (ident NODE_CALL_EXPR))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "(call ")))
          (expr_stmt (call (ident ast_emit_node) (call (ident call_expr_func) (ident node))))
          (var args (type_ptr (type_base u8)) (call (ident call_expr_args) (ident node)))
          (var count (type_base i64) (call (ident call_expr_arg_count) (ident node)))
          (var i (type_base i64) (number 0))
          (while (binop < (ident i) (ident count))
            (block
              (expr_stmt (call (ident ast_emit_str) (string " ")))
              (expr_stmt (call (ident ast_emit_node) (call (ident get_ptr_at) (ident args) (ident i))))
              (assign (ident i) (binop + (ident i) (number 1)))))
          (expr_stmt (call (ident ast_emit_str) (string ")")))
          (return)))
      (if (binop == (ident kind) (ident NODE_FIELD_EXPR))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "(field ")))
          (expr_stmt (call (ident ast_emit_node) (call (ident field_expr_expr) (ident node))))
          (expr_stmt (call (ident ast_emit_str) (string " ")))
          (expr_stmt (call (ident ast_emit_strn) (call (ident field_expr_field) (ident node)) (call (ident field_expr_field_len) (ident node))))
          (expr_stmt (call (ident ast_emit_str) (string ")")))
          (return)))
      (if (binop == (ident kind) (ident NODE_INDEX_EXPR))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "(index ")))
          (var pe (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 8)))
          (var pi (type_ptr (type_ptr (type_base u8))) (binop + (ident node) (number 16)))
          (expr_stmt (call (ident ast_emit_node) (unop * (ident pe))))
          (expr_stmt (call (ident ast_emit_str) (string " ")))
          (expr_stmt (call (ident ast_emit_node) (unop * (ident pi))))
          (expr_stmt (call (ident ast_emit_str) (string ")")))
          (return)))
      (if (binop == (ident kind) (ident NODE_IDENT_EXPR))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "(ident ")))
          (expr_stmt (call (ident ast_emit_strn) (call (ident ident_expr_name) (ident node)) (call (ident ident_expr_name_len) (ident node))))
          (expr_stmt (call (ident ast_emit_str) (string ")")))
          (return)))
      (if (binop == (ident kind) (ident NODE_NUMBER_EXPR))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "(number ")))
          (expr_stmt (call (ident ast_emit_strn) (call (ident number_expr_value) (ident node)) (call (ident number_expr_value_len) (ident node))))
          (expr_stmt (call (ident ast_emit_str) (string ")")))
          (return)))
      (if (binop == (ident kind) (ident NODE_STRING_EXPR))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "(string ")))
          (expr_stmt (call (ident ast_emit_quoted_string) (call (ident string_expr_value) (ident node)) (call (ident string_expr_value_len) (ident node))))
          (expr_stmt (call (ident ast_emit_str) (string ")")))
          (return)))
      (if (binop == (ident kind) (ident NODE_BOOL_EXPR))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "(bool ")))
          (if (binop != (call (ident bool_expr_value) (ident node)) (number 0))
            (block
              (expr_stmt (call (ident ast_emit_str) (string "true"))))
            (block
              (expr_stmt (call (ident ast_emit_str) (string "false")))))
          (expr_stmt (call (ident ast_emit_str) (string ")")))
          (return)))
      (if (binop == (ident kind) (ident NODE_NIL_EXPR))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "(nil)")))
          (return)))
      (if (binop == (ident kind) (ident NODE_GROUP_EXPR))
        (block
          (expr_stmt (call (ident ast_emit_node) (call (ident group_expr_expr) (ident node))))
          (return)))
      (if (binop == (ident kind) (ident NODE_LET_EXPR))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "(let ")))
          (expr_stmt (call (ident ast_emit_strn) (call (ident let_expr_name) (ident node)) (call (ident let_expr_name_len) (ident node))))
          (var t (type_ptr (type_base u8)) (call (ident let_expr_type) (ident node)))
          (if (binop != (ident t) (nil))
            (block
              (expr_stmt (call (ident ast_emit_str) (string " ")))
              (expr_stmt (call (ident ast_emit_type) (ident t)))))
          (expr_stmt (call (ident ast_emit_str) (string " ")))
          (expr_stmt (call (ident ast_emit_node) (call (ident let_expr_init) (ident node))))
          (expr_stmt (call (ident ast_emit_str) (string " ")))
          (expr_stmt (call (ident ast_emit_node) (call (ident let_expr_body) (ident node))))
          (expr_stmt (call (ident ast_emit_str) (string ")")))
          (return)))
      (if (binop == (ident kind) (ident NODE_LAMBDA_EXPR))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "(lambda (")))
          (var params (type_ptr (type_base u8)) (call (ident lambda_expr_params) (ident node)))
          (var count (type_base i64) (call (ident lambda_expr_param_count) (ident node)))
          (var i (type_base i64) (number 0))
          (while (binop < (ident i) (ident count))
            (block
              (if (binop > (ident i) (number 0))
                (block
                  (expr_stmt (call (ident ast_emit_str) (string " ")))))
              (expr_stmt (call (ident ast_emit_param) (call (ident get_param) (ident params) (ident i))))
              (assign (ident i) (binop + (ident i) (number 1)))))
          (expr_stmt (call (ident ast_emit_str) (string ") ")))
          (expr_stmt (call (ident ast_emit_type) (call (ident lambda_expr_ret_type) (ident node))))
          (expr_stmt (call (ident ast_emit_str) (string " ")))
          (expr_stmt (call (ident ast_emit_node) (call (ident lambda_expr_body) (ident node))))
          (expr_stmt (call (ident ast_emit_str) (string ")")))
          (return)))
      (if (binop == (ident kind) (ident NODE_MATCH_EXPR))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "(match ")))
          (expr_stmt (call (ident ast_emit_node) (call (ident match_expr_scrutinee) (ident node))))
          (expr_stmt (call (ident ast_emit_str) (string " (")))
          (var arms (type_ptr (type_base u8)) (call (ident match_expr_arms) (ident node)))
          (var count (type_base i64) (call (ident match_expr_arm_count) (ident node)))
          (assign (ident ast_emit_indent) (binop + (ident ast_emit_indent) (number 1)))
          (var i (type_base i64) (number 0))
          (while (binop < (ident i) (ident count))
            (block
              (expr_stmt (call (ident ast_emit_newline)))
              (var arm (type_ptr (type_base u8)) (call (ident get_match_arm) (ident arms) (ident i)))
              (expr_stmt (call (ident ast_emit_str) (string "(case ")))
              (expr_stmt (call (ident ast_emit_pattern) (call (ident match_arm_pattern) (ident arm))))
              (expr_stmt (call (ident ast_emit_str) (string " ")))
              (expr_stmt (call (ident ast_emit_node) (call (ident match_arm_body) (ident arm))))
              (expr_stmt (call (ident ast_emit_str) (string ")")))
              (assign (ident i) (binop + (ident i) (number 1)))))
          (expr_stmt (call (ident ast_emit_str) (string "))")))
          (assign (ident ast_emit_indent) (binop - (ident ast_emit_indent) (number 1)))
          (return)))
      (if (binop == (ident kind) (ident NODE_PERFORM_EXPR))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "(perform ")))
          (expr_stmt (call (ident ast_emit_strn) (call (ident perform_expr_name) (ident node)) (call (ident perform_expr_name_len) (ident node))))
          (var args (type_ptr (type_base u8)) (call (ident perform_expr_args) (ident node)))
          (var count (type_base i64) (call (ident perform_expr_arg_count) (ident node)))
          (var i (type_base i64) (number 0))
          (while (binop < (ident i) (ident count))
            (block
              (expr_stmt (call (ident ast_emit_str) (string " ")))
              (expr_stmt (call (ident ast_emit_node) (call (ident get_ptr_at) (ident args) (ident i))))
              (assign (ident i) (binop + (ident i) (number 1)))))
          (expr_stmt (call (ident ast_emit_str) (string ")")))
          (return)))
      (if (binop == (ident kind) (ident NODE_HANDLE_EXPR))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "(handle ")))
          (expr_stmt (call (ident ast_emit_node) (call (ident handle_expr_body) (ident node))))
          (assign (ident ast_emit_indent) (binop + (ident ast_emit_indent) (number 1)))
          (expr_stmt (call (ident ast_emit_newline)))
          (expr_stmt (call (ident ast_emit_str) (string "(return_handler ")))
          (expr_stmt (call (ident ast_emit_strn) (call (ident handle_expr_ret_bind) (ident node)) (call (ident handle_expr_ret_bind_len) (ident node))))
          (expr_stmt (call (ident ast_emit_str) (string " ")))
          (expr_stmt (call (ident ast_emit_node) (call (ident handle_expr_ret_body) (ident node))))
          (expr_stmt (call (ident ast_emit_str) (string ")")))
          (var handlers (type_ptr (type_base u8)) (call (ident handle_expr_cases) (ident node)))
          (var count (type_base i64) (call (ident handle_expr_case_count) (ident node)))
          (var i (type_base i64) (number 0))
          (while (binop < (ident i) (ident count))
            (block
              (expr_stmt (call (ident ast_emit_newline)))
              (var h (type_ptr (type_base u8)) (call (ident get_effect_case) (ident handlers) (ident i)))
              (expr_stmt (call (ident ast_emit_str) (string "(effect_handler ")))
              (expr_stmt (call (ident ast_emit_strn) (call (ident effect_case_name) (ident h)) (call (ident effect_case_name_len) (ident h))))
              (expr_stmt (call (ident ast_emit_str) (string " ")))
              (var bind_len (type_base i64) (call (ident effect_case_binding_len) (ident h)))
              (if (binop > (ident bind_len) (number 0))
                (block
                  (expr_stmt (call (ident ast_emit_strn) (call (ident effect_case_binding) (ident h)) (ident bind_len))))
                (block
                  (expr_stmt (call (ident ast_emit_str) (string "_")))))
              (expr_stmt (call (ident ast_emit_str) (string " ")))
              (var k_len (type_base i64) (call (ident effect_case_k_len) (ident h)))
              (if (binop > (ident k_len) (number 0))
                (block
                  (expr_stmt (call (ident ast_emit_strn) (call (ident effect_case_k) (ident h)) (ident k_len))))
                (block
                  (expr_stmt (call (ident ast_emit_str) (string "_")))))
              (expr_stmt (call (ident ast_emit_str) (string " ")))
              (expr_stmt (call (ident ast_emit_node) (call (ident effect_case_body) (ident h))))
              (expr_stmt (call (ident ast_emit_str) (string ")")))
              (assign (ident i) (binop + (ident i) (number 1)))))
          (expr_stmt (call (ident ast_emit_str) (string ")")))
          (assign (ident ast_emit_indent) (binop - (ident ast_emit_indent) (number 1)))
          (return)))
      (if (binop == (ident kind) (ident NODE_RESUME_EXPR))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "(resume ")))
          (expr_stmt (call (ident ast_emit_node) (call (ident resume_expr_k) (ident node))))
          (var val (type_ptr (type_base u8)) (call (ident resume_expr_value) (ident node)))
          (if (binop != (ident val) (nil))
            (block
              (expr_stmt (call (ident ast_emit_str) (string " ")))
              (expr_stmt (call (ident ast_emit_node) (ident val)))))
          (expr_stmt (call (ident ast_emit_str) (string ")")))
          (return)))
      (if (binop == (ident kind) (ident NODE_QUOTE_EXPR))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "(quote ")))
          (expr_stmt (call (ident ast_emit_node) (call (ident quote_expr_expr) (ident node))))
          (expr_stmt (call (ident ast_emit_str) (string ")")))
          (return)))
      (if (binop == (ident kind) (ident NODE_UNQUOTE_EXPR))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "(unquote ")))
          (expr_stmt (call (ident ast_emit_strn) (call (ident unquote_expr_name) (ident node)) (call (ident unquote_expr_name_len) (ident node))))
          (expr_stmt (call (ident ast_emit_str) (string ")")))
          (return)))
      (if (binop == (ident kind) (ident NODE_UNQUOTE_STRING_EXPR))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "(unquote_string ")))
          (expr_stmt (call (ident ast_emit_strn) (call (ident unquote_string_expr_name) (ident node)) (call (ident unquote_string_expr_name_len) (ident node))))
          (expr_stmt (call (ident ast_emit_str) (string ")")))
          (return)))
      (if (binop == (ident kind) (ident NODE_READER_EXPR))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "(reader_expr ")))
          (expr_stmt (call (ident ast_emit_strn) (call (ident reader_expr_name) (ident node)) (call (ident reader_expr_name_len) (ident node))))
          (expr_stmt (call (ident ast_emit_str) (string " ")))
          (expr_stmt (call (ident ast_emit_quoted_string) (call (ident reader_expr_content) (ident node)) (call (ident reader_expr_content_len) (ident node))))
          (expr_stmt (call (ident ast_emit_str) (string ")")))
          (return)))
      (expr_stmt (call (ident ast_emit_str) (string "(unknown_node ")))
      (expr_stmt (call (ident ast_emit_int) (ident kind)))
      (expr_stmt (call (ident ast_emit_str) (string ")")))))
  (func ast_emit_pattern ((param p (type_ptr (type_base u8)))) (type_base void)
    (block
      (if (binop == (ident p) (nil))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "nil")))
          (return)))
      (var kind (type_base i64) (call (ident node_kind) (ident p)))
      (if (binop == (ident kind) (ident NODE_PATTERN_VARIANT))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "(pattern_variant ")))
          (expr_stmt (call (ident ast_emit_strn) (call (ident pattern_variant_enum_name) (ident p)) (call (ident pattern_variant_enum_len) (ident p))))
          (expr_stmt (call (ident ast_emit_str) (string " ")))
          (expr_stmt (call (ident ast_emit_strn) (call (ident pattern_variant_name) (ident p)) (call (ident pattern_variant_name_len) (ident p))))
          (var binding_len (type_base i64) (call (ident pattern_variant_binding_len) (ident p)))
          (if (binop > (ident binding_len) (number 0))
            (block
              (expr_stmt (call (ident ast_emit_str) (string " ")))
              (expr_stmt (call (ident ast_emit_strn) (call (ident pattern_variant_binding) (ident p)) (ident binding_len)))))
          (expr_stmt (call (ident ast_emit_str) (string ")")))
          (return)))
      (if (binop == (ident kind) (ident NODE_PATTERN_WILDCARD))
        (block
          (expr_stmt (call (ident ast_emit_str) (string "(pattern_wildcard)")))
          (return)))
      (expr_stmt (call (ident ast_emit_str) (string "(unknown_pattern ")))
      (expr_stmt (call (ident ast_emit_int) (ident kind)))
      (expr_stmt (call (ident ast_emit_str) (string ")")))))
  (func ast_emit_program ((param prog (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (expr_stmt (call (ident ast_emit_init)))
      (expr_stmt (call (ident ast_emit_str) (string "(program")))
      (var decls (type_ptr (type_base u8)) (call (ident program_decls) (ident prog)))
      (var count (type_base i64) (call (ident program_decl_count) (ident prog)))
      (assign (ident ast_emit_indent) (binop + (ident ast_emit_indent) (number 1)))
      (var i (type_base i64) (number 0))
      (while (binop < (ident i) (ident count))
        (block
          (expr_stmt (call (ident ast_emit_newline)))
          (expr_stmt (call (ident ast_emit_node) (call (ident get_decl) (ident decls) (ident i))))
          (assign (ident i) (binop + (ident i) (number 1)))))
      (expr_stmt (call (ident ast_emit_str) (string ")")))
      (expr_stmt (call (ident ast_emit_newline)))
      (return (call (ident ast_emit_finish)))))
  (func ast_emit_expression ((param expr (type_ptr (type_base u8)))) (type_ptr (type_base u8))
    (block
      (expr_stmt (call (ident ast_emit_init)))
      (expr_stmt (call (ident ast_emit_node) (ident expr)))
      (return (call (ident ast_emit_finish)))))
  (func is_decl_token ((param t (type_base i64))) (type_base bool)
    (block
      (return (binop || (binop || (binop || (binop || (binop || (binop || (binop || (binop || (binop == (ident t) (ident TOKEN_FUNC)) (binop == (ident t) (ident TOKEN_VAR))) (binop == (ident t) (ident TOKEN_STRUCT))) (binop == (ident t) (ident TOKEN_ENUM))) (binop == (ident t) (ident TOKEN_EFFECT))) (binop == (ident t) (ident TOKEN_MACRO))) (binop == (ident t) (ident TOKEN_READER))) (binop == (ident t) (ident TOKEN_INCLUDE))) (binop == (ident t) (ident TOKEN_IMPORT))))))
  (reader lang text (block
    (expr_stmt (call (ident parser_tokenize) (ident text)))
    (var i (type_base i64) (number 0))
    (while (binop < (ident i) (call (ident parser_token_count)))
      (block
        (var tok (type_ptr (type_base u8)) (call (ident get_token) (ident i)))
        (if (binop == (call (ident tok_type) (ident tok)) (ident TOKEN_ERROR))
          (block
            (expr_stmt (call (ident eprint) (string "lang reader error: ")))
            (expr_stmt (call (ident eprintln) (call (ident tok_lexeme) (ident tok))))
            (return (nil))))
        (assign (ident i) (binop + (ident i) (number 1)))))
    (var first_type (type_base i64) (ident TOKEN_EOF))
    (if (binop > (call (ident parser_token_count)) (number 0))
      (block
        (assign (ident first_type) (call (ident tok_type) (call (ident get_token) (number 0))))))
    (if (call (ident is_decl_token) (ident first_type))
      (block
        (var prog (type_ptr (type_base u8)) (call (ident parse_program)))
        (if (binop > (ident parse_error_count) (number 0))
          (block
            (return (nil))))
        (return (call (ident ast_emit_program) (ident prog))))
      (block
        (var expr (type_ptr (type_base u8)) (call (ident parse_expression)))
        (if (binop > (ident parse_error_count) (number 0))
          (block
            (return (nil))))
        (return (call (ident ast_emit_expression) (ident expr))))))))
  